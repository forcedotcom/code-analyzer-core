<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Reference Index &#8212; Flow Security Tester 0.6.5-ALPHA documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="_static/basic_mod.css?v=94a554c0" />
    <script src="_static/documentation_options.js?v=0a505505"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/petite-vue.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="index.html" title="Go to homepage">Flow Security Tester 0.6.5-ALPHA documentation</a></h1>

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-flow_parser.parse">
<span id="reference-index"></span><h1>Reference Index<a class="headerlink" href="#module-flow_parser.parse" title="Link to this heading">¶</a></h1>
<p>Module for xml parsing of flow global attributes</p>
<dl class="py data">
<dt class="sig sig-object py" id="flow_parser.parse.NS_LEN">
<span class="sig-prename descclassname"><span class="pre">flow_parser.parse.</span></span><span class="sig-name descname"><span class="pre">NS_LEN</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">41</span></em><a class="headerlink" href="#flow_parser.parse.NS_LEN" title="Link to this definition">¶</a></dt>
<dd><p>length of namespace for text munging</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flow_parser.parse.Parser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flow_parser.parse.</span></span><span class="sig-name descname"><span class="pre">Parser</span></span><a class="headerlink" href="#flow_parser.parse.Parser" title="Link to this definition">¶</a></dt>
<dd><p>API for parsing global lexical attributes of flow xml files.</p>
<p>Parser instances do not contain any branch-dependent data. In particular
when a variable is seen by the parser, that does not mean it has been
initialized or added to the influence map. Parser initialization must
precede Frame, State, and Crawler initialization.</p>
<p>Parsers should not have any data modified after initialization except
new member resolutions (e.g. Account.foo where ‘foo’ is new).</p>
<p>Parsers should always be built with the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Parser.from_file()</span></code> class method
except for testing where from_string can be used, but then be sure to provide
a dummy filename.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.all_named_elems">
<span class="sig-name descname"><span class="pre">all_named_elems</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">frozenset[ET._Element]</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flow_parser.parse.Parser.all_named_elems" title="Link to this definition">¶</a></dt>
<dd><p>frozen set of all elements that have a child of &lt;name&gt; and are thus flow globals</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.declared_run_mode">
<span class="sig-name descname"><span class="pre">declared_run_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">RunMode</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flow_parser.parse.Parser.declared_run_mode" title="Link to this definition">¶</a></dt>
<dd><p>run mode as declared in flow xml</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.effective_run_mode">
<span class="sig-name descname"><span class="pre">effective_run_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">RunMode</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flow_parser.parse.Parser.effective_run_mode" title="Link to this definition">¶</a></dt>
<dd><p>effective runmode taking inheritance into account</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.flow_path">
<span class="sig-name descname"><span class="pre">flow_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flow_parser.parse.Parser.flow_path" title="Link to this definition">¶</a></dt>
<dd><p>current filepath of flow</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.flow_type">
<span class="sig-name descname"><span class="pre">flow_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FlowType</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flow_parser.parse.Parser.flow_type" title="Link to this definition">¶</a></dt>
<dd><p>is this a screen or auto-launched flow</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_all_indirect_tuples">
<span class="sig-name descname"><span class="pre">get_all_indirect_tuples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_all_indirect_tuples" title="Link to this definition">¶</a></dt>
<dd><p>returns a list of tuples of all indirect references, e.g.
str, elem, where str influences elem.
The elem is a formula or template element and
str is an extracted merge-field from the elem</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">_Element</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_all_traversable_flow_elements">
<span class="sig-name descname"><span class="pre">get_all_traversable_flow_elements</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_all_traversable_flow_elements" title="Link to this definition">¶</a></dt>
<dd><p>ignore start</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[ET._Element]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_by_name">
<span class="sig-name descname"><span class="pre">get_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_to_match</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_by_name" title="Link to this definition">¶</a></dt>
<dd><p>returns the first elem with the given name that is a child of the scope element</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">_Element</span></code>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>name_to_match</strong> (<em>str</em>) – </p></li>
<li><p><strong>scope</strong> (<em>_Element</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_flow_name">
<span class="sig-name descname"><span class="pre">get_flow_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_flow_name" title="Link to this definition">¶</a></dt>
<dd><p>we assume there is always a flow label.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_flow_type">
<span class="sig-name descname"><span class="pre">get_flow_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_flow_type" title="Link to this definition">¶</a></dt>
<dd><p>Look for &lt;processType&gt;AutoLaunchedFlow&lt;/processType&gt;</p>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_formulas">
<span class="sig-name descname"><span class="pre">get_formulas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_formulas" title="Link to this definition">¶</a></dt>
<dd><p>Grabs all formula elements.
Returns empty list if none found</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[ET._Element]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_input_field_elems">
<span class="sig-name descname"><span class="pre">get_input_field_elems</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_input_field_elems" title="Link to this definition">¶</a></dt>
<dd><p>Named XML elements that are children of Screen Flow Input Text Elements
:rtype: <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">_Element</span></code>]]</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only returns variables from current flow</p>
</div>
<p>Returns: None if none present in flow</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set[<em>_Element</em>] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_input_output_elems">
<span class="sig-name descname"><span class="pre">get_input_output_elems</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_input_output_elems" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns::</dt><dd><p>{“input”: input variable elements,
“output”: output variable elements }</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{str: set[ET._Element]}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_input_variables">
<span class="sig-name descname"><span class="pre">get_input_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_input_variables" title="Link to this definition">¶</a></dt>
<dd><p>Get Flow variables available for input</p>
<dl class="simple">
<dt>Returns: (filename, element_name) corresponding to all variables available for input</dt><dd><p>or None if none found.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>{(str, str)}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_target_reference_elem">
<span class="sig-name descname"><span class="pre">get_target_reference_elem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_target_reference_elem" title="Link to this definition">¶</a></dt>
<dd><p>returns element being pointed to in a child of elem</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">_Element</span></code>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>elem</strong> (<em>_Element</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.get_templates">
<span class="sig-name descname"><span class="pre">get_templates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.get_templates" title="Link to this definition">¶</a></dt>
<dd><p>Grabs all template elements.
Returns empty list if none found</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[ET._Element]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.input_variables">
<span class="sig-name descname"><span class="pre">input_variables</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">frozenset[str,</span> <span class="pre">str]</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flow_parser.parse.Parser.input_variables" title="Link to this definition">¶</a></dt>
<dd><p>variables marked ‘available for input’, as a pair (flow_path, name)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.literal_var">
<span class="sig-name descname"><span class="pre">literal_var</span></span><a class="headerlink" href="#flow_parser.parse.Parser.literal_var" title="Link to this definition">¶</a></dt>
<dd><p>for marking string literals</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.output_variables">
<span class="sig-name descname"><span class="pre">output_variables</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">frozenset[str,</span> <span class="pre">str]</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flow_parser.parse.Parser.output_variables" title="Link to this definition">¶</a></dt>
<dd><p>variables marked ‘available for output’, as a tuple (flow_path, name)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.resolve_by_name">
<span class="sig-name descname"><span class="pre">resolve_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.resolve_by_name" title="Link to this definition">¶</a></dt>
<dd><p>Resolves name to variable, property, VariableType.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Account_var.Name&quot;</span> <span class="o">--&gt;</span> <span class="p">(</span><span class="s2">&quot;Account_var&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">VariableType</span><span class="p">)</span>
<span class="s2">&quot;account_var&quot;</span> <span class="o">--&gt;</span> <span class="p">(</span><span class="n">account_var</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">VariableType</span><span class="p">)</span><span class="o">.</span>
<span class="p">(</span><span class="n">my_subflow</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="p">(</span><span class="n">my_subflow</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">VarType</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – raw name as it is used in the flow xml file (e.g. foo.bar.baz)</p></li>
<li><p><strong>path</strong> (<em>str</em><em> | </em><em>None</em>) – filename in which to resolve</p></li>
<li><p><strong>strict</strong> (<em>bool</em>) – whether to fail hard or guess</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code> if the name cannot be resolved,
else the triple (parent name, member, type)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[str, str, <a class="reference internal" href="#public.data_obj.VariableType" title="public.data_obj.VariableType">VariableType</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.root">
<span class="sig-name descname"><span class="pre">root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ET._Element</span></em><a class="headerlink" href="#flow_parser.parse.Parser.root" title="Link to this definition">¶</a></dt>
<dd><p>XMl root of a single flow</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flow_parser.parse.Parser.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_parser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.Parser.update" title="Link to this definition">¶</a></dt>
<dd><p>Parse flow root and populate default values</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>old_parser</strong> (<a class="reference internal" href="#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><em>Parser</em></a><em> | </em><em>None</em>) – when updating a new parser from an old, to copy over elements
and update run-mode</p></li>
<li><p><strong>is_return</strong> – are we returning from a function call?</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flow_parser.parse.build_vartype_from_elem">
<span class="sig-prename descclassname"><span class="pre">flow_parser.parse.</span></span><span class="sig-name descname"><span class="pre">build_vartype_from_elem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.build_vartype_from_elem" title="Link to this definition">¶</a></dt>
<dd><p>Build VariableType from XML Element</p>
<p>The purpose of this function is to assign types to named
flow elements, in order to assist in object resolution
and type analysis.</p>
<p>We are primarily interested in variable names and flow element names
that can represent variables (via auto-naming conventions).
Do not add flow elements that can’t be used to resolve variable
names – e.g. if an element has an explicit outputAssignment,
then you cannot refer to the output of the flow element by the
element name, and therefore should not attempt to create a
variable from this flow element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elem</strong> (<em>ET._Elem</em>) – must be a <em>named</em> Flow element (e.g. an element with a &lt;name&gt; tag that
is a child of the element root)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>VariableType instance containing type information for the element or None
If the element is not a named Flow element or is unknown to the parser.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#public.data_obj.VariableType" title="public.data_obj.VariableType">VariableType</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flow_parser.parse.get_root">
<span class="sig-prename descclassname"><span class="pre">flow_parser.parse.</span></span><span class="sig-name descname"><span class="pre">get_root</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.get_root" title="Link to this definition">¶</a></dt>
<dd><p>Get flow root</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">_Element</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>path</strong> (<em>str</em>) – path of xml file to load</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the root of the xml file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flow_parser.parse.get_subflow_input_map">
<span class="sig-prename descclassname"><span class="pre">flow_parser.parse.</span></span><span class="sig-name descname"><span class="pre">get_subflow_input_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subflow</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.get_subflow_input_map" title="Link to this definition">¶</a></dt>
<dd><p>Returns a map from caller variable to variable in called flow</p>
<blockquote>
<div><p>E.g. in this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">inputAssignments</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">input_var1</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">elementReference</span><span class="o">&gt;</span><span class="n">parent_input_var</span><span class="o">&lt;/</span><span class="n">elementReference</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">inputAssignments</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>we return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;parent_input_var&#39;</span> <span class="p">(</span><span class="n">name</span> <span class="ow">in</span> <span class="n">parent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;input_var1&#39;</span> <span class="p">(</span><span class="n">name</span> <span class="ow">in</span> <span class="n">child</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>subflow</strong> (<em>ET._Element</em>) – XML Element</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>map from parent output_variable name to child input variable
name</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{str: str}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flow_parser.parse.get_subflow_output_map">
<span class="sig-prename descclassname"><span class="pre">flow_parser.parse.</span></span><span class="sig-name descname"><span class="pre">get_subflow_output_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subflow</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flow_parser.parse.get_subflow_output_map" title="Link to this definition">¶</a></dt>
<dd><p>returns a tuple (bool:, map: child name –&gt; parent name)
where the first return value is true if outputs are automatically assigned
in which case they are flow_name.flow_var</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>subflow</strong> (<em>_Element</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flow_parser.parse.logger">
<span class="sig-prename descclassname"><span class="pre">flow_parser.parse.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Logger</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">flow_parser.parse</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#flow_parser.parse.logger" title="Link to this definition">¶</a></dt>
<dd><p>logger instance</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flow_parser.parse.ns">
<span class="sig-prename descclassname"><span class="pre">flow_parser.parse.</span></span><span class="sig-name descname"><span class="pre">ns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'{http://soap.sforce.com/2006/04/metadata}'</span></em><a class="headerlink" href="#flow_parser.parse.ns" title="Link to this definition">¶</a></dt>
<dd><p>hardcoded sfdc metadata namespace</p>
</dd></dl>

<dl class="py function" id="module-flowtest.__main__">
<dt class="sig sig-object py" id="flowtest.__main__.check_dir_exists">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">check_dir_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.check_dir_exists" title="Link to this definition">¶</a></dt>
<dd><p>Checks if the argument is a valid directory. Raises ArgumentTypeError if not.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> (<em>str</em>) – string to check</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.check_file_exists">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">check_file_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.check_file_exists" title="Link to this definition">¶</a></dt>
<dd><p>checks if the file exists, otherwise it raises an ArgumentTypeError</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> (<em>str</em>) – filepath</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>filepath</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.check_not_exist">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">check_not_exist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.check_not_exist" title="Link to this definition">¶</a></dt>
<dd><p>lambda that checks if this path exists or not. Raises an error if it does exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> (<em>str</em>) – string to check</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.get_flow_paths">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">get_flow_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.get_flow_paths" title="Link to this definition">¶</a></dt>
<dd><p>Given the arguments parsed by argparse, returns the flow filenames and names
that should be processed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], {&lt;class ‘str’&gt;: &lt;class ‘str’&gt;})</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>args</strong> (<em>Namespace</em>) – argparse Namespace (parsed arguments)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>flow_name -&gt;
flow_path)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of (list of all flows to scan, dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.main">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.main" title="Link to this definition">¶</a></dt>
<dd><p>Main entry point to CLI command. For testing, we allow specifying
the argv list.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>argv</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – (for testing) list of arguments passed into CLI command</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.parse_args">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">parse_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">my_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.parse_args" title="Link to this definition">¶</a></dt>
<dd><p>Defines parameters for argument parsing</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Namespace</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>default</strong> (<em>str</em><em> | </em><em>None</em>) – unique id for this scan. If None provided, one is generated.</p></li>
<li><p><strong>my_args</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – argument list (complete, so my_args[0] is the program
name)</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>argparse Namespace (parsed arguments)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.setup_logger">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">setup_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.setup_logger" title="Link to this definition">¶</a></dt>
<dd><p>Setup logger for scan run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – logging.Level</p></li>
<li><p><strong>log_file</strong> (<em>str</em>) – path to store logs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-flowtest.branch_state">Maintains data influence map for a specific execution branch</p>
<p>&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.branch_state.</span></span><span class="sig-name descname"><span class="pre">BranchState</span></span><a class="headerlink" href="#flowtest.branch_state.BranchState" title="Link to this definition">¶</a></dt>
<dd><p>Instances of BranchState track symbolic execution within a specific
branch, and contain</p>
<blockquote>
<div><ul class="simple">
<li><p>the current element being processed</p></li>
<li><p>all influence flows seen on this branch and up to this element</p></li>
</ul>
</div></blockquote>
<p>All interaction with influence flows must be done via public APIs
exposed by BranchState. Instantiate only with a builder method.</p>
<p>A clone of the state should be made whenever there is a branch within
a flow, so that when we exit the branch, we recover the state
before branching.</p>
<p>Prior to exiting a subflow, all branches must be consolidated so that
all execution paths are available as return values.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parser</strong> (<a class="reference internal" href="#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><em>Parser</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.add_vectors_from_other_flow">
<span class="sig-name descname"><span class="pre">add_vectors_from_other_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_flow_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_vector_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src2tgt_variable_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.add_vectors_from_other_flow" title="Link to this definition">¶</a></dt>
<dd><p>Pushes vectors in the source to vectors in the target, by wiring a flow across flow boundaries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">old</span> <span class="n">path</span><span class="p">:</span> <span class="n">src</span> <span class="n">A</span> <span class="p">(</span><span class="o">=</span><span class="n">terminal</span> <span class="ow">in</span> <span class="n">src</span><span class="p">)</span>
<span class="n">new</span> <span class="n">path</span><span class="p">:</span> <span class="n">src</span> <span class="n">A</span> <span class="o">-&gt;</span> <span class="n">target</span> <span class="n">Y</span> <span class="p">(</span><span class="o">=</span><span class="n">start</span> <span class="ow">in</span> <span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
<p>This operation is used when extending parent flows to child on subflow launch
and extending flows from the subflow to the parent on return.</p>
<p>It should be called as an instance method of the <em>target</em> state, in which the new path
is added.</p>
<p>N.B. As the src and target are variables (and not member accesses of other variables),
we assume they have None members but the flows within the flow vector will often have member targets
and these flows need to be resolved. E.g. the src output variable may contain flows such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scalar</span> <span class="o">--&gt;</span> <span class="n">src_var</span><span class="o">.</span><span class="n">Name</span>
</pre></div>
</div>
<p>And then this flow needs to be propagated individually to the .Name
field of the target, and then all these flows added to the target vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_vector_map</strong> (<em>{</em><em>(</em><em>str</em><em>, </em><em>str</em><em>)</em><em>: FlowVector}</em>) – <p>vectors that should be pushed to target:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">src</span> <span class="n">path</span><span class="p">,</span> <span class="n">src</span> <span class="n">name</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="n">src</span> <span class="n">FlowVector</span>
</pre></div>
</div>
</p></li>
<li><p><strong>src2tgt_variable_map</strong> (<em>{str: str}</em>) – variable name in <code class="docutils literal notranslate"><span class="pre">src</span> <span class="pre">name</span> <span class="pre">-&gt;</span> <span class="pre">target</span></code>
variable name in (raw name, not a tuple)</p></li>
<li><p><strong>transition_elem</strong> (<em>ET._Element</em>) – xml of subflow element</p></li>
<li><p><strong>src_flow_path</strong> (<em>str</em>) – filename of child subflow</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None (the output vectors in the child flow are wired to the
new variables in the parent)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.filter_maps">
<span class="sig-name descname"><span class="pre">filter_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.filter_maps" title="Link to this definition">¶</a></dt>
<dd><p>Removes all influence maps except those in <cite>steps</cite></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Destructive operation, only call after flow
processing is complete.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>steps</strong> (<em>[</em><a class="reference internal" href="#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><em>CrawlStep</em></a><em>]</em>) – CrawlSteps to keep</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. The influence map is filtered in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.get_all_output_vectors">
<span class="sig-name descname"><span class="pre">get_all_output_vectors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.get_all_output_vectors" title="Link to this definition">¶</a></dt>
<dd><p>Return output variable FlowVectors</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>{((flow path, variable name), FlowVector from current state)}
or empty set if no such variables exist</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>[((str, str), <a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector">FlowVector</a>)]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.get_flows_from_sources">
<span class="sig-name descname"><span class="pre">get_flows_from_sources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influenced_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_vars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.get_flows_from_sources" title="Link to this definition">¶</a></dt>
<dd><p>Finds which flows originate in the source variables.</p>
<p>returns all flows into influencer_var that originate in the
source_vars. Variables can be unresolved but <em>must</em>
resolve to named Flow elements. <code class="docutils literal notranslate"><span class="pre">influencer_var</span></code> can be a
formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>influenced_var</strong> (<em>str</em>) – the (raw, unresolved) variable name</p></li>
<li><p><strong>source_vars</strong> (<em>{</em><em>(</em><em>str</em><em>, </em><em>str</em><em>)</em><em>}</em>) – raw (unresolved) source variable names,
but with a path tuple.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>set[<a class="reference internal" href="#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath">DataInfluencePath</a>] | None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This method only reads from the current influence
map, it does not propagate.</p></li>
<li><p>Only queries for names in the current flow-path
(This should be handled automatically as sources
are pushed forward via output variable assignments)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None if no tainted flows found, else it returns the set of
DataInfluencePaths tuples, corresponding to flows from the
source vars into the taint statement. The histories of these
paths should be passed into the results collector, but the
entire flow is provided to assist in type analysis if
needed.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>influenced_var</strong> (<em>str</em>) – </p></li>
<li><p><strong>source_vars</strong> (<em>{</em><em>(</em><em>str</em><em>, </em><em>str</em><em>)</em><em>}</em>) – </p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set[<a class="reference internal" href="#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath">DataInfluencePath</a>] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.get_or_make_vector">
<span class="sig-name descname"><span class="pre">get_or_make_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.get_or_make_vector" title="Link to this definition">¶</a></dt>
<dd><p>If used with the current flow_path (or flow_path set to None) then
we create a vector if it doesn’t exist and return it.</p>
<p>If used with some other path, then returns none if the vector doesn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowVector</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name to lookup (can be a variable name, the method
will resolve)</p></li>
<li><p><strong>flow_path</strong> (<em>str</em><em> | </em><em>None</em>) – optional flow_path (if None, will use the
filepath of current flow)</p></li>
<li><p><strong>store</strong> – whether to store the vector in the influence_map
or just return the dummy flow (if adding to an influence chain)</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>vector or None if the Name cannot be parsed or does not exist in this flow-path.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.is_in_map">
<span class="sig-name descname"><span class="pre">is_in_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.is_in_map" title="Link to this definition">¶</a></dt>
<dd><p>checks if the name is in map</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>var_name</strong> (<em>str</em>) – fully resolved name (no member)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if in map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.load_crawl_step">
<span class="sig-name descname"><span class="pre">load_crawl_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crawler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crawl_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.load_crawl_step" title="Link to this definition">¶</a></dt>
<dd><p>Updates the state after crawling to next Flow Element</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrawlStep</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>crawler</strong> (<a class="reference internal" href="#flowtest.control_flow.Crawler" title="flowtest.control_flow.Crawler"><em>Crawler</em></a>) – crawler</p></li>
<li><p><strong>crawl_step</strong> (<a class="reference internal" href="#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><em>CrawlStep</em></a><em> | </em><em>None</em>) – step to load</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>CrawlStep that was loaded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.propagate_flows">
<span class="sig-name descname"><span class="pre">propagate_flows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">type_replacements</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.propagate_flows" title="Link to this definition">¶</a></dt>
<dd><p>Propagates the BranchState.influence_map by the DataInfluenceStatement.</p>
<p>Main method to call for building a dataflow graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowVector</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>statement</strong> (<a class="reference internal" href="#public.data_obj.DataInfluenceStatement" title="public.data_obj.DataInfluenceStatement"><em>DataInfluenceStatement</em></a>) – Statement to extend flows by. The influenced of
this statement is the variable of interest whose
dataflows we want to determine.</p></li>
<li><p><strong>assign</strong> (<em>bool</em>) – If true, then statement is an assignment, E.g. a =
b, otherwise it’s an addition, e.g. or a = a+b, in which
case all the old influencers of ‘a’ are preserved and
added to those of b. (Note that populating a collection
is done by assignment)</p></li>
<li><p><strong>store</strong> (<em>bool</em>) – whether to actually update the flow vector with the
flows (True) or only return the vector</p></li>
<li><p><strong>**type_replacements</strong> – override type attributes during propagation [Expert Use]</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If no influencer flows are present,
then we return the original vector (which will just be initialization,
or self-influence). Else the vector representing all influencers
via the statement is returned.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.branch_state.filter_vectors">
<span class="sig-prename descclassname"><span class="pre">flowtest.branch_state.</span></span><span class="sig-name descname"><span class="pre">filter_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.filter_vectors" title="Link to this definition">¶</a></dt>
<dd><p>filters vectors to include only paths meeting lambda condition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_vars</strong> (<em>[</em><em>(</em><em>(</em><em>str</em><em>, </em><em>str</em><em>)</em><em>, </em><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a><em>)</em><em>]</em>) – output variables</p></li>
<li><p><strong>filter_path</strong> (<em>Callable</em><em>[</em><em>[</em><em>str</em><em>]</em><em>, </em><em>bool</em><em>]</em>) – path to filter by (if None, the current flowpath is used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered output variables</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[((str, str), <a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector">FlowVector</a>)]</p>
</dd>
</dl>
</dd></dl>

<p id="module-flowtest.control_flow">Module to generate control flow graphs and crawl schedules</p>
<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.ControlFlowGraph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">ControlFlowGraph</span></span><a class="headerlink" href="#flowtest.control_flow.ControlFlowGraph" title="Link to this definition">¶</a></dt>
<dd><p>ControlFlowGraph(start_label: ‘str’, inbound: ‘{str: [Jump]}’, segment_map: ‘{str: Segment}’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.ControlFlowGraph.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inbound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segment_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.ControlFlowGraph.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.CrawlEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">CrawlEncoder</span></span><a class="headerlink" href="#flowtest.control_flow.CrawlEncoder" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.CrawlEncoder.default">
<span class="sig-name descname"><span class="pre">default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.CrawlEncoder.default" title="Link to this definition">¶</a></dt>
<dd><p>Implement this method in a subclass such that it returns
a serializable object for <code class="docutils literal notranslate"><span class="pre">o</span></code>, or calls the base implementation
(to raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p>
<p>For example, to support arbitrary iterators, you could
implement default like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="c1"># Let the base class default method raise the TypeError</span>
    <span class="k">return</span> <span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.CrawlSchedule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">CrawlSchedule</span></span><a class="headerlink" href="#flowtest.control_flow.CrawlSchedule" title="Link to this definition">¶</a></dt>
<dd><p>CrawlSchedule(total_steps: ‘int’, total_branches: ‘int’, crawl: ‘[{str: int | str}]’, branch_map: ‘{((str, str),): BranchVisitor}’, branch_counts: ‘{((str, str),): int}’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.CrawlSchedule.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_branches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crawl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_counts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.CrawlSchedule.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">Crawler</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler" title="Link to this definition">¶</a></dt>
<dd><p>Class representing the crawl of a graph</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crawl_schedule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terminal_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history_maps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Crawler.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Constructor</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For module use only</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_steps</strong> – how many steps in crawl</p></li>
<li><p><strong>crawl_schedule</strong> – tuple of <a class="reference internal" href="#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-obj docutils literal notranslate"><span class="pre">public.data_obj.CrawlStep</span></code></a> in order of execution</p></li>
<li><p><strong>terminal_steps</strong> – tuple of <a class="reference internal" href="#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-obj docutils literal notranslate"><span class="pre">public.data_obj.CrawlStep</span></code></a>
that can end program (note, <em>not</em> in any specific order)</p></li>
<li><p><strong>history_maps</strong> – map from history to last seen crawl_step with this history</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.crawl_schedule">
<span class="sig-name descname"><span class="pre">crawl_schedule</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler.crawl_schedule" title="Link to this definition">¶</a></dt>
<dd><p>tuple(<span class="xref std std-ref">public.data_obj.CrawlStep</span>) all crawl steps in order of execution:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.current_step">
<span class="sig-name descname"><span class="pre">current_step</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler.current_step" title="Link to this definition">¶</a></dt>
<dd><p>int current step of crawl:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.from_parser">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Crawler.from_parser" title="Link to this definition">¶</a></dt>
<dd><p>Builds a crawl schedule (recommended builder)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parser</strong> (<a class="reference internal" href="#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><em>Parser</em></a>) – <a class="reference internal" href="#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flow_parser.parse.Parser</span></code></a> instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#flowtest.control_flow.Crawler" title="flowtest.control_flow.Crawler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Crawler</span></code></a> instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.get_crawl_step">
<span class="sig-name descname"><span class="pre">get_crawl_step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Crawler.get_crawl_step" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the next crawl step</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrawlStep</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#public.data_obj.BranchVisitor" title="public.data_obj.BranchVisitor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">public.data_obj.BranchVisitor</span></code></a> and flow element name to process</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.get_last_ancestor">
<span class="sig-name descname"><span class="pre">get_last_ancestor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crawl_step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Crawler.get_last_ancestor" title="Link to this definition">¶</a></dt>
<dd><p>Get latest ancestor branch that was last visited</p>
<p>Useful for knowing which influence map to clone</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrawlStep</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>crawl_step</strong> – step whose history is sought</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>CrawlStep instance or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.history_maps">
<span class="sig-name descname"><span class="pre">history_maps</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler.history_maps" title="Link to this definition">¶</a></dt>
<dd><p>crawl_step -&gt; last seen ancestor:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.terminal_steps">
<span class="sig-name descname"><span class="pre">terminal_steps</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler.terminal_steps" title="Link to this definition">¶</a></dt>
<dd><p>tuple(<span class="xref std std-ref">public.data_obj.CrawlStep</span>) steps that can terminate the program:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.total_steps">
<span class="sig-name descname"><span class="pre">total_steps</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler.total_steps" title="Link to this definition">¶</a></dt>
<dd><p>int total number of steps:</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.Jump">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">Jump</span></span><a class="headerlink" href="#flowtest.control_flow.Jump" title="Link to this definition">¶</a></dt>
<dd><p>Class representing a connector</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Jump.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_goto</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_loop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Jump.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src_name</strong> (<em>str</em>) – </p></li>
<li><p><strong>target</strong> (<em>str</em>) – </p></li>
<li><p><strong>is_goto</strong> (<em>bool</em>) – </p></li>
<li><p><strong>is_loop</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.Segment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">Segment</span></span><a class="headerlink" href="#flowtest.control_flow.Segment" title="Link to this definition">¶</a></dt>
<dd><p>Segment(label: ‘str’, traversed: ‘[str]’, subflows: ‘[int]’, jumps: ‘[Jump]’, is_terminal: ‘bool’, seen_visitors: ‘[(str, str)]’ = &lt;factory&gt;)</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Segment.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traversed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subflows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jumps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_terminal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seen_visitors=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Segment.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Segment.accept">
<span class="sig-name descname"><span class="pre">accept</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">visitor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Segment.accept" title="Link to this definition">¶</a></dt>
<dd><p>does the node accept the visitor</p>
<p>Also updates visitor state</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>visitor</strong> (<a class="reference internal" href="#public.data_obj.BranchVisitor" title="public.data_obj.BranchVisitor"><em>BranchVisitor</em></a>) – Branch Visitor trying to jump into node</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of labels to process or None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[<a class="reference internal" href="#public.data_obj.BranchVisitor" title="public.data_obj.BranchVisitor">BranchVisitor</a>] or None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.control_flow.crawl_iter">
<span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">crawl_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.crawl_iter" title="Link to this definition">¶</a></dt>
<dd><p>crawls CFG</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code>[(<a class="reference internal" href="#public.data_obj.BranchVisitor" title="public.data_obj.BranchVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BranchVisitor</span></code></a>, [&lt;class ‘flowtest.control_flow.Segment’&gt;]), <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cfg</strong> (<a class="reference internal" href="#flowtest.control_flow.ControlFlowGraph" title="flowtest.control_flow.ControlFlowGraph"><em>ControlFlowGraph</em></a>) – control flow graph</p>
</dd>
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p>current Branch visitor, list of flow elements to process, outgoing Branch Visitors</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.control_flow.get_crawl_schedule">
<span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">get_crawl_schedule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.get_crawl_schedule" title="Link to this definition">¶</a></dt>
<dd><p>Builds crawl schedule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cfg</strong> (<a class="reference internal" href="#flowtest.control_flow.ControlFlowGraph" title="flowtest.control_flow.ControlFlowGraph"><em>ControlFlowGraph</em></a>) – Control Flow Graph</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(tuple of crawl steps, tuple of terminal steps)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>((<a class="reference internal" href="#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep">CrawlStep</a>,), (<a class="reference internal" href="#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep">CrawlStep</a>,))</p>
</dd>
</dl>
</dd></dl>

<p id="module-flowtest.ESAPI">Security Encoding library</p>
<dl class="py function">
<dt class="sig sig-object py" id="flowtest.ESAPI.html_encode">
<span class="sig-prename descclassname"><span class="pre">flowtest.ESAPI.</span></span><span class="sig-name descname"><span class="pre">html_encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.ESAPI.html_encode" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>msg</strong> (<em>str</em>) – </p>
</dd>
</dl>
<p>Performs html encoding
:param msg: unicode message to encode</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>html encoded message</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>msg</strong> (<em>str</em>) – </p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.ESAPI.legal_sql_escape">
<span class="sig-prename descclassname"><span class="pre">flowtest.ESAPI.</span></span><span class="sig-name descname"><span class="pre">legal_sql_escape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.ESAPI.legal_sql_escape" title="Link to this definition">¶</a></dt>
<dd><p>Escape single quotes with two single quotes.</p>
<p>This is the SQL standard escaping.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>msg</strong> (<em>str</em>) – string to escape</p>
</dd>
</dl>
<p>Returns: escaped string</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.ESAPI.sql_enc_html_dec">
<span class="sig-prename descclassname"><span class="pre">flowtest.ESAPI.</span></span><span class="sig-name descname"><span class="pre">sql_enc_html_dec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.ESAPI.sql_enc_html_dec" title="Link to this definition">¶</a></dt>
<dd><p>Decodes html-encoded text</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>msg</strong> (<em>str</em>) – string to decode</p>
</dd>
</dl>
<p>Returns: decoded string</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.ESAPI.sql_escape">
<span class="sig-prename descclassname"><span class="pre">flowtest.ESAPI.</span></span><span class="sig-name descname"><span class="pre">sql_escape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.ESAPI.sql_escape" title="Link to this definition">¶</a></dt>
<dd><p>simple sql escape (unicode)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>msg</strong> (<em>str</em>) – string to escape</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>escapes and ‘</p>
</dd>
</dl>
</dd></dl>

<p id="module-flowtest.executor">Performs symbolic execution and vulnerability analysis</p>
<blockquote>
<div><p>&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
</div></blockquote>
<p>The executor handles the element crawl and dispatches
query handlers and dataflow updates as appropriate</p>
<dl class="py data">
<dt class="sig sig-object py" id="flowtest.executor.FOLLOW_SUBFLOWS">
<span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">FOLLOW_SUBFLOWS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#flowtest.executor.FOLLOW_SUBFLOWS" title="Link to this definition">¶</a></dt>
<dd><p>for debugging the flow being analyzed</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.executor.Frame">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">Frame</span></span><a class="headerlink" href="#flowtest.executor.Frame" title="Link to this definition">¶</a></dt>
<dd><p>Frame is responsible for managing program analysis within a single flow.</p>
<p>Execution happens along each branch, which is assigned a branch state
and branching xml element (e.g. Loop element or Decision element)</p>
<p>Branch management is via maintaining a worklist consisting of branches
that need to be processed, with each branch a tuple (State, branch elem)</p>
<p>The worklist is processed as a double-ended queue, with new branches
to be processed appended to the end and the next branch to process
pulled from the front.</p>
<p>When a subflow element is encountered, the frame builds a child frame
and returns it to the Stack.</p>
<blockquote>
<div><dl class="simple">
<dt>wire.wire_processor –&gt; parses current_elem to obtain data influence</dt><dd><p>statements and wires these into the State’s
influence map.</p>
</dd>
<dt>query.query_processor –&gt; looks for flows into sources and sinks</dt><dd><p>in the current elem, and stores findings
in result instance</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_flow_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_flow_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.all_flow_paths">
<span class="sig-name descname"><span class="pre">all_flow_paths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{str:</span> <span class="pre">str}</span></em><a class="headerlink" href="#flowtest.executor.Frame.all_flow_paths" title="Link to this definition">¶</a></dt>
<dd><p><cite>flow_name</cite> -&gt; <cite>flow_path</cite> so that when we encounter a subflow we can load the file.:</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>this is a map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.build">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_flow_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_flow_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolved_subflows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_subflow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.build" title="Link to this definition">¶</a></dt>
<dd><p>Call this whenever program analysis starts or a subflow is reached</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_flow_path</strong> (<em>str</em><em> | </em><em>None</em>) – current path of flow</p></li>
<li><p><strong>all_flow_paths</strong> (<em>{str: str}</em>) – map[flow_name: flow_path] for all flows in
scope to be scanned</p></li>
<li><p><strong>resolved_subflows</strong> (<em>{}</em>) – subflows that have been already processed</p></li>
<li><p><strong>parent_subflow</strong> (<em>ET._Element</em>) – current subflow element that spawned this
frame</p></li>
<li><p><strong>query_manager</strong> (<em>QueryManager</em>) – manages query instances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new Frame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame">Frame</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.child_spawned">
<span class="sig-name descname"><span class="pre">child_spawned</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#flowtest.executor.Frame.child_spawned" title="Link to this definition">¶</a></dt>
<dd><p>binary semaphore so when we return, we don’t execute spawn the subflow again:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.crawler">
<span class="sig-name descname"><span class="pre">crawler</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Crawler</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flowtest.executor.Frame.crawler" title="Link to this definition">¶</a></dt>
<dd><p>supplies next element and branch-state to process:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.execute" title="Link to this definition">¶</a></dt>
<dd><p>Performs symbolic execution on the Frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><code class="xref py py-class docutils literal notranslate"><span class="pre">Frame</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new Frame to process in case a subflow has been launched,</p>
</dd>
</dl>
<p>and finally returning None when the Frame’s processing is complete.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.flow_name">
<span class="sig-name descname"><span class="pre">flow_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flowtest.executor.Frame.flow_name" title="Link to this definition">¶</a></dt>
<dd><p>name of flow we are working on. Needed for loading subflows:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.flow_path">
<span class="sig-name descname"><span class="pre">flow_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#flowtest.executor.Frame.flow_path" title="Link to this definition">¶</a></dt>
<dd><p>path of flow we are working on, needed when labelling inputs/outputs:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.get_consolidated_output_vars">
<span class="sig-name descname"><span class="pre">get_consolidated_output_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.get_consolidated_output_vars" title="Link to this definition">¶</a></dt>
<dd><p>get all output variable vectors from all terminal BranchStates.</p>
<p>Call this method after flow processing has completed for a subflow
in order to return all possible output variables to the parent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a map (flow_path, variable name) -&gt; FlowVector</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>{(str, str): flows.FlowVector}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.handle_subflows">
<span class="sig-name descname"><span class="pre">handle_subflows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.handle_subflows" title="Link to this definition">¶</a></dt>
<dd><p>Checks whether we have encountered a subflow elem.</p>
<p>Different behavior required if we are returning from the element or entering into it.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><code class="xref py py-class docutils literal notranslate"><span class="pre">Frame</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>current_elem</strong> (<em>_Element</em>) – Flow element to check</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>new Frame in case we are entering a new subflow, or None in
case we are returning from the subflow.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.parent_subflow">
<span class="sig-name descname"><span class="pre">parent_subflow</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ET._Element</span></em><a class="headerlink" href="#flowtest.executor.Frame.parent_subflow" title="Link to this definition">¶</a></dt>
<dd><p>Subflow XML element that launched this flow (can be None):</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.parser">
<span class="sig-name descname"><span class="pre">parser</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">parse.Parser</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flowtest.executor.Frame.parser" title="Link to this definition">¶</a></dt>
<dd><p>XML parser instance:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.query_manager">
<span class="sig-name descname"><span class="pre">query_manager</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">QueryManager</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flowtest.executor.Frame.query_manager" title="Link to this definition">¶</a></dt>
<dd><p>query processor instance:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.resolved_subflows">
<span class="sig-name descname"><span class="pre">resolved_subflows</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#flowtest.executor.Frame.resolved_subflows" title="Link to this definition">¶</a></dt>
<dd><p>placeholder for fast-forward scans (not currently used):</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.spawn_child_frame">
<span class="sig-name descname"><span class="pre">spawn_child_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subflow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.spawn_child_frame" title="Link to this definition">¶</a></dt>
<dd><p>Spawn a child frame when entering subflow.</p>
<section id="function-call-and-return">
<h2>Function Call and Return<a class="headerlink" href="#function-call-and-return" title="Link to this heading">¶</a></h2>
<p>When exiting a function, only those influence elements that survive are the output
variables. These are then mapped to variables in the calling flow based on assignments
in the subflow element.</p>
<p>Entering: we have a map (filename_parent, var_parent) –&gt; (filename_child, var_child)
Exiting: another map (filename_child, var_child) —&gt; (filename_parent, var_parent)</p>
<p>To spawn:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>get path of child flow</p></li>
<li><p>Build frame with Frame.build</p></li>
<li><p>Wire the input flows into the child and add them to the child’s state</p></li>
<li><p>set self.child_spawned = True (so when we return, we don’t spawn again!)</p></li>
<li><p>return the new Frame.</p></li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the parser object remembers all the sources and sinks from the parent
and these are available to the child as well (the old parser is propagated
to the child, as is the old result instance)</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">param sub_path<span class="colon">:</span></dt>
<dd class="field-odd"><p>filepath of subflow being called</p>
</dd>
<dt class="field-even">param input_map<span class="colon">:</span></dt>
<dd class="field-even"><p>map of output variables in child to input variables of subflow</p>
</dd>
<dt class="field-odd">param vector_map<span class="colon">:</span></dt>
<dd class="field-odd"><p>map from tuple to the flow vectors that will be pushed into the child</p>
</dd>
<dt class="field-even">param subflow<span class="colon">:</span></dt>
<dd class="field-even"><p>subflow xml element</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>updated child frame ready to begin processing</p>
</dd>
</dl>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subflow</strong> (<em>ET._Element</em>) – </p></li>
<li><p><strong>sub_path</strong> (<em>str</em>) – </p></li>
<li><p><strong>input_map</strong> (<em>{str: str}</em>) – </p></li>
<li><p><strong>vector_map</strong> (<em>{</em><em>(</em><em>str</em><em>, </em><em>str</em><em>)</em><em>: flows.FlowVector}</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame">Frame</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.state">
<span class="sig-name descname"><span class="pre">state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">BranchState</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#flowtest.executor.Frame.state" title="Link to this definition">¶</a></dt>
<dd><p>current state being processed:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.update_parent_frame">
<span class="sig-name descname"><span class="pre">update_parent_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_vector_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.update_parent_frame" title="Link to this definition">¶</a></dt>
<dd><p>Updates the provided parent frame with the return values of the current frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>parent_frame</strong> (<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><em>Frame</em></a>) – </p>
</dd>
</dl>
<dl class="simple">
<dt>There are two updates:</dt><dd><ul class="simple">
<li><p>New Sources discovered in the child frame – these should be added to sources in parent</p></li>
<li><p>New Influence Paths that flow into the output variables of the subflow (must be mapped
to input variables)</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_vector_map</strong> – map from tuples to output vectors of the child subflow</p></li>
<li><p><strong>parent_frame</strong> (<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><em>Frame</em></a>) – frame which spawned the current frame via a
subflow</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.executor.Stack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">Stack</span></span><a class="headerlink" href="#flowtest.executor.Stack" title="Link to this definition">¶</a></dt>
<dd><p>The Stack handles subflow invocation.</p>
<p>When we pass to a subflow a new frame is pushed on the stack and when we
return it is popped.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Stack.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_flow_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_flow_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_manager</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Stack.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Constructor (should be used)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_flow_path</strong> – current filename of flow being processed</p></li>
<li><p><strong>all_flow_paths</strong> – map[flow_name] -&gt; flow_path of all files in scope</p></li>
<li><p><strong>query_manager</strong> – invokes queries and stores results</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Results:</dt><dd><p>result instance object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Stack.all_flow_paths">
<span class="sig-name descname"><span class="pre">all_flow_paths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{str:</span> <span class="pre">str}</span></em><a class="headerlink" href="#flowtest.executor.Stack.all_flow_paths" title="Link to this definition">¶</a></dt>
<dd><p>map from flow name to flow filepath (for subflow path lookup)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Stack.current_frame">
<span class="sig-name descname"><span class="pre">current_frame</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Frame</span></em><a class="headerlink" href="#flowtest.executor.Stack.current_frame" title="Link to this definition">¶</a></dt>
<dd><p>current frame being processed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Stack.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Stack.pop" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><code class="xref py py-class docutils literal notranslate"><span class="pre">Frame</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>next frame from stack or None if none available</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Stack.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Stack.push" title="Link to this definition">¶</a></dt>
<dd><p>Pushes a frame onto stack, call when invoking a subflow</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frame</strong> (<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><em>Frame</em></a>) – frame to push to the top of the stack</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Stack.query_manager">
<span class="sig-name descname"><span class="pre">query_manager</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">QueryManager</span></em><a class="headerlink" href="#flowtest.executor.Stack.query_manager" title="Link to this definition">¶</a></dt>
<dd><p>pointer to query manager so that it can be returned on exit</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Stack.resolved_subflows">
<span class="sig-name descname"><span class="pre">resolved_subflows</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{str:</span> <span class="pre">{(str,</span> <span class="pre">str):</span> <span class="pre">flows.FlowVector}}</span></em><a class="headerlink" href="#flowtest.executor.Stack.resolved_subflows" title="Link to this definition">¶</a></dt>
<dd><p>subflows that have already been processed
subflow name –&gt; Flow Vectors
{(str, str): flows.FlowVector}:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Stack.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Stack.run" title="Link to this definition">¶</a></dt>
<dd><p>Main entry point for symbolic execution of an initialized stack</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryManager</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Query Manager object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flowtest.executor.logger">
<span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Logger</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">flowtest.executor</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#flowtest.executor.logger" title="Link to this definition">¶</a></dt>
<dd><p>logger for current module</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.executor.parse_flow">
<span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">parse_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flow_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requestor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">service_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_module_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_class_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_preset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.parse_flow" title="Link to this definition">¶</a></dt>
<dd><p>Main loop that performs control and dataflow analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flow_path</strong> (<em>str</em>) – path (on filesystem) of flow-meta.xml file</p></li>
<li><p><strong>requestor</strong> (<em>str</em>) – email address of scan recipient (optional)</p></li>
<li><p><strong>report_label</strong> (<em>str</em>) – human-readable name for report (optional)</p></li>
<li><p><strong>result_id</strong> (<em>str</em>) – id of report (for use in a jobs management system) (optional)</p></li>
<li><p><strong>service_version</strong> (<em>str</em>) – version of jobs management system (optional)</p></li>
<li><p><strong>help_url</strong> (<em>str</em>) – url to display on report for more info about results (optional)</p></li>
<li><p><strong>query_module_path</strong> (<em>str</em>) – path of module where custom queries are stored</p></li>
<li><p><strong>query_class_name</strong> (<em>str</em>) – name of query class to instantiate</p></li>
<li><p><strong>query_preset</strong> (<em>str</em>) – name of preset to run</p></li>
<li><p><strong>query_manager</strong> (<em>QueryManager</em><em> | </em><em>None</em>) – existing instance that invokes queries across entire run. Start with None
and one will be created.</p></li>
<li><p><strong>all_flows</strong> (<em>{str: str}</em>) – map flow name -&gt; path of flow (used for looking up flow paths of subflows)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>instance of ger_report.Result class that can be used to generate reports
or passed to other flows.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>QueryManager</p>
</dd>
</dl>
</dd></dl>

<p id="module-flowtest.flow_metrics">Python module for parsing xml result file and generating html reports.
&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
<p>This file will read from the package</p>
<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.add_to_query_config">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">add_to_query_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_of_desc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.add_to_query_config" title="Link to this definition">¶</a></dt>
<dd><p>Adds query descriptions to module-level config file if not present</p>
<p>Call after loading any queries from disk. Must pass
an object of type public.data_obj.QueryDescription</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>list_of_desc</strong> (<em>[</em><a class="reference internal" href="#public.data_obj.QueryDescription" title="public.data_obj.QueryDescription"><em>QueryDescription</em></a><em>]</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError if query descriptions are already present</strong> – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.count_issues">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">count_issues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan_results</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.count_issues" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scan_results</strong> – scan_results: List&lt;QueryData&gt;</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>security issues, quality issues total counts from
scan_results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.get_issues_for_org">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">get_issues_for_org</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vuln_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.get_issues_for_org" title="Link to this definition">¶</a></dt>
<dd><p>Counts findings for each query</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scan_results</strong> – List&lt;Query Data&gt; list of found issues</p></li>
<li><p><strong>vuln_map</strong> – map of scan info fields to CX issues e.g.
vuln_map[StoredXSS]=[cx_desc1,cx_desc2,] etc.</p></li>
</ul>
</dd>
</dl>
<p>(A bit inefficient since we loop through all queries rather than
removing already used queries, but this is not a concern here.)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dictionary with keys = issue types in scan info and number of
issues found</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.get_software_presets">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">get_software_presets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preset_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.get_software_presets" title="Link to this definition">¶</a></dt>
<dd><p>Returns empty list if no software presets found with this name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>preset_name</strong> (<em>str</em>) – name of preset to retrieve</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of query names in this preset</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.parse_results">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">parse_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xml_report_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">failed_queries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">throttle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">email_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">friendly_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">service_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'3.0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_api_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.parse_results" title="Link to this definition">¶</a></dt>
<dd><p>Parses Cx xml results file and generates HTML report.</p>
<blockquote>
<div><p>Parsing policy:</p>
<ul class="simple">
<li><p>HTML write: For query, result, and Path events, We write HTML at start.</p></li>
<li><p>For pathNode, we write HTML at end..</p></li>
<li><p>query_data is instantiated in start of Query tags</p></li>
<li><p>query_data is updated at start events of Result tags (we count the number if results)</p></li>
<li><p>clean up occurs at end events.</p></li>
<li><p>query_data is inserted into result at end of Query tags</p></li>
<li><p>The footer is written at the end of the root elem.</p></li>
</ul>
<p>Attributes set during start events but not tag contents.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xml_file</strong> – unicode path of xml file containing results</p></li>
<li><p><strong>xml_report_str</strong> – unicode str of xml report (if file not provided)</p></li>
<li><p><strong>report_path</strong> – (required for report gen) unicode path where the
HTML report should be stored</p></li>
<li><p><strong>failed_queries</strong> – pulled from log file. list of query_paths that
failed.</p></li>
<li><p><strong>throttle</strong> – Boolean (whether to limit the number of issues found
per query)</p></li>
<li><p><strong>source_dir</strong> – unicode directory where source code is stored (on
Cx)</p></li>
<li><p><strong>email_add</strong> – unicode email address to which report should be sent</p></li>
<li><p><strong>friendly_name</strong> – unicode friendly name of scan</p></li>
<li><p><strong>job_type</strong> – unicode job type (TZ, Portal)</p></li>
<li><p><strong>preset</strong> – preset used</p></li>
<li><p><strong>scan_start</strong> – unicode scan start time</p></li>
<li><p><strong>scan_end</strong> – unicode scan end time</p></li>
<li><p><strong>result_id</strong> – scan queue id (on security org)</p></li>
<li><p><strong>service_version</strong> – version of popcrab + queries running this scan</p></li>
<li><p><strong>debug</strong> – True or False (for logging/tracing)</p></li>
<li><p><strong>min_api_version</strong> – float (flag lightning bundles of an earlier
version)</p></li>
<li><p><strong>help_url</strong> – url where report viewers can get more help</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>job_info, List&lt;QueryData&gt; scan_results</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.reverse_map">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">reverse_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vuln_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.reverse_map" title="Link to this definition">¶</a></dt>
<dd><p>Go from 1) a dict of field names to vuln name list
to 2) a dict of vuln names to field name lists</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.serialize">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">serialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">portion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.serialize" title="Link to this definition">¶</a></dt>
<dd><p>serializes element from iterparse.
(N.B: iterparse returns bytestrings, not code points. This is true for events, tags, etc.
Because we are using unicode literals, this means a decoding will occur. Decoding automatically
occurs when concatenating a string with a unicode code point)</p>
</dd></dl>

<p id="module-flowtest.flow_result">Serializes results and interacts with
third party report processors</p>
<blockquote>
<div><p>&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.flow_result.</span></span><span class="sig-name descname"><span class="pre">ResultsProcessor</span></span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor" title="Link to this definition">¶</a></dt>
<dd><p>Class storing all the information necessary for a report.</p>
<p>This includes labelling information like the report requested,
scan start time, etc., as well as the results of the findings.</p>
<p>The class contains methods to take this information and generate
json, xml and html reports.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requestor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'System'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">service_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.6.5-ALPHA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'https://security.secure.force.com/security/tools/forcecom/scannerhelp'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>preset</strong> (<a class="reference internal" href="#public.data_obj.Preset" title="public.data_obj.Preset"><em>Preset</em></a><em> | </em><em>None</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.add_results">
<span class="sig-name descname"><span class="pre">add_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_results</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.add_results" title="Link to this definition">¶</a></dt>
<dd><p>Add results to processor</p>
<p>Stores results internally for simple de-duplication.
All we do is use datapath equality, so please don’t put
unique comment strings containing things like step number
or timestamps into influence statements, as they wont be
de-duped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>query_results</strong> (<em>[</em><a class="reference internal" href="#public.data_obj.QueryResult" title="public.data_obj.QueryResult"><em>QueryResult</em></a><em>]</em>) – list of Query-Result objects</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.dump_json">
<span class="sig-name descname"><span class="pre">dump_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.dump_json" title="Link to this definition">¶</a></dt>
<dd><p>Write json string of results to file pointer</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fp</strong> (<em>TextIO</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.gen_result_dict">
<span class="sig-name descname"><span class="pre">gen_result_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.gen_result_dict" title="Link to this definition">¶</a></dt>
<dd><p>Sorts results into query buckets</p>
<p>Used internally to generate popcrab compatible
xml and html report formats.</p>
<p>Also useful for testing</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>dictionary of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query_id</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="n">flow</span><span class="p">:</span> <span class="nb">tuple</span> <span class="n">of</span> <span class="n">DataInfluenceStatements</span><span class="p">,</span>
               <span class="n">query_name</span><span class="p">:</span> <span class="p">(</span><span class="n">human_readable</span><span class="p">),</span>
               <span class="n">counter</span><span class="p">:</span> <span class="p">(</span><span class="n">fake</span> <span class="n">similarity</span> <span class="nb">id</span><span class="p">),</span>
               <span class="n">elem</span><span class="p">:</span> <span class="n">source</span> <span class="n">code</span> <span class="n">of</span> <span class="n">element</span>
               <span class="n">elem_name</span><span class="p">:</span> <span class="n">name</span> <span class="n">of</span> <span class="n">Flow</span> <span class="n">Element</span>
               <span class="n">field</span><span class="p">:</span> <span class="n">name</span> <span class="n">of</span> <span class="n">influenced</span> <span class="n">variable</span><span class="p">}</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>{str: {str: str}}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.get_cx_xml_str">
<span class="sig-name descname"><span class="pre">get_cx_xml_str</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.get_cx_xml_str" title="Link to this definition">¶</a></dt>
<dd><p>Converts results to popcrab compatible report format</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>report xml string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.get_json_str">
<span class="sig-name descname"><span class="pre">get_json_str</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.get_json_str" title="Link to this definition">¶</a></dt>
<dd><p>get json result string</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>string that serializes list of QueryResult objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.write_html">
<span class="sig-name descname"><span class="pre">write_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">html_report_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.write_html" title="Link to this definition">¶</a></dt>
<dd><p>Writes html report to disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>html_report_path</strong> (<em>str</em>) – where to write html report</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>metrics (results) of issues sorted and counted.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-flowtest.flows">Flow propagation data structures and algorithms</p>
<p>&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.flows.</span></span><span class="sig-name descname"><span class="pre">FlowVector</span></span><a class="headerlink" href="#flowtest.flows.FlowVector" title="Link to this definition">¶</a></dt>
<dd><p>Common data structure for both vectors and scalars.</p>
<p>FlowVector supports vectorization, so that we can accurately
track taint as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">taint</span> <span class="o">--&gt;</span> <span class="n">Case</span><span class="o">.</span><span class="n">Subject</span>
<span class="n">Case</span>  <span class="o">--&gt;</span> <span class="n">Case2</span>
<span class="n">Case2</span><span class="o">.</span><span class="n">Status</span>  <span class="o">--&gt;</span> <span class="n">sink1</span>  <span class="o">//</span> <span class="n">detect</span> <span class="ow">not</span> <span class="n">tainted</span>
<span class="n">Case2</span><span class="o">.</span><span class="n">Subject</span> <span class="o">--&gt;</span> <span class="n">sink2</span>  <span class="o">//</span> <span class="n">detect</span> <span class="n">tainted</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property_maps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>property_maps</strong> (<em>dict</em><em>[</em><em>slice</em><em>(</em><em>&lt;class 'public.data_obj.DataInfluencePath'&gt;</em><em>, </em><em>dict</em><em>[</em><em>slice</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>set</em><em>[</em><a class="reference internal" href="#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><em>public.data_obj.DataInfluencePath</em></a><em>]</em><em>, </em><em>None</em><em>)</em><em>]</em><em>, </em><em>None</em><em>)</em><em>]</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.add_vector">
<span class="sig-name descname"><span class="pre">add_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.add_vector" title="Link to this definition">¶</a></dt>
<dd><p>Create new vector that adds flows of self and <code class="docutils literal notranslate"><span class="pre">vector</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowVector</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vector</strong> (<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a>) – </p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Both must be at the same variable name</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vector</strong> (<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a>) – vector containing new flow information</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a></p>
</dd>
</dl>
<p>Returns: new FlowVector representing the sum</p>
<section id="adding-vectors">
<h2>Adding Vectors<a class="headerlink" href="#adding-vectors" title="Link to this heading">¶</a></h2>
<p>In flows, the concept of “adding” objects or scalars
is overloaded to mean either</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>adding an element to a collection (object or scalar), or</p></li>
<li><p>combining two scalar values (e.g. string concatenation)</p></li>
</ol>
</div></blockquote>
<p>For dataflow analysis, we also add vectors to consolidate
paths, for example when exiting a flow.</p>
<p>This means that all the influencers of
the first are added to the influencers of the second (which
can create a doubling of flow paths).</p>
<p>Care must be taken when the generic case is the same but overrides
differ. Imagine program execution along two branches, followed
by combining the branches (say a function return). Then we
know that in reality, only one branch can be taken in an execution
run, but there is the possibility of cross-contamination. E.g.
in branch 1, Account.Name can change, and in branch 2, Account.Description,
but when we merge, we need to decide whether to combine both into “account”
and merge the overrides or to keep them as separate vectors with different
overrides. This boils down to whether the default vector is a key for the
override map or whether the better data structure is a tuple of a vector
and its overrides, with the addition operation always adding new tuples.</p>
<p>Presently we opt for first approach - merging the overrides
of the two vectors, because in principle, we still retain all the
information in the override dataflow histories - for example, we can store
the state branch id in each path - and it is the examination of the overrides
where fine-grained exclusion analysis should happen.</p>
<p>This choice forces us to create dummy (induced) overrides because
the nature of overrides is that they are always selected, so if A.Name has
an override but B doesn’t, then we want to get both B.Name and A.Name
when we request the property of the sum.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.from_flows">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_flows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.from_flows" title="Link to this definition">¶</a></dt>
<dd><p>Builds a vector from the provided flows.</p>
<p>Flows must all have the same influencer_name and no flow can have a non-null influencer_property.</p>
<p class="rubric">Notes</p>
<p>Do not use FlowVector constructor outside the <code class="docutils literal notranslate"><span class="pre">flows</span></code> module, use this method instead
and build FlowVectors up using the provided instance methods as a result of parsing program
elements.</p>
<p>This method should be used to initialize variables by building the initialization flow
(where a variable influences itself)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>{DataInfluencePath}</strong> (<em>default</em>) – each of these paths should be assigned to their own default</p></li>
<li><p><strong>default</strong> (<em>{DataInfluencePath}</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>FlowVector instance with the provided flows as defaults</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError if the flows have different influenced_name</strong><strong>, or </strong><strong>if default is empty.</strong> – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector">FlowVector</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.get_flows_by_prop">
<span class="sig-name descname"><span class="pre">get_flows_by_prop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">member_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.get_flows_by_prop" title="Link to this definition">¶</a></dt>
<dd><p>Returns this vector’s flows with the requested influenced property name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>member_name</strong> (<em>str</em><em> | </em><em>None</em>) – If None, returns all flows (including overrides)
Otherwise, returns all flows for the named property.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The requested flows associated to <em>all default indexes</em> consolidated into a set,
or empty set if no match.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{DataInfluencePath}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.push_via_flow">
<span class="sig-name descname"><span class="pre">push_via_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extension_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influenced_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_flow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.push_via_flow" title="Link to this definition">¶</a></dt>
<dd><p>Build new FlowVector with all influence paths in self pushed into <code class="docutils literal notranslate"><span class="pre">vec</span></code> via the extension_path.</p>
<p>For example, if the current vector corresponds to influencers of <code class="docutils literal notranslate"><span class="pre">A</span></code>, and <code class="docutils literal notranslate"><span class="pre">vec</span></code> to <code class="docutils literal notranslate"><span class="pre">B</span></code>,</p>
<p>Consider the following cases:</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowVector</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>extension_path</strong> (<a class="reference internal" href="#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><em>DataInfluencePath</em></a>) – </p></li>
<li><p><strong>influenced_vec</strong> (<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a>) – </p></li>
<li><p><strong>assign</strong> (<em>bool</em>) – </p></li>
<li><p><strong>cross_flow</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">1.</span>&#160;&#160; <span class="pre">A.x</span> <span class="pre">--&gt;</span> <span class="pre">B</span></code></dt><dd><p>Then <code class="docutils literal notranslate"><span class="pre">B</span></code> must be a scalar and the default of <code class="docutils literal notranslate"><span class="pre">B</span></code> is populated with the extended influencers
of <code class="docutils literal notranslate"><span class="pre">A</span></code>’s x property. If <code class="docutils literal notranslate"><span class="pre">assign</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, then the existing influencers of <code class="docutils literal notranslate"><span class="pre">B</span></code>’s x
property are added to those pushed forward from <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">2.</span>&#160;&#160; <span class="pre">A</span> <span class="pre">--&gt;</span> <span class="pre">B.x</span></code></dt><dd><p>Then <code class="docutils literal notranslate"><span class="pre">A</span></code> must be a scalar and the defaults of <code class="docutils literal notranslate"><span class="pre">A</span></code> are pushed forward into <code class="docutils literal notranslate"><span class="pre">B</span></code>’s x-property
influencers. If <code class="docutils literal notranslate"><span class="pre">assign</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, then <code class="docutils literal notranslate"><span class="pre">B</span></code>’s existing property influencers are also kept.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">3.</span>&#160;&#160; <span class="pre">A.x</span> <span class="pre">--&gt;</span> <span class="pre">B.x</span></code></dt><dd><p>Then <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> must be Objects, and the x-property influencers of <code class="docutils literal notranslate"><span class="pre">B</span></code> are reassigned
to those pushed forward from <code class="docutils literal notranslate"><span class="pre">A.x</span></code>, and if <cite>assign</cite> is <cite>False</cite>, B also retains its existing
x-property influencers.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">4.</span>&#160;&#160; <span class="pre">A</span> <span class="pre">--&gt;</span> <span class="pre">B</span></code></dt><dd><p>Then all the influencers of A are pushed forward to B, either replacing <code class="docutils literal notranslate"><span class="pre">B</span></code> or
adding to <code class="docutils literal notranslate"><span class="pre">B</span></code>’s existing influencers.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extension_path</strong> (<a class="reference internal" href="#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><em>DataInfluencePath</em></a>) – DataInfluencePath to push forward by</p></li>
<li><p><strong>influenced_vec</strong> (<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a>) – The target vector that is influenced by the statement</p></li>
<li><p><strong>assign</strong> (<em>bool</em>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> for assignment and <code class="docutils literal notranslate"><span class="pre">False</span></code> for addition. Note that
object addition corresponds to enlarging a collection.</p></li>
<li><p><strong>cross_flow</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, allows this extension to cross flows, which requires
the flow being extended by to cross flows.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new FlowVector</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError if there is a variable name mismatch.</strong> – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.report_dict">
<span class="sig-name descname"><span class="pre">report_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.report_dict" title="Link to this definition">¶</a></dt>
<dd><p>get brief object dict with stringified flows</p>
<p>flows are replaced with arrow and star notation
in <code class="xref py py-meth docutils literal notranslate"><span class="pre">DataInfluencePath.short_report()</span></code> and are
sorted alphabetically in all keys and (non-None) values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>dict with the following schema:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">default</span> <span class="n">flows</span> <span class="p">:</span> <span class="p">{</span><span class="n">property_name</span><span class="p">:</span> <span class="p">{</span><span class="n">flows</span><span class="p">}}</span> <span class="o">|</span> <span class="kc">None</span> <span class="p">}</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>{str: {str: {str}}}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.short_report">
<span class="sig-name descname"><span class="pre">short_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.short_report" title="Link to this definition">¶</a></dt>
<dd><p>Brief string serialization of the FlowVector (for testing and reporting)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>indent</strong> – number of spaces for indentation</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>summary of defaults and property maps</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-flowtest.query_manager">Responsible for loading and invoking query instances.</p>
<p>&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="flowtest.query_manager.QueryAction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.query_manager.</span></span><span class="sig-name descname"><span class="pre">QueryAction</span></span><a class="headerlink" href="#flowtest.query_manager.QueryAction" title="Link to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.query_manager.create_module">
<span class="sig-prename descclassname"><span class="pre">flowtest.query_manager.</span></span><span class="sig-name descname"><span class="pre">create_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.query_manager.create_module" title="Link to this definition">¶</a></dt>
<dd><p>Loads and Instantiates QueryProcessor</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>module_path</strong> (<em>str</em>) – location of module to load</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>QueryProcessor module</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError if module name cannot be parsed</strong><strong> or </strong><strong>preset not accepted</strong> – </p></li>
<li><p><strong>ImportError if the module cannot be loaded</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py data" id="module-flowtest.util">
<dt class="sig sig-object py" id="flowtest.util.CURR_DIR">
<span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">CURR_DIR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'/Users/rsussland/dev/git/FlowSecurityLinter/docsrc'</span></em><a class="headerlink" href="#flowtest.util.CURR_DIR" title="Link to this definition">¶</a></dt>
<dd><p>Crawling limits</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.util.Worklist">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">Worklist</span></span><a class="headerlink" href="#flowtest.util.Worklist" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Class that simulates a worklist with</dt><dd><p>de-duplication and priority queue.</p>
</dd>
</dl>
<p>We want to process jump connectors last in order to
compute dataflow traces over everything that changed
except the connectors having been taken</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.util.Worklist.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_worklist_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.Worklist.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_worklist_size</strong> (<em>int</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.util.Worklist.add_to_queue">
<span class="sig-name descname"><span class="pre">add_to_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.Worklist.add_to_queue" title="Link to this definition">¶</a></dt>
<dd><p>Appends to queue</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>defer</strong> – True if it should go into deferred queue or False into priority queue</p></li>
<li><p><strong>state</strong> (<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><em>BranchState</em></a>) – state to append</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – element that is the next elem for state</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.util.Worklist.contents">
<span class="sig-name descname"><span class="pre">contents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.Worklist.contents" title="Link to this definition">¶</a></dt>
<dd><p>get contents of Worklist</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of (state, elem) tuples</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>[(<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState">BranchState</a>, ET._Element)]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.util.Worklist.get_size">
<span class="sig-name descname"><span class="pre">get_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.Worklist.get_size" title="Link to this definition">¶</a></dt>
<dd><p>get number of unprocessed items worklist</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.util.Worklist.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.Worklist.is_empty" title="Link to this definition">¶</a></dt>
<dd><p>is the worklist empty?</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if empty, else False</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.util.Worklist.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.Worklist.pop" title="Link to this definition">¶</a></dt>
<dd><p>pop from priority queue</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>next (State, elem) pair or None if queue empty</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState">BranchState</a>, ET._Element) or None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.util.get_flows_in_dir">
<span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">get_flows_in_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.get_flows_in_dir" title="Link to this definition">¶</a></dt>
<dd><p>Searches recursively through for flows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>root_dir</strong> (<em>str</em>) – directory in which to search</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a dict flow_name -&gt; filename</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{str: str}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.util.make_id">
<span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">make_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.make_id" title="Link to this definition">¶</a></dt>
<dd><p>Generates unique id strings</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>8 digit unique id as str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.util.propagate">
<span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">propagate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">replacements</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.propagate" title="Link to this definition">¶</a></dt>
<dd><p>Propagate attributes across flows.</p>
<p>For example, if we know that a variable
of type ‘Account’ is passed into loop, then we want to remember
that the object type of this loop is Account. This works if we leave
all properties none unless we are certain of their values and then
adopt this simple method. Longer term, we may need to put conditional
logic, but now add a replacement field for manual override.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#public.data_obj.VariableType" title="public.data_obj.VariableType"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariableType</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>src_type</strong> (<a class="reference internal" href="#public.data_obj.VariableType" title="public.data_obj.VariableType"><em>VariableType</em></a>) – </p></li>
<li><p><strong>dest_type</strong> (<a class="reference internal" href="#public.data_obj.VariableType" title="public.data_obj.VariableType"><em>VariableType</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p id="module-flowtest.wire"><span id="module-flowtest.version"></span>performs dataflow wiring for flow elements</p>
<section id="wiring-policy">
<h2>Wiring Policy<a class="headerlink" href="#wiring-policy" title="Link to this heading">¶</a></h2>
<p>Wiring policy for flow elements</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;start&gt; - Not wired.</p></li>
<li><p>&lt;startElementReference&gt; - Not wired.</p></li>
<li><dl class="simple">
<dt>&lt;screens&gt; - TBD. Screens are complex and deserving of a separate study. Presently we wire associated</dt><dd><p>Objects as well as input variables. But there is much work to do.</p>
</dd>
</dl>
</li>
<li><p>&lt;assignments&gt; - wire assignment, target variable auto-added</p></li>
<li><p>&lt;recordLookups&gt; - (flow element should be added)</p></li>
<li><p>&lt;recordCreates&gt; - (flow element should be added)</p></li>
<li><p>&lt;recordUpdates&gt; - (flow element should be added)</p></li>
<li><p>&lt;recordDeletes&gt; - (flow element should be added)</p></li>
<li><p>&lt;collectionProcessors&gt; - (flow element name) should be added and collection variable wired to it (for filters)</p></li>
<li><p>&lt;loops&gt; - Loop variable (flow element name) should be added and collection variable wired to it</p></li>
<li><p>&lt;decisions&gt; - Not wired</p></li>
<li><p>&lt;subflows&gt; - Handled with custom methods in <a class="reference internal" href="#module-flowtest.executor" title="flowtest.executor"><code class="xref py py-mod docutils literal notranslate"><span class="pre">flowtest.executor</span></code></a></p></li>
</ul>
</div></blockquote>
<p>The following flow elements represent data initialized at flow start
and are handled by the parser, they are not wired</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;choices&gt;</p></li>
<li><p>&lt;dynamicChoiceSets&gt;</p></li>
<li><p>&lt;textTemplates&gt;</p></li>
<li><p>&lt;formulas&gt;</p></li>
<li><p>&lt;constants&gt;</p></li>
<li><p>&lt;variables&gt;</p></li>
</ul>
</div></blockquote>
<p>The following are uncategorized</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;stages&gt; - TBD</p></li>
<li><p>&lt;actionCalls&gt; - TBD</p></li>
</ul>
</div></blockquote>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="flowtest.wire.wire">
<span class="sig-prename descclassname"><span class="pre">flowtest.wire.</span></span><span class="sig-name descname"><span class="pre">wire</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.wire.wire" title="Link to this definition">¶</a></dt>
<dd><p>Wires influence statements and variable initialization.</p>
<p>When the value of one variable changes based on another.
Once detected, this module extends the influence map by
each statement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><em>BranchState</em></a>) – current instance of Branch State</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – Flow Element to be wired</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.wire.wire_assignment">
<span class="sig-prename descclassname"><span class="pre">flowtest.wire.</span></span><span class="sig-name descname"><span class="pre">wire_assignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.wire.wire_assignment" title="Link to this definition">¶</a></dt>
<dd><p>Wires assignment statements to influence map in <cite>state</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><em>BranchState</em></a>) – current Branch State</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – assignment element to be wired</p></li>
<li><p><strong>elem_name</strong> (<em>str</em>) – element name passed in for convenience</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.wire.wire_collection_processor">
<span class="sig-prename descclassname"><span class="pre">flowtest.wire.</span></span><span class="sig-name descname"><span class="pre">wire_collection_processor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.wire.wire_collection_processor" title="Link to this definition">¶</a></dt>
<dd><p>Wires collection reference in collection processor to collection elem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><em>BranchState</em></a>) – current Branch State</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – assignment element to be wired</p></li>
<li><p><strong>elem_name</strong> (<em>str</em>) – element name passed in for convenience</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.wire.wire_loop">
<span class="sig-prename descclassname"><span class="pre">flowtest.wire.</span></span><span class="sig-name descname"><span class="pre">wire_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.wire.wire_loop" title="Link to this definition">¶</a></dt>
<dd><p>Wires collection loop is over to loop variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><em>BranchState</em></a>) – current Branch State</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – assignment element to be wired</p></li>
<li><p><strong>elem_name</strong> (<em>str</em>) – element name passed in for convenience</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-public.contracts">Interface definitions for custom queries</p>
<p>Caution:: If building a custom query, only develop against the ref:mod:<cite>public</cite> module
otherwise the custom query code will break on upgrades.</p>
<dl class="py class">
<dt class="sig sig-object py" id="public.contracts.FlowParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.contracts.</span></span><span class="sig-name descname"><span class="pre">FlowParser</span></span><a class="headerlink" href="#public.contracts.FlowParser" title="Link to this definition">¶</a></dt>
<dd><p>Exposes global information about the current flow</p>
<dl class="py method">
<dt class="sig sig-object py" id="public.contracts.FlowParser.get_input_field_elems">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_input_field_elems</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#public.contracts.FlowParser.get_input_field_elems" title="Link to this definition">¶</a></dt>
<dd><p>Named XML elements that are children of Screen Flow Input Text Elements
:rtype: <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">_Element</span></code>]]</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only returns variables from current flow</p>
</div>
<p>Returns: None if none present in flow</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set[ET._Element] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="public.contracts.FlowParser.get_input_variables">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_input_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.contracts.FlowParser.get_input_variables" title="Link to this definition">¶</a></dt>
<dd><p>Get Flow variables available for input</p>
<dl class="simple">
<dt>Returns: (filename, element_name) corresponding to all variables available for input</dt><dd><p>or None if none found.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>{(str, str)}</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.contracts.QueryProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.contracts.</span></span><span class="sig-name descname"><span class="pre">QueryProcessor</span></span><a class="headerlink" href="#public.contracts.QueryProcessor" title="Link to this definition">¶</a></dt>
<dd><p>Queries must implement this class.</p>
<ul class="simple">
<li><p>Queries are instantiated <em>once</em> per flow run,
and the same query instance is passed to all
subflows. Therefore, you can store internal state
in the query, for example querying for all sources
when given the process root command, and then using
those sources in subsequent invocations.</p></li>
<li><p>Queries are passed the full BranchState at every
invocation, but should never write to this state</p></li>
<li><p>Queries are passed a parser instance with a number
of higher level functions to search for flow inputs
and outputs, but access to making raw ET queries
is still possible. Never write to the parser
instance.</p></li>
<li><p>Examine the documentation for the parser instance.</p></li>
</ul>
<p><strong>CAUTION</strong> The parser and BranchState API is still
in development, so early queries may break on upgrade,
until a more formal release is made, at which point
older APIs will be maintained for backwards compatability.</p>
<p>Please stay in contact with the project developers if you are writing
custom queries or would prefer additional parser functionality.</p>
<ul class="simple">
<li><p>do not rely on _methods in the parser being stable
across even minor releases.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="public.contracts.QueryProcessor.__init__">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#public.contracts.QueryProcessor.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Constructor is passed only a FlowParser instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>first</strong> (<em>Parser that has parsed the</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="public.contracts.QueryProcessor.handle_crawl_element">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">handle_crawl_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.contracts.QueryProcessor.handle_crawl_element" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="#public.data_obj.QueryResult" title="public.data_obj.QueryResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryResult</span></code></a>]]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>state</strong> (<a class="reference internal" href="#public.contracts.State" title="public.contracts.State"><em>State</em></a>) – </p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="public.contracts.QueryProcessor.handle_final">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">handle_final</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_states</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.contracts.QueryProcessor.handle_final" title="Link to this definition">¶</a></dt>
<dd><p>Invoked when crawl is complete for the flow and all subflows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>all_states</strong> (<em>(</em><em>[</em><a class="reference internal" href="#public.contracts.State" title="public.contracts.State"><em>State</em></a><em>]</em><em>,</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[<a class="reference internal" href="#public.data_obj.QueryResult" title="public.data_obj.QueryResult">QueryResult</a>] | None</p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="public.contracts.QueryProcessor.handle_flow_enter">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">handle_flow_enter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.contracts.QueryProcessor.handle_flow_enter" title="Link to this definition">¶</a></dt>
<dd><p>Invoked when a flow or subflow is first entered.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="#public.data_obj.QueryResult" title="public.data_obj.QueryResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryResult</span></code></a>]]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>state</strong> (<a class="reference internal" href="#public.contracts.State" title="public.contracts.State"><em>State</em></a>) – </p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="public.contracts.QueryProcessor.set_preset_name">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_preset_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preset_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.contracts.QueryProcessor.set_preset_name" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#public.data_obj.Preset" title="public.data_obj.Preset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Preset</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>preset_name</strong> (<em>str</em><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Preset that will be used in subsequent processing</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.contracts.State">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.contracts.</span></span><span class="sig-name descname"><span class="pre">State</span></span><a class="headerlink" href="#public.contracts.State" title="Link to this definition">¶</a></dt>
<dd><p>Stores DataInfluencePaths in the current execution step</p>
</dd></dl>

<p id="module-public.data_obj">Definitions of data classes used for querying and reporting</p>
<dl class="py class">
<dt class="sig sig-object py" id="public.data_obj.BranchVisitor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.data_obj.</span></span><span class="sig-name descname"><span class="pre">BranchVisitor</span></span><a class="headerlink" href="#public.data_obj.BranchVisitor" title="Link to this definition">¶</a></dt>
<dd><p>BranchVisitor(current_label: ‘str’, previous_label: ‘str | None’, token: ‘str’ = None, history: ‘((str, str),)’ = &lt;factory&gt;)</p>
<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.BranchVisitor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.BranchVisitor.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.data_obj.CrawlStep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.data_obj.</span></span><span class="sig-name descname"><span class="pre">CrawlStep</span></span><a class="headerlink" href="#public.data_obj.CrawlStep" title="Link to this definition">¶</a></dt>
<dd><p>CrawlStep(step: ‘int’, visitor: ‘BranchVisitor’, element_name: ‘str’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.CrawlStep.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visitor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.CrawlStep.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<em>int</em>) – </p></li>
<li><p><strong>visitor</strong> (<a class="reference internal" href="#public.data_obj.BranchVisitor" title="public.data_obj.BranchVisitor"><em>BranchVisitor</em></a>) – </p></li>
<li><p><strong>element_name</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.data_obj.DataInfluencePath">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.data_obj.</span></span><span class="sig-name descname"><span class="pre">DataInfluencePath</span></span><a class="headerlink" href="#public.data_obj.DataInfluencePath" title="Link to this definition">¶</a></dt>
<dd><p>Represents a data influence between two <em>named</em> elements,
with a history of influence statements explaining the influence.</p>
<p>The chains of influence statements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">foo</span> <span class="o">-&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">bar</span> <span class="ow">in</span> <span class="n">element</span> <span class="n">foo</span>
<span class="n">B</span> <span class="o">-&gt;</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">element</span> <span class="n">bar</span>
</pre></div>
</div>
<p>are stored for reporting.</p>
<p>Data Influence Paths are immutable. When flow propagation occurs,
new paths are created and old paths kept until the variable is reassigned.</p>
<dl class="simple">
<dt>This is accomplished by maintaining an influence_map::</dt><dd><p>(flow_path, elem_name) -&gt; set(DataInfluencePaths)</p>
</dd>
</dl>
<p>that tracks all influencers. If a combination of values influences
a variable, we <em>copy</em> paths for these values, append them, and assign
them to the influencer. So the usual operations are copy flow + extend.
When assignment happens, we change which flows a given variable points
to, and let python garbage collection delete flows when no variable
points to them.</p>
<p>When symbolic execution exits a subflow,
all paths that do not influence a return value are
dropped.</p>
<p><strong>Caution</strong>: Only instantiate with provided class method
builders to ensure data consistency.
TODO: add support for labels.</p>
<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.DataInfluencePath.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influenced_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influenced_property</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influencer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influencer_property</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influenced_filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influencer_filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influenced_type_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.DataInfluencePath.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.DataInfluencePath.combine">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">combine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_flow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_flow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_flow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_override</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.DataInfluencePath.combine" title="Link to this definition">¶</a></dt>
<dd><p>Combine two paths</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataInfluencePath</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>start_flow</strong> (<a class="reference internal" href="#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><em>DataInfluencePath</em></a>) – the new path starts with this influencer</p></li>
<li><p><strong>end_flow</strong> (<a class="reference internal" href="#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><em>DataInfluencePath</em></a>) – the new path ends with this flow’s influenced</p></li>
<li><p><strong>cross_flow</strong> (<em>bool</em>) – whether the end dataflow is in a different flow</p></li>
<li><p><strong>type_override</strong> (<a class="reference internal" href="#public.data_obj.VariableType" title="public.data_obj.VariableType"><em>VariableType</em></a><em> | </em><em>None</em>) – specify type directly, otherwise we keep the
end_flow’s type unchanged</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A influences C if start_flow is A influences B, and end_flow is B
influences C</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError if the influencers don't match up and crossflow is False as cross-flow</strong> – </p></li>
<li><p><strong>dataflows will have different names and filenames.</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.DataInfluencePath.report_influence_tuples">
<span class="sig-name descname"><span class="pre">report_influence_tuples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.DataInfluencePath.report_influence_tuples" title="Link to this definition">¶</a></dt>
<dd><p>Returns simple chain of variables for high level analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of (flow_filename, influenced_var_name)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.DataInfluencePath.short_report">
<span class="sig-name descname"><span class="pre">short_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.DataInfluencePath.short_report" title="Link to this definition">¶</a></dt>
<dd><p>Prints a short report of influence chain</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>arrows</strong> (<em>bool</em>) – whether the report should use ‘-&gt;’ (True) or commas
(False) for statement separators</p></li>
<li><p><strong>filenames</strong> (<em>bool</em>) – whether the report should include filenames in the report</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>string containing summary report.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.data_obj.DataInfluenceStatement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.data_obj.</span></span><span class="sig-name descname"><span class="pre">DataInfluenceStatement</span></span><a class="headerlink" href="#public.data_obj.DataInfluenceStatement" title="Link to this definition">¶</a></dt>
<dd><p>Represents a statement in which one variable influences
another, usually as the result of an assignment,
formula or template field, or builtin function.
These statement are the basic building blocks of dataflows.</p>
<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.DataInfluenceStatement.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influenced_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influencer_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.DataInfluenceStatement.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>influenced_var</strong> (<em>str</em>) – </p></li>
<li><p><strong>influencer_var</strong> (<em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>element_name</strong> (<em>str</em>) – </p></li>
<li><p><strong>comment</strong> (<em>str</em>) – </p></li>
<li><p><strong>flow_path</strong> (<em>str</em>) – </p></li>
<li><p><strong>line_no</strong> (<em>int</em>) – </p></li>
<li><p><strong>source_text</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.data_obj.InfluenceStatementEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.data_obj.</span></span><span class="sig-name descname"><span class="pre">InfluenceStatementEncoder</span></span><a class="headerlink" href="#public.data_obj.InfluenceStatementEncoder" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.InfluenceStatementEncoder.default">
<span class="sig-name descname"><span class="pre">default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.InfluenceStatementEncoder.default" title="Link to this definition">¶</a></dt>
<dd><p>Implement this method in a subclass such that it returns
a serializable object for <code class="docutils literal notranslate"><span class="pre">o</span></code>, or calls the base implementation
(to raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p>
<p>For example, to support arbitrary iterators, you could
implement default like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="c1"># Let the base class default method raise the TypeError</span>
    <span class="k">return</span> <span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.data_obj.Preset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.data_obj.</span></span><span class="sig-name descname"><span class="pre">Preset</span></span><a class="headerlink" href="#public.data_obj.Preset" title="Link to this definition">¶</a></dt>
<dd><p>Preset(preset_name: ‘str’, preset_owner: ‘str | None’, queries: ‘{QueryDescription}’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.Preset.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preset_owner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queries</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.Preset.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.data_obj.QueryDescription">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.data_obj.</span></span><span class="sig-name descname"><span class="pre">QueryDescription</span></span><a class="headerlink" href="#public.data_obj.QueryDescription" title="Link to this definition">¶</a></dt>
<dd><p>QueryDescription(query_id: ‘str’, query_name: ‘str’, severity: ‘Severity’, query_description: ‘str’, help_url: ‘str | None’ = None, query_version: ‘str’ = ‘0’, is_security: ‘bool’ = True)</p>
<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.QueryDescription.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">severity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_security</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.QueryDescription.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_id</strong> (<em>str</em>) – </p></li>
<li><p><strong>query_name</strong> (<em>str</em>) – </p></li>
<li><p><strong>severity</strong> (<a class="reference internal" href="#public.enums.Severity" title="public.enums.Severity"><em>Severity</em></a>) – </p></li>
<li><p><strong>query_description</strong> (<em>str</em>) – </p></li>
<li><p><strong>help_url</strong> (<em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>query_version</strong> (<em>str</em>) – </p></li>
<li><p><strong>is_security</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.data_obj.QueryResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.data_obj.</span></span><span class="sig-name descname"><span class="pre">QueryResult</span></span><a class="headerlink" href="#public.data_obj.QueryResult" title="Link to this definition">¶</a></dt>
<dd><p>The QueryProcessor performs only local analysis, for example searching
for whether variables <em>within</em> a given Flow Element are assigned to a
dangerous sink – for example a filter used to determine which objects
should be deleted. Therefore, the execution of a query consists of
two steps:</p>
<blockquote>
<div><ul class="simple">
<li><p>Investigate the flow element to determine dangerous influence statements.</p></li>
<li><p>Decide whether the influencing variable is user controlled.</p></li>
</ul>
</div></blockquote>
<p>The second step is global analysis and is performed by querying BranchState,
with the variable name of interest. Branch state will return all
tainted dataflows to this variable.</p>
<p>The query module will then pass the influence statement together with
the returned dataflows to the result module. Therefore, the result
passed is a pair of objects: a data influence statement and a list of flows.</p>
<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.QueryResult.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influence_statement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.QueryResult.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_id</strong> (<em>str</em>) – </p></li>
<li><p><strong>influence_statement</strong> (<a class="reference internal" href="#public.data_obj.DataInfluenceStatement" title="public.data_obj.DataInfluenceStatement"><em>DataInfluenceStatement</em></a>) – </p></li>
<li><p><strong>paths</strong> (<em>frozenset</em><em>[</em><a class="reference internal" href="#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><em>DataInfluencePath</em></a><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.data_obj.VariableType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.data_obj.</span></span><span class="sig-name descname"><span class="pre">VariableType</span></span><a class="headerlink" href="#public.data_obj.VariableType" title="Link to this definition">¶</a></dt>
<dd><p>This class contains type information for a variable</p>
<dl class="py method">
<dt class="sig sig-object py" id="public.data_obj.VariableType.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_collection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_optional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.data_obj.VariableType.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tag</strong> (<em>str</em>) – </p></li>
<li><p><strong>datatype</strong> (<a class="reference internal" href="#public.enums.DataType" title="public.enums.DataType"><em>DataType</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>reference</strong> (<a class="reference internal" href="#public.enums.ReferenceType" title="public.enums.ReferenceType"><em>ReferenceType</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>is_collection</strong> (<em>bool</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>is_optional</strong> (<em>bool</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>object_type</strong> (<em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>properties</strong> (<em>set</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>is_input</strong> (<em>bool</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>is_output</strong> (<em>bool</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-public.enums">Public Enum types</p>
<dl class="py class">
<dt class="sig sig-object py" id="public.enums.ConnType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.enums.</span></span><span class="sig-name descname"><span class="pre">ConnType</span></span><a class="headerlink" href="#public.enums.ConnType" title="Link to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.enums.DataType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.enums.</span></span><span class="sig-name descname"><span class="pre">DataType</span></span><a class="headerlink" href="#public.enums.DataType" title="Link to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.enums.FlowType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.enums.</span></span><span class="sig-name descname"><span class="pre">FlowType</span></span><a class="headerlink" href="#public.enums.FlowType" title="Link to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.enums.ReferenceType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.enums.</span></span><span class="sig-name descname"><span class="pre">ReferenceType</span></span><a class="headerlink" href="#public.enums.ReferenceType" title="Link to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.enums.RunMode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.enums.</span></span><span class="sig-name descname"><span class="pre">RunMode</span></span><a class="headerlink" href="#public.enums.RunMode" title="Link to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="public.enums.Severity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">public.enums.</span></span><span class="sig-name descname"><span class="pre">Severity</span></span><a class="headerlink" href="#public.enums.Severity" title="Link to this definition">¶</a></dt>
<dd><p>All queries must be labelled with a severity field. In the report, they will
be sorted by severity and the severity will be displayed. The severity is per
Query, not per result, so if your code contains branching logic in which one
result is considered more severe, consider defining multiple queries and explaining
the reason for the difference in severity. An example of explaining
the reason for severity can be found in the class definition below:</p>
</dd></dl>

<p id="module-public.parse_utils">Public Utility module for xml queries on flows.</p>
<p>The distinction between what goes in here and
what goes in flow_parser.parser is that the parser
has access to the flow root and does global analysis on flows,
whereas the utility functions here are stateless and
require an xml element be provided. They cannot do name lookups
or return global flow data (e.g. all input variables in the flow).</p>
<p>Rather, the parser imports parse utils and uses them for low-level
xml queries.</p>
<dl class="py function">
<dt class="sig sig-object py" id="public.parse_utils.get_assignment_statement_dicts">
<span class="sig-prename descclassname"><span class="pre">public.parse_utils.</span></span><span class="sig-name descname"><span class="pre">get_assignment_statement_dicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.parse_utils.get_assignment_statement_dicts" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, {&lt;class ‘str’&gt;: &lt;class ‘str’&gt;}]]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>elem</strong> (<em>_Element</em>) – </p>
</dd>
</dl>
<p>Returns assignment statement keywords
:param elem: elem to parse, should have a tag of “assignments”</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict suitable for constructing DataInfluenceStatements via
**args unpack passed to the constructor.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>elem</strong> (<em>_Element</em>) – </p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str, {&lt;class ‘str’&gt;: &lt;class ‘str’&gt;}] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="public.parse_utils.get_by_tag">
<span class="sig-prename descclassname"><span class="pre">public.parse_utils.</span></span><span class="sig-name descname"><span class="pre">get_by_tag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tagname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.parse_utils.get_by_tag" title="Link to this definition">¶</a></dt>
<dd><p>Get list of all elem with the tag (ignoring ns).</p>
<p>Convenience method as manually dealing with namespaces is clumsy.</p>
<p class="rubric">Notes</p>
<p>WARNING: does not recurse. Use this for top level flow
elements – e.g. screens, variables</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>XML Elements else [] if no matches</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>elem</strong> (<em>ET._Element</em>) – </p></li>
<li><p><strong>tagname</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[ET.etree._Element]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="public.parse_utils.get_conn_target_map">
<span class="sig-prename descclassname"><span class="pre">public.parse_utils.</span></span><span class="sig-name descname"><span class="pre">get_conn_target_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.parse_utils.get_conn_target_map" title="Link to this definition">¶</a></dt>
<dd><p>returns map from connectors at elem to where they point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elem</strong> (<em>ET._Element</em>) – base element containing connectors (Flow Element)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>connector element -&gt; target reference (string), connector type, is_optional (True if connector is optional)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{ET._Element: (str, <a class="reference internal" href="#public.enums.ConnType" title="public.enums.ConnType">ConnType</a>, bool)}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="public.parse_utils.get_name">
<span class="sig-prename descclassname"><span class="pre">public.parse_utils.</span></span><span class="sig-name descname"><span class="pre">get_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.parse_utils.get_name" title="Link to this definition">¶</a></dt>
<dd><p>returns the string name of elem or None if no name or ‘*’</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>elem</strong> (<em>_Element</em><em> | </em><em>None</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="public.parse_utils.get_named_elems">
<span class="sig-prename descclassname"><span class="pre">public.parse_utils.</span></span><span class="sig-name descname"><span class="pre">get_named_elems</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.parse_utils.get_named_elems" title="Link to this definition">¶</a></dt>
<dd><p>Get all descendents (recursive) of elem that have a <code class="docutils literal notranslate"><span class="pre">name</span></code> tag</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">_Element</span></code>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>elem</strong> (<em>_Element</em>) – base element whose children to search</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>[elem] or [] if None found</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="public.parse_utils.is_decision">
<span class="sig-prename descclassname"><span class="pre">public.parse_utils.</span></span><span class="sig-name descname"><span class="pre">is_decision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.parse_utils.is_decision" title="Link to this definition">¶</a></dt>
<dd><p>True if this is a decision Flow Element</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>elem</strong> (<em>_Element</em>) – Flow Element</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if decision</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="public.parse_utils.is_goto_connector">
<span class="sig-prename descclassname"><span class="pre">public.parse_utils.</span></span><span class="sig-name descname"><span class="pre">is_goto_connector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.parse_utils.is_goto_connector" title="Link to this definition">¶</a></dt>
<dd><p>Is this element a goto?</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>elem</strong> (<em>_Element</em>) – connector element</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>whether this is a goto element</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="public.parse_utils.is_loop">
<span class="sig-prename descclassname"><span class="pre">public.parse_utils.</span></span><span class="sig-name descname"><span class="pre">is_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.parse_utils.is_loop" title="Link to this definition">¶</a></dt>
<dd><p>Is this a Loop Flow Element?</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>elem</strong> (<em>_Element</em>) – xml element</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if this is a loop element</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="public.parse_utils.parse_expression">
<span class="sig-prename descclassname"><span class="pre">public.parse_utils.</span></span><span class="sig-name descname"><span class="pre">parse_expression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">txt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.parse_utils.parse_expression" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>txt</strong> (<em>str</em>) – expression or template definition string in which merge-fields are present</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of elementRef names (empty list if no matches)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="public.parse_utils.process_assignment_item">
<span class="sig-prename descclassname"><span class="pre">public.parse_utils.</span></span><span class="sig-name descname"><span class="pre">process_assignment_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#public.parse_utils.process_assignment_item" title="Link to this definition">¶</a></dt>
<dd><p>Returns assignment item dict from assignment element</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elem</strong> (<em>ET._Element</em>) – (not a top Flow element) but an assignmentItem elem</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>var_name, ‘influencer_var’: var_name or
STRING_LITERAL_TOKEN, ‘line_no’: int, ‘source_text’: str
assignmentItem code , ‘comment’: “Variable Assignment”,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>::{ ‘influenced_var’</p>
</dd>
</dl>
<p>}
which is all keywords needed to construct DataInfluenceStatement
except for ‘element_name’</p>
</dd></dl>

<p id="module-queries.default_query">Default Queries to be run for Security Review of Flows</p>
<p>BETA - Don’t use in production</p>
<dl class="py class">
<dt class="sig sig-object py" id="queries.default_query.DefaultQueryProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">queries.default_query.</span></span><span class="sig-name descname"><span class="pre">DefaultQueryProcessor</span></span><a class="headerlink" href="#queries.default_query.DefaultQueryProcessor" title="Link to this definition">¶</a></dt>
<dd><p>Demonstration class for using custom queries</p>
<dl class="py method">
<dt class="sig sig-object py" id="queries.default_query.DefaultQueryProcessor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#queries.default_query.DefaultQueryProcessor.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Constructor is passed only a FlowParser instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>first</strong> (<em>Parser that has parsed the</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="queries.default_query.DefaultQueryProcessor.handle_crawl_element">
<span class="sig-name descname"><span class="pre">handle_crawl_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#queries.default_query.DefaultQueryProcessor.handle_crawl_element" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="#public.data_obj.QueryResult" title="public.data_obj.QueryResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryResult</span></code></a>]]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>state</strong> (<a class="reference internal" href="#public.contracts.State" title="public.contracts.State"><em>State</em></a>) – </p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="queries.default_query.DefaultQueryProcessor.handle_final">
<span class="sig-name descname"><span class="pre">handle_final</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_states</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#queries.default_query.DefaultQueryProcessor.handle_final" title="Link to this definition">¶</a></dt>
<dd><p>Invoked when crawl is complete for the flow and all subflows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>all_states</strong> (<em>(</em><em>[</em><a class="reference internal" href="#public.contracts.State" title="public.contracts.State"><em>State</em></a><em>]</em><em>,</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[<a class="reference internal" href="#public.data_obj.QueryResult" title="public.data_obj.QueryResult">QueryResult</a>] | None</p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="queries.default_query.DefaultQueryProcessor.handle_flow_enter">
<span class="sig-name descname"><span class="pre">handle_flow_enter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#queries.default_query.DefaultQueryProcessor.handle_flow_enter" title="Link to this definition">¶</a></dt>
<dd><p>Invoked when a flow or subflow is first entered.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="#public.data_obj.QueryResult" title="public.data_obj.QueryResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryResult</span></code></a>]]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>state</strong> (<a class="reference internal" href="#public.contracts.State" title="public.contracts.State"><em>State</em></a>) – </p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="queries.default_query.DefaultQueryProcessor.process_element">
<span class="sig-name descname"><span class="pre">process_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#queries.default_query.DefaultQueryProcessor.process_element" title="Link to this definition">¶</a></dt>
<dd><p>Looks for CRUD influencers from sources (input fields or input variables)</p>
<p>Searches the xml element looking for tainted variables that are selector or data influencers.</p>
<p>If sources of taint are found, calls
the <cite>process_influencers</cite> method that queries the state for vulnerable flows and generates reports.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="#public.data_obj.QueryResult" title="public.data_obj.QueryResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryResult</span></code></a>]]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#public.contracts.State" title="public.contracts.State"><em>State</em></a>) – BranchState</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – element being searched</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="queries.default_query.DefaultQueryProcessor.process_influencers">
<span class="sig-name descname"><span class="pre">process_influencers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_influencers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_influencers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#queries.default_query.DefaultQueryProcessor.process_influencers" title="Link to this definition">¶</a></dt>
<dd><p>Given a list of variables that flow into sinks, search if these are tainted,
and if so, add the tainted flow to the result object.</p>
<p>Before adding the tainted
flow, an additional statement is appended for readability, show how the tainted
value affects the specific Flow element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#public.contracts.State" title="public.contracts.State"><em>State</em></a>) – current state field</p></li>
<li><p><strong>current_elem</strong> (<em>ET._Element</em>) – xml element being processed</p></li>
<li><p><strong>filter_influencers</strong> (<em>[</em><em>str</em><em>]</em>) – influencers for record selection/filter</p></li>
<li><p><strong>input_influencers</strong> (<em>[</em><em>str</em><em>]</em>) – influencers that modify record data</p></li>
<li><p><strong>elem_type</strong> (<em>str</em>) – Whether this is an update/delete/create/lookup</p></li>
<li><p><strong>parser</strong> (<a class="reference internal" href="#public.contracts.FlowParser" title="public.contracts.FlowParser"><em>FlowParser</em></a>) – Parser instance provided by runtime</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[<a class="reference internal" href="#public.data_obj.QueryResult" title="public.data_obj.QueryResult">QueryResult</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="queries.default_query.DefaultQueryProcessor.set_preset_name">
<span class="sig-name descname"><span class="pre">set_preset_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preset_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#queries.default_query.DefaultQueryProcessor.set_preset_name" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#public.data_obj.Preset" title="public.data_obj.Preset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Preset</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>preset_name</strong> (<em>str</em><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Preset that will be used in subsequent processing</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="queries.default_query.get_sink_influencers">
<span class="sig-prename descclassname"><span class="pre">queries.default_query.</span></span><span class="sig-name descname"><span class="pre">get_sink_influencers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elems</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#queries.default_query.get_sink_influencers" title="Link to this definition">¶</a></dt>
<dd><p>Find variables that flow into sinks</p>
<p>Searches through inputAssignment of filter elements and returns a list of tuples [(string, string)]
consisting of the name of the influenced field and its influencer (which may be a formula field)</p>
<p>E.g.if a recordLookup field has a filter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">filters</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">field</span><span class="o">&gt;</span><span class="n">Name</span><span class="o">&lt;/</span><span class="n">field</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">operator</span><span class="o">&gt;</span><span class="n">Contains</span><span class="o">&lt;/</span><span class="n">operator</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">elementReference</span><span class="o">&gt;</span><span class="n">var3</span><span class="o">&lt;/</span><span class="n">elementReference</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">filters</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>then this would return [(‘Name’, ‘var3’)]</p>
<p>But as there may be many filters and in some cases inputAssignments, the list may be long.
No resolution of formulas is performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>elems</strong> (<em>_Element</em>) – </p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>TODO: we are cheating a bit by not checking for op code in the case of filters.
This should be added later.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elems</strong> (<em>_Element</em>) – inputAssignment or field selection criteria xml elements.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">list[(field_name,</span> <span class="pre">influencer_name)]</span></code>  (an empty list if no sinks are found)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str, str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="queries.default_query.get_sources">
<span class="sig-prename descclassname"><span class="pre">queries.default_query.</span></span><span class="sig-name descname"><span class="pre">get_sources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#queries.default_query.get_sources" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parser</strong> (<a class="reference internal" href="#public.contracts.FlowParser" title="public.contracts.FlowParser"><em>FlowParser</em></a>) – parser instance for flow</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(inputs, outputs) where inputs are screen input field elements
and input variables while outputs are output variables.
returns empty set if None found</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>({(str, str)}, {(str, str)})</p>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents<span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:<span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#">Reference Index</a><ul>
<li><a class="reference internal" href="#flow_parser.parse.NS_LEN"><code class="docutils literal notranslate"><span class="pre">NS_LEN</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser"><code class="docutils literal notranslate"><span class="pre">Parser</span></code></a><ul>
<li><a class="reference internal" href="#flow_parser.parse.Parser.__init__"><code class="docutils literal notranslate"><span class="pre">Parser.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.all_named_elems"><code class="docutils literal notranslate"><span class="pre">Parser.all_named_elems</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.declared_run_mode"><code class="docutils literal notranslate"><span class="pre">Parser.declared_run_mode</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.effective_run_mode"><code class="docutils literal notranslate"><span class="pre">Parser.effective_run_mode</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.flow_path"><code class="docutils literal notranslate"><span class="pre">Parser.flow_path</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.flow_type"><code class="docutils literal notranslate"><span class="pre">Parser.flow_type</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_all_indirect_tuples"><code class="docutils literal notranslate"><span class="pre">Parser.get_all_indirect_tuples()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_all_traversable_flow_elements"><code class="docutils literal notranslate"><span class="pre">Parser.get_all_traversable_flow_elements()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_by_name"><code class="docutils literal notranslate"><span class="pre">Parser.get_by_name()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_flow_name"><code class="docutils literal notranslate"><span class="pre">Parser.get_flow_name()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_flow_type"><code class="docutils literal notranslate"><span class="pre">Parser.get_flow_type()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_formulas"><code class="docutils literal notranslate"><span class="pre">Parser.get_formulas()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_input_field_elems"><code class="docutils literal notranslate"><span class="pre">Parser.get_input_field_elems()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_input_output_elems"><code class="docutils literal notranslate"><span class="pre">Parser.get_input_output_elems()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_input_variables"><code class="docutils literal notranslate"><span class="pre">Parser.get_input_variables()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_target_reference_elem"><code class="docutils literal notranslate"><span class="pre">Parser.get_target_reference_elem()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.get_templates"><code class="docutils literal notranslate"><span class="pre">Parser.get_templates()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.input_variables"><code class="docutils literal notranslate"><span class="pre">Parser.input_variables</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.literal_var"><code class="docutils literal notranslate"><span class="pre">Parser.literal_var</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.output_variables"><code class="docutils literal notranslate"><span class="pre">Parser.output_variables</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.resolve_by_name"><code class="docutils literal notranslate"><span class="pre">Parser.resolve_by_name()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.root"><code class="docutils literal notranslate"><span class="pre">Parser.root</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.Parser.update"><code class="docutils literal notranslate"><span class="pre">Parser.update()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flow_parser.parse.build_vartype_from_elem"><code class="docutils literal notranslate"><span class="pre">build_vartype_from_elem()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.get_root"><code class="docutils literal notranslate"><span class="pre">get_root()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.get_subflow_input_map"><code class="docutils literal notranslate"><span class="pre">get_subflow_input_map()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.get_subflow_output_map"><code class="docutils literal notranslate"><span class="pre">get_subflow_output_map()</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.logger"><code class="docutils literal notranslate"><span class="pre">logger</span></code></a></li>
<li><a class="reference internal" href="#flow_parser.parse.ns"><code class="docutils literal notranslate"><span class="pre">ns</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.check_dir_exists"><code class="docutils literal notranslate"><span class="pre">check_dir_exists()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.check_file_exists"><code class="docutils literal notranslate"><span class="pre">check_file_exists()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.check_not_exist"><code class="docutils literal notranslate"><span class="pre">check_not_exist()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.get_flow_paths"><code class="docutils literal notranslate"><span class="pre">get_flow_paths()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.parse_args"><code class="docutils literal notranslate"><span class="pre">parse_args()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.setup_logger"><code class="docutils literal notranslate"><span class="pre">setup_logger()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState"><code class="docutils literal notranslate"><span class="pre">BranchState</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.__init__"><code class="docutils literal notranslate"><span class="pre">BranchState.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.add_vectors_from_other_flow"><code class="docutils literal notranslate"><span class="pre">BranchState.add_vectors_from_other_flow()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.filter_maps"><code class="docutils literal notranslate"><span class="pre">BranchState.filter_maps()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.get_all_output_vectors"><code class="docutils literal notranslate"><span class="pre">BranchState.get_all_output_vectors()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.get_flows_from_sources"><code class="docutils literal notranslate"><span class="pre">BranchState.get_flows_from_sources()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.get_or_make_vector"><code class="docutils literal notranslate"><span class="pre">BranchState.get_or_make_vector()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.is_in_map"><code class="docutils literal notranslate"><span class="pre">BranchState.is_in_map()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.load_crawl_step"><code class="docutils literal notranslate"><span class="pre">BranchState.load_crawl_step()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.propagate_flows"><code class="docutils literal notranslate"><span class="pre">BranchState.propagate_flows()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.branch_state.filter_vectors"><code class="docutils literal notranslate"><span class="pre">filter_vectors()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.ControlFlowGraph"><code class="docutils literal notranslate"><span class="pre">ControlFlowGraph</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.ControlFlowGraph.__init__"><code class="docutils literal notranslate"><span class="pre">ControlFlowGraph.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.CrawlEncoder"><code class="docutils literal notranslate"><span class="pre">CrawlEncoder</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.CrawlEncoder.default"><code class="docutils literal notranslate"><span class="pre">CrawlEncoder.default()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.CrawlSchedule"><code class="docutils literal notranslate"><span class="pre">CrawlSchedule</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.CrawlSchedule.__init__"><code class="docutils literal notranslate"><span class="pre">CrawlSchedule.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler"><code class="docutils literal notranslate"><span class="pre">Crawler</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.__init__"><code class="docutils literal notranslate"><span class="pre">Crawler.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.crawl_schedule"><code class="docutils literal notranslate"><span class="pre">Crawler.crawl_schedule</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.current_step"><code class="docutils literal notranslate"><span class="pre">Crawler.current_step</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.from_parser"><code class="docutils literal notranslate"><span class="pre">Crawler.from_parser()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.get_crawl_step"><code class="docutils literal notranslate"><span class="pre">Crawler.get_crawl_step()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.get_last_ancestor"><code class="docutils literal notranslate"><span class="pre">Crawler.get_last_ancestor()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.history_maps"><code class="docutils literal notranslate"><span class="pre">Crawler.history_maps</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.terminal_steps"><code class="docutils literal notranslate"><span class="pre">Crawler.terminal_steps</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.total_steps"><code class="docutils literal notranslate"><span class="pre">Crawler.total_steps</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.Jump"><code class="docutils literal notranslate"><span class="pre">Jump</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.Jump.__init__"><code class="docutils literal notranslate"><span class="pre">Jump.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.Segment"><code class="docutils literal notranslate"><span class="pre">Segment</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.Segment.__init__"><code class="docutils literal notranslate"><span class="pre">Segment.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Segment.accept"><code class="docutils literal notranslate"><span class="pre">Segment.accept()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.crawl_iter"><code class="docutils literal notranslate"><span class="pre">crawl_iter()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.get_crawl_schedule"><code class="docutils literal notranslate"><span class="pre">get_crawl_schedule()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.ESAPI.html_encode"><code class="docutils literal notranslate"><span class="pre">html_encode()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.ESAPI.legal_sql_escape"><code class="docutils literal notranslate"><span class="pre">legal_sql_escape()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.ESAPI.sql_enc_html_dec"><code class="docutils literal notranslate"><span class="pre">sql_enc_html_dec()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.ESAPI.sql_escape"><code class="docutils literal notranslate"><span class="pre">sql_escape()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.FOLLOW_SUBFLOWS"><code class="docutils literal notranslate"><span class="pre">FOLLOW_SUBFLOWS</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame"><code class="docutils literal notranslate"><span class="pre">Frame</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.executor.Frame.__init__"><code class="docutils literal notranslate"><span class="pre">Frame.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.all_flow_paths"><code class="docutils literal notranslate"><span class="pre">Frame.all_flow_paths</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.build"><code class="docutils literal notranslate"><span class="pre">Frame.build()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.child_spawned"><code class="docutils literal notranslate"><span class="pre">Frame.child_spawned</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.crawler"><code class="docutils literal notranslate"><span class="pre">Frame.crawler</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.execute"><code class="docutils literal notranslate"><span class="pre">Frame.execute()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.flow_name"><code class="docutils literal notranslate"><span class="pre">Frame.flow_name</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.flow_path"><code class="docutils literal notranslate"><span class="pre">Frame.flow_path</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.get_consolidated_output_vars"><code class="docutils literal notranslate"><span class="pre">Frame.get_consolidated_output_vars()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.handle_subflows"><code class="docutils literal notranslate"><span class="pre">Frame.handle_subflows()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.parent_subflow"><code class="docutils literal notranslate"><span class="pre">Frame.parent_subflow</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.parser"><code class="docutils literal notranslate"><span class="pre">Frame.parser</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.query_manager"><code class="docutils literal notranslate"><span class="pre">Frame.query_manager</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.resolved_subflows"><code class="docutils literal notranslate"><span class="pre">Frame.resolved_subflows</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.spawn_child_frame"><code class="docutils literal notranslate"><span class="pre">Frame.spawn_child_frame()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.state"><code class="docutils literal notranslate"><span class="pre">Frame.state</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.update_parent_frame"><code class="docutils literal notranslate"><span class="pre">Frame.update_parent_frame()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.executor.Stack"><code class="docutils literal notranslate"><span class="pre">Stack</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.executor.Stack.__init__"><code class="docutils literal notranslate"><span class="pre">Stack.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.all_flow_paths"><code class="docutils literal notranslate"><span class="pre">Stack.all_flow_paths</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.current_frame"><code class="docutils literal notranslate"><span class="pre">Stack.current_frame</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.pop"><code class="docutils literal notranslate"><span class="pre">Stack.pop()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.push"><code class="docutils literal notranslate"><span class="pre">Stack.push()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.query_manager"><code class="docutils literal notranslate"><span class="pre">Stack.query_manager</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.resolved_subflows"><code class="docutils literal notranslate"><span class="pre">Stack.resolved_subflows</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.run"><code class="docutils literal notranslate"><span class="pre">Stack.run()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.executor.logger"><code class="docutils literal notranslate"><span class="pre">logger</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.parse_flow"><code class="docutils literal notranslate"><span class="pre">parse_flow()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.add_to_query_config"><code class="docutils literal notranslate"><span class="pre">add_to_query_config()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.count_issues"><code class="docutils literal notranslate"><span class="pre">count_issues()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.get_issues_for_org"><code class="docutils literal notranslate"><span class="pre">get_issues_for_org()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.get_software_presets"><code class="docutils literal notranslate"><span class="pre">get_software_presets()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.parse_results"><code class="docutils literal notranslate"><span class="pre">parse_results()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.reverse_map"><code class="docutils literal notranslate"><span class="pre">reverse_map()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.serialize"><code class="docutils literal notranslate"><span class="pre">serialize()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.__init__"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.add_results"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.add_results()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.dump_json"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.dump_json()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.gen_result_dict"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.gen_result_dict()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.get_cx_xml_str"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.get_cx_xml_str()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.get_json_str"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.get_json_str()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.write_html"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.write_html()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector"><code class="docutils literal notranslate"><span class="pre">FlowVector</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.__init__"><code class="docutils literal notranslate"><span class="pre">FlowVector.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.add_vector"><code class="docutils literal notranslate"><span class="pre">FlowVector.add_vector()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.from_flows"><code class="docutils literal notranslate"><span class="pre">FlowVector.from_flows()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.get_flows_by_prop"><code class="docutils literal notranslate"><span class="pre">FlowVector.get_flows_by_prop()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.push_via_flow"><code class="docutils literal notranslate"><span class="pre">FlowVector.push_via_flow()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.report_dict"><code class="docutils literal notranslate"><span class="pre">FlowVector.report_dict()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.short_report"><code class="docutils literal notranslate"><span class="pre">FlowVector.short_report()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.query_manager.QueryAction"><code class="docutils literal notranslate"><span class="pre">QueryAction</span></code></a></li>
<li><a class="reference internal" href="#flowtest.query_manager.create_module"><code class="docutils literal notranslate"><span class="pre">create_module()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.CURR_DIR"><code class="docutils literal notranslate"><span class="pre">CURR_DIR</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.Worklist"><code class="docutils literal notranslate"><span class="pre">Worklist</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.util.Worklist.__init__"><code class="docutils literal notranslate"><span class="pre">Worklist.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.Worklist.add_to_queue"><code class="docutils literal notranslate"><span class="pre">Worklist.add_to_queue()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.Worklist.contents"><code class="docutils literal notranslate"><span class="pre">Worklist.contents()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.Worklist.get_size"><code class="docutils literal notranslate"><span class="pre">Worklist.get_size()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.Worklist.is_empty"><code class="docutils literal notranslate"><span class="pre">Worklist.is_empty()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.Worklist.pop"><code class="docutils literal notranslate"><span class="pre">Worklist.pop()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.util.get_flows_in_dir"><code class="docutils literal notranslate"><span class="pre">get_flows_in_dir()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.make_id"><code class="docutils literal notranslate"><span class="pre">make_id()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.propagate"><code class="docutils literal notranslate"><span class="pre">propagate()</span></code></a></li>
<li><a class="reference internal" href="#wiring-policy">Wiring Policy</a></li>
<li><a class="reference internal" href="#flowtest.wire.wire"><code class="docutils literal notranslate"><span class="pre">wire()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.wire.wire_assignment"><code class="docutils literal notranslate"><span class="pre">wire_assignment()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.wire.wire_collection_processor"><code class="docutils literal notranslate"><span class="pre">wire_collection_processor()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.wire.wire_loop"><code class="docutils literal notranslate"><span class="pre">wire_loop()</span></code></a></li>
<li><a class="reference internal" href="#public.contracts.FlowParser"><code class="docutils literal notranslate"><span class="pre">FlowParser</span></code></a><ul>
<li><a class="reference internal" href="#public.contracts.FlowParser.get_input_field_elems"><code class="docutils literal notranslate"><span class="pre">FlowParser.get_input_field_elems()</span></code></a></li>
<li><a class="reference internal" href="#public.contracts.FlowParser.get_input_variables"><code class="docutils literal notranslate"><span class="pre">FlowParser.get_input_variables()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.contracts.QueryProcessor"><code class="docutils literal notranslate"><span class="pre">QueryProcessor</span></code></a><ul>
<li><a class="reference internal" href="#public.contracts.QueryProcessor.__init__"><code class="docutils literal notranslate"><span class="pre">QueryProcessor.__init__()</span></code></a></li>
<li><a class="reference internal" href="#public.contracts.QueryProcessor.handle_crawl_element"><code class="docutils literal notranslate"><span class="pre">QueryProcessor.handle_crawl_element()</span></code></a></li>
<li><a class="reference internal" href="#public.contracts.QueryProcessor.handle_final"><code class="docutils literal notranslate"><span class="pre">QueryProcessor.handle_final()</span></code></a></li>
<li><a class="reference internal" href="#public.contracts.QueryProcessor.handle_flow_enter"><code class="docutils literal notranslate"><span class="pre">QueryProcessor.handle_flow_enter()</span></code></a></li>
<li><a class="reference internal" href="#public.contracts.QueryProcessor.set_preset_name"><code class="docutils literal notranslate"><span class="pre">QueryProcessor.set_preset_name()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.contracts.State"><code class="docutils literal notranslate"><span class="pre">State</span></code></a></li>
<li><a class="reference internal" href="#public.data_obj.BranchVisitor"><code class="docutils literal notranslate"><span class="pre">BranchVisitor</span></code></a><ul>
<li><a class="reference internal" href="#public.data_obj.BranchVisitor.__init__"><code class="docutils literal notranslate"><span class="pre">BranchVisitor.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.data_obj.CrawlStep"><code class="docutils literal notranslate"><span class="pre">CrawlStep</span></code></a><ul>
<li><a class="reference internal" href="#public.data_obj.CrawlStep.__init__"><code class="docutils literal notranslate"><span class="pre">CrawlStep.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.data_obj.DataInfluencePath"><code class="docutils literal notranslate"><span class="pre">DataInfluencePath</span></code></a><ul>
<li><a class="reference internal" href="#public.data_obj.DataInfluencePath.__init__"><code class="docutils literal notranslate"><span class="pre">DataInfluencePath.__init__()</span></code></a></li>
<li><a class="reference internal" href="#public.data_obj.DataInfluencePath.combine"><code class="docutils literal notranslate"><span class="pre">DataInfluencePath.combine()</span></code></a></li>
<li><a class="reference internal" href="#public.data_obj.DataInfluencePath.report_influence_tuples"><code class="docutils literal notranslate"><span class="pre">DataInfluencePath.report_influence_tuples()</span></code></a></li>
<li><a class="reference internal" href="#public.data_obj.DataInfluencePath.short_report"><code class="docutils literal notranslate"><span class="pre">DataInfluencePath.short_report()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.data_obj.DataInfluenceStatement"><code class="docutils literal notranslate"><span class="pre">DataInfluenceStatement</span></code></a><ul>
<li><a class="reference internal" href="#public.data_obj.DataInfluenceStatement.__init__"><code class="docutils literal notranslate"><span class="pre">DataInfluenceStatement.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.data_obj.InfluenceStatementEncoder"><code class="docutils literal notranslate"><span class="pre">InfluenceStatementEncoder</span></code></a><ul>
<li><a class="reference internal" href="#public.data_obj.InfluenceStatementEncoder.default"><code class="docutils literal notranslate"><span class="pre">InfluenceStatementEncoder.default()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.data_obj.Preset"><code class="docutils literal notranslate"><span class="pre">Preset</span></code></a><ul>
<li><a class="reference internal" href="#public.data_obj.Preset.__init__"><code class="docutils literal notranslate"><span class="pre">Preset.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.data_obj.QueryDescription"><code class="docutils literal notranslate"><span class="pre">QueryDescription</span></code></a><ul>
<li><a class="reference internal" href="#public.data_obj.QueryDescription.__init__"><code class="docutils literal notranslate"><span class="pre">QueryDescription.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.data_obj.QueryResult"><code class="docutils literal notranslate"><span class="pre">QueryResult</span></code></a><ul>
<li><a class="reference internal" href="#public.data_obj.QueryResult.__init__"><code class="docutils literal notranslate"><span class="pre">QueryResult.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.data_obj.VariableType"><code class="docutils literal notranslate"><span class="pre">VariableType</span></code></a><ul>
<li><a class="reference internal" href="#public.data_obj.VariableType.__init__"><code class="docutils literal notranslate"><span class="pre">VariableType.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public.enums.ConnType"><code class="docutils literal notranslate"><span class="pre">ConnType</span></code></a></li>
<li><a class="reference internal" href="#public.enums.DataType"><code class="docutils literal notranslate"><span class="pre">DataType</span></code></a></li>
<li><a class="reference internal" href="#public.enums.FlowType"><code class="docutils literal notranslate"><span class="pre">FlowType</span></code></a></li>
<li><a class="reference internal" href="#public.enums.ReferenceType"><code class="docutils literal notranslate"><span class="pre">ReferenceType</span></code></a></li>
<li><a class="reference internal" href="#public.enums.RunMode"><code class="docutils literal notranslate"><span class="pre">RunMode</span></code></a></li>
<li><a class="reference internal" href="#public.enums.Severity"><code class="docutils literal notranslate"><span class="pre">Severity</span></code></a></li>
<li><a class="reference internal" href="#public.parse_utils.get_assignment_statement_dicts"><code class="docutils literal notranslate"><span class="pre">get_assignment_statement_dicts()</span></code></a></li>
<li><a class="reference internal" href="#public.parse_utils.get_by_tag"><code class="docutils literal notranslate"><span class="pre">get_by_tag()</span></code></a></li>
<li><a class="reference internal" href="#public.parse_utils.get_conn_target_map"><code class="docutils literal notranslate"><span class="pre">get_conn_target_map()</span></code></a></li>
<li><a class="reference internal" href="#public.parse_utils.get_name"><code class="docutils literal notranslate"><span class="pre">get_name()</span></code></a></li>
<li><a class="reference internal" href="#public.parse_utils.get_named_elems"><code class="docutils literal notranslate"><span class="pre">get_named_elems()</span></code></a></li>
<li><a class="reference internal" href="#public.parse_utils.is_decision"><code class="docutils literal notranslate"><span class="pre">is_decision()</span></code></a></li>
<li><a class="reference internal" href="#public.parse_utils.is_goto_connector"><code class="docutils literal notranslate"><span class="pre">is_goto_connector()</span></code></a></li>
<li><a class="reference internal" href="#public.parse_utils.is_loop"><code class="docutils literal notranslate"><span class="pre">is_loop()</span></code></a></li>
<li><a class="reference internal" href="#public.parse_utils.parse_expression"><code class="docutils literal notranslate"><span class="pre">parse_expression()</span></code></a></li>
<li><a class="reference internal" href="#public.parse_utils.process_assignment_item"><code class="docutils literal notranslate"><span class="pre">process_assignment_item()</span></code></a></li>
<li><a class="reference internal" href="#queries.default_query.DefaultQueryProcessor"><code class="docutils literal notranslate"><span class="pre">DefaultQueryProcessor</span></code></a><ul>
<li><a class="reference internal" href="#queries.default_query.DefaultQueryProcessor.__init__"><code class="docutils literal notranslate"><span class="pre">DefaultQueryProcessor.__init__()</span></code></a></li>
<li><a class="reference internal" href="#queries.default_query.DefaultQueryProcessor.handle_crawl_element"><code class="docutils literal notranslate"><span class="pre">DefaultQueryProcessor.handle_crawl_element()</span></code></a></li>
<li><a class="reference internal" href="#queries.default_query.DefaultQueryProcessor.handle_final"><code class="docutils literal notranslate"><span class="pre">DefaultQueryProcessor.handle_final()</span></code></a></li>
<li><a class="reference internal" href="#queries.default_query.DefaultQueryProcessor.handle_flow_enter"><code class="docutils literal notranslate"><span class="pre">DefaultQueryProcessor.handle_flow_enter()</span></code></a></li>
<li><a class="reference internal" href="#queries.default_query.DefaultQueryProcessor.process_element"><code class="docutils literal notranslate"><span class="pre">DefaultQueryProcessor.process_element()</span></code></a></li>
<li><a class="reference internal" href="#queries.default_query.DefaultQueryProcessor.process_influencers"><code class="docutils literal notranslate"><span class="pre">DefaultQueryProcessor.process_influencers()</span></code></a></li>
<li><a class="reference internal" href="#queries.default_query.DefaultQueryProcessor.set_preset_name"><code class="docutils literal notranslate"><span class="pre">DefaultQueryProcessor.set_preset_name()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#queries.default_query.get_sink_influencers"><code class="docutils literal notranslate"><span class="pre">get_sink_influencers()</span></code></a></li>
<li><a class="reference internal" href="#queries.default_query.get_sources"><code class="docutils literal notranslate"><span class="pre">get_sources()</span></code></a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
            </div>

            <div class="right">
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
    &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>

<p id="theme_credit">Styled using the <a href="https://github.com/piccolo-orm/piccolo_theme">Piccolo Theme</a></p>
  </body>
</html>