<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Flowtest module &#8212; Flowtest 0.6.9-ALPHA documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="_static/basic_mod.css?v=94a554c0" />
    <script src="_static/documentation_options.js?v=c96d704d"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/petite-vue.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Public Module" href="public_ref.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="index.html" title="Go to homepage">Flowtest 0.6.9-ALPHA documentation</a></h1>

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Problem Addressed</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#how-it-works">How it works</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="init_flow.html">Flowtest Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="queries_ref.html">Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="flow_parser_ref.html">Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="public_ref.html">Public API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">return to top</a></li>
</ul>

  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="public_ref.html"
                          title="previous chapter">Public Module</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="flowtest-module">
<h1>Flowtest module<a class="headerlink" href="#flowtest-module" title="Link to this heading">¶</a></h1>
<p>This is the main module containing the symbolic execution engine</p>
<section id="main">
<h2>__main__<a class="headerlink" href="#main" title="Link to this heading">¶</a></h2>
<p>Main is the entrypoint to the CLI</p>
<dl class="py function" id="module-flowtest.__main__">
<dt class="sig sig-object py" id="flowtest.__main__.check_dir_exists">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">check_dir_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.check_dir_exists" title="Link to this definition">¶</a></dt>
<dd><p>Checks if the argument is a valid directory. Raises ArgumentTypeError if not.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> (<em>str</em>) – string to check</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.check_file_exists">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">check_file_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.check_file_exists" title="Link to this definition">¶</a></dt>
<dd><p>checks if the file exists, otherwise it raises an ArgumentTypeError</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> (<em>str</em>) – filepath</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>filepath</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.check_not_exist">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">check_not_exist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.check_not_exist" title="Link to this definition">¶</a></dt>
<dd><p>lambda that checks if this path exists or not. Raises an error if it does exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> (<em>str</em>) – string to check</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.get_flow_paths">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">get_flow_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.get_flow_paths" title="Link to this definition">¶</a></dt>
<dd><p>Given the arguments parsed by argparse, returns the flow filenames and names
that should be processed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], {&lt;class ‘str’&gt;: &lt;class ‘str’&gt;})</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>args</strong> (<em>Namespace</em>) – argparse Namespace (parsed arguments)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>flow_name -&gt;
flow_path)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of (list of all flows to scan, dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.main">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.main" title="Link to this definition">¶</a></dt>
<dd><p>Main entry point to CLI command. For testing, we allow specifying
the argv list.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>argv</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – (for testing) list of arguments passed into CLI command</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.parse_args">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">parse_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">my_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.parse_args" title="Link to this definition">¶</a></dt>
<dd><p>Defines parameters for argument parsing</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Namespace</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>default</strong> (<em>str</em>) – unique id for this scan. If None provided, one is generated.</p></li>
<li><p><strong>my_args</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – argument list (complete, so my_args[0] is the program
name)</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>argparse Namespace (parsed arguments)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.__main__.setup_logger">
<span class="sig-prename descclassname"><span class="pre">flowtest.__main__.</span></span><span class="sig-name descname"><span class="pre">setup_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.__main__.setup_logger" title="Link to this definition">¶</a></dt>
<dd><p>Setup logger for scan run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> – logging.Level</p></li>
<li><p><strong>log_file</strong> (<em>str</em>) – path to store logs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="branch-state">
<h2>Branch State<a class="headerlink" href="#branch-state" title="Link to this heading">¶</a></h2>
<p>Branch State manages the influence map</p>
<p id="module-flowtest.branch_state">Maintains data influence map for each crawl step.</p>
<p>BranchState manages the influence maps of all variables under study
and exposes an API to propagate the maps and to query the maps to determine
whether a variable is influenced by another.</p>
<p>&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.branch_state.</span></span><span class="sig-name descname"><span class="pre">BranchState</span></span><a class="headerlink" href="#flowtest.branch_state.BranchState" title="Link to this definition">¶</a></dt>
<dd><p>Instances of BranchState track dataflows within a given flow</p>
<blockquote>
<div><ul class="simple">
<li><p>the current element being processed</p></li>
<li><p>all influence flows seen on this branch and up to this element</p></li>
</ul>
</div></blockquote>
<p>All interaction with influence flows must be done via public APIs
exposed by BranchState. Instantiate only with a builder method.</p>
<p>A clone of the state should be made whenever there is a branch within
a flow, so that when we exit the branch, we recover the state
before branching.</p>
<p>Prior to exiting a subflow, all branches must be consolidated so that
all execution paths are available as return values.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parser</strong> (<a class="reference internal" href="flow_parser_ref.html#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><em>Parser</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.add_vectors_from_other_flow">
<span class="sig-name descname"><span class="pre">add_vectors_from_other_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_flow_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_vector_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src2tgt_variable_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.add_vectors_from_other_flow" title="Link to this definition">¶</a></dt>
<dd><p>Pushes vectors in the source to vectors in the target, by wiring a flow across flow boundaries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">old</span> <span class="n">path</span><span class="p">:</span> <span class="n">src</span> <span class="n">A</span> <span class="p">(</span><span class="o">=</span><span class="n">terminal</span> <span class="ow">in</span> <span class="n">src</span><span class="p">)</span>
<span class="n">new</span> <span class="n">path</span><span class="p">:</span> <span class="n">src</span> <span class="n">A</span> <span class="o">-&gt;</span> <span class="n">target</span> <span class="n">Y</span> <span class="p">(</span><span class="o">=</span><span class="n">start</span> <span class="ow">in</span> <span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
<p>This operation is used when extending parent flows to child on subflow launch
and extending flows from the subflow to the parent on return.</p>
<p>It should be called as an instance method of the <em>target</em> state, in which the new path
is added.</p>
<p>N.B. As the src and target are variables (and not member accesses of other variables),
we assume they have None members but the flows within the flow vector will often have member targets
and these flows need to be resolved. E.g. the src output variable may contain flows such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scalar</span> <span class="o">--&gt;</span> <span class="n">src_var</span><span class="o">.</span><span class="n">Name</span>
</pre></div>
</div>
<p>And then this flow needs to be propagated individually to the .Name
field of the target, and then all these flows added to the target vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{(&lt;class ‘str’&gt;, &lt;class ‘str’&gt;): &lt;class ‘flowtest.flows.FlowVector’&gt;}</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>output_vector_map</strong> (<em>{</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>: &lt;class 'flowtest.flows.FlowVector'&gt;}</em>) – <p>vectors that should be pushed to target:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">src</span> <span class="n">path</span><span class="p">,</span> <span class="n">src</span> <span class="n">name</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="n">src</span> <span class="n">FlowVector</span>
</pre></div>
</div>
</p></li>
<li><p><strong>src2tgt_variable_map</strong> (<em>{&lt;class 'str'&gt;: &lt;class 'str'&gt;}</em>) – variable name in <code class="docutils literal notranslate"><span class="pre">src</span> <span class="pre">name</span> <span class="pre">-&gt;</span> <span class="pre">target</span></code>
variable name in (raw name, not a tuple)</p></li>
<li><p><strong>transition_elem</strong> (<em>_Element</em>) – xml of subflow element</p></li>
<li><p><strong>src_flow_path</strong> (<em>str</em>) – filename of child subflow</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>map (path, variable name) -&gt; FlowVector for all added tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.current_crawl_step">
<span class="sig-name descname"><span class="pre">current_crawl_step</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><a class="reference internal" href="public_ref.html#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrawlStep</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#flowtest.branch_state.BranchState.current_crawl_step" title="Link to this definition">¶</a></dt>
<dd><p>current crawl step</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.current_elem">
<span class="sig-name descname"><span class="pre">current_elem</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">_Element</span></code></em><a class="headerlink" href="#flowtest.branch_state.BranchState.current_elem" title="Link to this definition">¶</a></dt>
<dd><p>current Flow element (xml)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.current_elem_name">
<span class="sig-name descname"><span class="pre">current_elem_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#flowtest.branch_state.BranchState.current_elem_name" title="Link to this definition">¶</a></dt>
<dd><p>Name of Element being currently processed (for convenience)
(The first element in a flow is start and has no name.)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.filter_input_variables">
<span class="sig-name descname"><span class="pre">filter_input_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_vars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.filter_input_variables" title="Link to this definition">¶</a></dt>
<dd><p>filters vectors to remove flows starting in input variables in the current flow</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{(&lt;class ‘str’&gt;, &lt;class ‘str’&gt;): &lt;class ‘flowtest.flows.FlowVector’&gt;}</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>output_vars</strong> (<em>{</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>: &lt;class 'flowtest.flows.FlowVector'&gt;}</em>) – output variables</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered output variables</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.filter_maps">
<span class="sig-name descname"><span class="pre">filter_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.filter_maps" title="Link to this definition">¶</a></dt>
<dd><p>Removes all influence maps except those in <cite>steps</cite></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Destructive operation, only call after flow
processing is complete.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>steps</strong> (<em>[</em><em>&lt;class 'public.data_obj.CrawlStep'&gt;</em><em>]</em>) – CrawlSteps to keep</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. The influence map is filtered in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.flow_name">
<span class="sig-name descname"><span class="pre">flow_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#flowtest.branch_state.BranchState.flow_name" title="Link to this definition">¶</a></dt>
<dd><p>flow label (unique within a given package)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.flow_path">
<span class="sig-name descname"><span class="pre">flow_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#flowtest.branch_state.BranchState.flow_path" title="Link to this definition">¶</a></dt>
<dd><p>filename of flow when working in variables across a flow</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.formula_map">
<span class="sig-name descname"><span class="pre">formula_map</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{(&lt;class</span> <span class="pre">'str'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'str'&gt;):</span> <span class="pre">{&lt;class</span> <span class="pre">'public.data_obj.DataInfluencePath'&gt;}}</span></em><a class="headerlink" href="#flowtest.branch_state.BranchState.formula_map" title="Link to this definition">¶</a></dt>
<dd><p>resolves formulas and templates (late binding indirect references)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.from_parser">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.from_parser" title="Link to this definition">¶</a></dt>
<dd><p>Returns a state instance with variable defaults populated</p>
<p>This instance is <em>not</em> ready to be used until it is loaded
with a crawl step. Only the defaults have been added.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><code class="xref py py-class docutils literal notranslate"><span class="pre">BranchState</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>parser</strong> (<a class="reference internal" href="flow_parser_ref.html#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><em>Parser</em></a>) – parser instance for this flow</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Branch State instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.get_all_output_vectors">
<span class="sig-name descname"><span class="pre">get_all_output_vectors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.get_all_output_vectors" title="Link to this definition">¶</a></dt>
<dd><p>Return output variable FlowVectors</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[((&lt;class ‘str’&gt;, &lt;class ‘str’&gt;), &lt;class ‘flowtest.flows.FlowVector’&gt;)]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>{((flow path, variable name), FlowVector from current state)}
or empty set if no such variables exist</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.get_current_elem">
<span class="sig-name descname"><span class="pre">get_current_elem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.get_current_elem" title="Link to this definition">¶</a></dt>
<dd><p>Get current element being processed</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">_Element</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>xml element associated to the flow’s crawl step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.get_current_elem_name">
<span class="sig-name descname"><span class="pre">get_current_elem_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.get_current_elem_name" title="Link to this definition">¶</a></dt>
<dd><p>Get name of element</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flow Element name of the current crawl step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.get_flows_from_sources">
<span class="sig-name descname"><span class="pre">get_flows_from_sources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">influenced_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.get_flows_from_sources" title="Link to this definition">¶</a></dt>
<dd><p>Finds which flows originate in the source variables.</p>
<p>returns all flows into influencer_var that originate in the
source_vars. Variables can be unresolved but <em>must</em>
resolve to named Flow elements. <code class="docutils literal notranslate"><span class="pre">influencer_var</span></code> can be a
formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code>[<a class="reference internal" href="public_ref.html#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataInfluencePath</span></code></a>]]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>influenced_var</strong> (<em>str</em>) – the (raw, unresolved) variable name</p></li>
<li><p><strong>source_vars</strong> (<em>{</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>}</em>) – raw (unresolved) source variable names,
but with a path tuple.</p></li>
<li><p><strong>all_steps</strong> – whether flows should be loaded from
all crawl steps or just the current step</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Only queries for names in the current flow-path
(This should be handled automatically as sources
are pushed forward via output variable assignments)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None if no tainted flows found, else it returns the set of
DataInfluencePaths tuples, corresponding to flows from the
source vars into the taint statement. The histories of these
paths should be passed into the results collector, but the
entire flow is provided to assist in type analysis if
needed.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>influenced_var</strong> (<em>str</em>) – </p></li>
<li><p><strong>source_vars</strong> (<em>{</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>}</em>) – </p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set[<a class="reference internal" href="public_ref.html#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><em>DataInfluencePath</em></a>] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.get_or_make_vector">
<span class="sig-name descname"><span class="pre">get_or_make_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.get_or_make_vector" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve vector and if none exists, create it.</p>
<p>If used with the current flow_path (or flow_path set to None) then
we create a vector if it doesn’t exist and return it.</p>
<p>If used with some other path, then returns none if the vector doesn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowVector</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name to lookup (can be a variable name, the method
will resolve)</p></li>
<li><p><strong>flow_path</strong> (<em>str</em>) – optional flow_path (if None, will use the
filepath of current flow)</p></li>
<li><p><strong>store</strong> – whether to store the vector in the influence_map
or just return the dummy flow (if adding to an influence chain)</p></li>
<li><p><strong>step</strong> (<a class="reference internal" href="public_ref.html#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><em>CrawlStep</em></a>) – Crawl step to use</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>vector or None if the Name cannot be parsed or does not exist in this flow-path.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.get_parser">
<span class="sig-name descname"><span class="pre">get_parser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.get_parser" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve current parser associated to this flow.</p>
<p>Useful if processing old states for subflows and the current
parser is no longer available.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="flow_parser_ref.html#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parser instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.is_in_map">
<span class="sig-name descname"><span class="pre">is_in_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.is_in_map" title="Link to this definition">¶</a></dt>
<dd><p>checks if the name is in map</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>var_name</strong> (<em>str</em>) – fully resolved name (no member)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if in map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.load_crawl_step">
<span class="sig-name descname"><span class="pre">load_crawl_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crawler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crawl_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.load_crawl_step" title="Link to this definition">¶</a></dt>
<dd><p>Updates the state after crawling to next Flow Element</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="public_ref.html#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrawlStep</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>crawler</strong> (<a class="reference internal" href="#flowtest.control_flow.Crawler" title="flowtest.control_flow.Crawler"><em>Crawler</em></a>) – crawler</p></li>
<li><p><strong>crawl_step</strong> (<a class="reference internal" href="public_ref.html#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><em>CrawlStep</em></a>) – step to load</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>CrawlStep that was loaded</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.parser">
<span class="sig-name descname"><span class="pre">parser</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="flow_parser_ref.html#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code></a></em><a class="headerlink" href="#flowtest.branch_state.BranchState.parser" title="Link to this definition">¶</a></dt>
<dd><p>reference to current parser</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.branch_state.BranchState.propagate_flows">
<span class="sig-name descname"><span class="pre">propagate_flows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">type_replacements</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.branch_state.BranchState.propagate_flows" title="Link to this definition">¶</a></dt>
<dd><p>Propagates the BranchState.influence_map by the DataInfluenceStatement.</p>
<p>Main method to call for building a dataflow graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowVector</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>statement</strong> (<a class="reference internal" href="public_ref.html#public.data_obj.DataInfluenceStatement" title="public.data_obj.DataInfluenceStatement"><em>DataInfluenceStatement</em></a>) – Statement to extend flows by. The influenced of
this statement is the variable of interest whose
dataflows we want to determine.</p></li>
<li><p><strong>assign</strong> (<em>bool</em>) – If true, then statement is an assignment, E.g. a =
b, otherwise it’s an addition, e.g. or a = a+b, in which
case all the old influencers of ‘a’ are preserved and
added to those of b. (Note that populating a collection
is done by assignment)</p></li>
<li><p><strong>store</strong> (<em>bool</em>) – whether to actually update the flow vector with the
flows (True) or only return the vector</p></li>
<li><p><strong>**type_replacements</strong> – override type attributes during propagation [Expert Use]</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If no influencer flows are present,
then we return the original vector (which will just be initialization,
or self-influence). Else the vector representing all influencers
via the statement is returned.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flowtest.branch_state.INITIALIZATION_COMMENT">
<span class="sig-prename descclassname"><span class="pre">flowtest.branch_state.</span></span><span class="sig-name descname"><span class="pre">INITIALIZATION_COMMENT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Initialization'</span></em><a class="headerlink" href="#flowtest.branch_state.INITIALIZATION_COMMENT" title="Link to this definition">¶</a></dt>
<dd><p>string to use in <code class="xref py py-class docutils literal notranslate"><span class="pre">public.DataInfluenceStatement</span></code> comments</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flowtest.branch_state.SUBFLOW_WIRE_COMMENT">
<span class="sig-prename descclassname"><span class="pre">flowtest.branch_state.</span></span><span class="sig-name descname"><span class="pre">SUBFLOW_WIRE_COMMENT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'output</span> <span class="pre">via</span> <span class="pre">subflow</span> <span class="pre">assignment'</span></em><a class="headerlink" href="#flowtest.branch_state.SUBFLOW_WIRE_COMMENT" title="Link to this definition">¶</a></dt>
<dd><p>string to use in <code class="xref py py-class docutils literal notranslate"><span class="pre">public.DataInfluenceStatement</span></code> comments</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flowtest.branch_state.logger">
<span class="sig-prename descclassname"><span class="pre">flowtest.branch_state.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">flowtest.branch_state</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#flowtest.branch_state.logger" title="Link to this definition">¶</a></dt>
<dd><p>module logger</p>
</dd></dl>

</section>
<section id="module-flowtest.control_flow">
<span id="control-flow"></span><h2>Control Flow<a class="headerlink" href="#module-flowtest.control_flow" title="Link to this heading">¶</a></h2>
<p>Module to generate control flow graphs and crawl schedules</p>
<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.ControlFlowGraph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">ControlFlowGraph</span></span><a class="headerlink" href="#flowtest.control_flow.ControlFlowGraph" title="Link to this definition">¶</a></dt>
<dd><p>ControlFlowGraph(start_label: ‘str’, inbound: ‘{str: [Jump]}’, segment_map: ‘{str: Segment}’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.ControlFlowGraph.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inbound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segment_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.ControlFlowGraph.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_label</strong> (<em>str</em>) – </p></li>
<li><p><strong>inbound</strong> (<em>{&lt;class 'str'&gt;:</em><em> [</em><em>&lt;class 'flowtest.control_flow.Jump'&gt;</em><em>]</em><em>}</em>) – </p></li>
<li><p><strong>segment_map</strong> (<em>{&lt;class 'str'&gt;: &lt;class 'flowtest.control_flow.Segment'&gt;}</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.CrawlEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">CrawlEncoder</span></span><a class="headerlink" href="#flowtest.control_flow.CrawlEncoder" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.CrawlEncoder.default">
<span class="sig-name descname"><span class="pre">default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.CrawlEncoder.default" title="Link to this definition">¶</a></dt>
<dd><p>Implement this method in a subclass such that it returns
a serializable object for <code class="docutils literal notranslate"><span class="pre">o</span></code>, or calls the base implementation
(to raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p>
<p>For example, to support arbitrary iterators, you could
implement default like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="c1"># Let the base class default method raise the TypeError</span>
    <span class="k">return</span> <span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.CrawlSchedule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">CrawlSchedule</span></span><a class="headerlink" href="#flowtest.control_flow.CrawlSchedule" title="Link to this definition">¶</a></dt>
<dd><p>CrawlSchedule(total_steps: ‘int’, total_branches: ‘int’, crawl: ‘[{str: int | str}]’, branch_map: ‘{((str, str),): BranchVisitor}’, branch_counts: ‘{((str, str),): int}’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.CrawlSchedule.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_branches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crawl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_counts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.CrawlSchedule.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_steps</strong> (<em>int</em>) – </p></li>
<li><p><strong>total_branches</strong> (<em>int</em>) – </p></li>
<li><p><strong>crawl</strong> (<em>[</em><em>{&lt;class 'str'&gt;: int</em><em> | </em><em>str}</em><em>]</em>) – </p></li>
<li><p><strong>branch_map</strong> (<em>{</em><em>(</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>,</em><em>)</em><em>: &lt;class 'public.data_obj.BranchVisitor'&gt;}</em>) – </p></li>
<li><p><strong>branch_counts</strong> (<em>{</em><em>(</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>,</em><em>)</em><em>: &lt;class 'int'&gt;}</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">Crawler</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler" title="Link to this definition">¶</a></dt>
<dd><p>Class representing the crawl of a graph</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crawl_schedule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terminal_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history_maps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Crawler.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Constructor</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For module use only</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_steps</strong> – how many steps in crawl</p></li>
<li><p><strong>crawl_schedule</strong> – tuple of <a class="reference internal" href="public_ref.html#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">public.data_obj.CrawlStep</span></code></a> in order of execution</p></li>
<li><p><strong>terminal_steps</strong> – tuple of <a class="reference internal" href="public_ref.html#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">public.data_obj.CrawlStep</span></code></a>
that can end program (note, <em>not</em> in any specific order)</p></li>
<li><p><strong>history_maps</strong> – map from history to last seen crawl_step with this history</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.crawl_schedule">
<span class="sig-name descname"><span class="pre">crawl_schedule</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler.crawl_schedule" title="Link to this definition">¶</a></dt>
<dd><p>tuple(<span class="xref std std-ref">public.data_obj.CrawlStep</span>) all crawl steps in order of execution</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.current_step">
<span class="sig-name descname"><span class="pre">current_step</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler.current_step" title="Link to this definition">¶</a></dt>
<dd><p>int current step of crawl</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.from_parser">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Crawler.from_parser" title="Link to this definition">¶</a></dt>
<dd><p>Builds a crawl schedule (recommended builder)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parser</strong> (<a class="reference internal" href="flow_parser_ref.html#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><em>Parser</em></a>) – <a class="reference internal" href="flow_parser_ref.html#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flow_parser.parse.Parser</span></code></a> instance</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#flowtest.control_flow.Crawler" title="flowtest.control_flow.Crawler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Crawler</span></code></a> instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.get_crawl_step">
<span class="sig-name descname"><span class="pre">get_crawl_step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Crawler.get_crawl_step" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the next crawl step</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="public_ref.html#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrawlStep</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="public_ref.html#public.data_obj.BranchVisitor" title="public.data_obj.BranchVisitor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">public.data_obj.BranchVisitor</span></code></a> and flow element name to process</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.get_last_ancestor">
<span class="sig-name descname"><span class="pre">get_last_ancestor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crawl_step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Crawler.get_last_ancestor" title="Link to this definition">¶</a></dt>
<dd><p>Get latest ancestor branch that was last visited</p>
<p>Useful for knowing which influence map to clone</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="public_ref.html#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrawlStep</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>crawl_step</strong> – step whose history is sought</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>CrawlStep instance or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.history_maps">
<span class="sig-name descname"><span class="pre">history_maps</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler.history_maps" title="Link to this definition">¶</a></dt>
<dd><p>crawl_step -&gt; last seen ancestor</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.terminal_steps">
<span class="sig-name descname"><span class="pre">terminal_steps</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler.terminal_steps" title="Link to this definition">¶</a></dt>
<dd><p>tuple(<span class="xref std std-ref">public.data_obj.CrawlStep</span>) steps that can terminate the program</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.control_flow.Crawler.total_steps">
<span class="sig-name descname"><span class="pre">total_steps</span></span><a class="headerlink" href="#flowtest.control_flow.Crawler.total_steps" title="Link to this definition">¶</a></dt>
<dd><p>int total number of steps</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.JSONSerializable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">JSONSerializable</span></span><a class="headerlink" href="#flowtest.control_flow.JSONSerializable" title="Link to this definition">¶</a></dt>
<dd><p>JSONSerializable()</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.JSONSerializable.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.JSONSerializable.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.Jump">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">Jump</span></span><a class="headerlink" href="#flowtest.control_flow.Jump" title="Link to this definition">¶</a></dt>
<dd><p>Class representing a connector</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Jump.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_goto</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_loop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Jump.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src_name</strong> (<em>str</em>) – </p></li>
<li><p><strong>target</strong> (<em>str</em>) – </p></li>
<li><p><strong>is_goto</strong> (<em>bool</em>) – </p></li>
<li><p><strong>is_loop</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.control_flow.Segment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">Segment</span></span><a class="headerlink" href="#flowtest.control_flow.Segment" title="Link to this definition">¶</a></dt>
<dd><p>Segment(label: ‘str’, traversed: ‘[str]’, subflows: ‘[int]’, jumps: ‘[Jump]’, is_terminal: ‘bool’, seen_visitors: ‘[(str, str)]’ = &lt;factory&gt;)</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Segment.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traversed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subflows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jumps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_terminal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seen_visitors=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Segment.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – </p></li>
<li><p><strong>traversed</strong> (<em>[</em><em>&lt;class 'str'&gt;</em><em>]</em>) – </p></li>
<li><p><strong>subflows</strong> (<em>[</em><em>&lt;class 'int'&gt;</em><em>]</em>) – </p></li>
<li><p><strong>jumps</strong> (<em>[</em><em>&lt;class 'flowtest.control_flow.Jump'&gt;</em><em>]</em>) – </p></li>
<li><p><strong>is_terminal</strong> (<em>bool</em>) – </p></li>
<li><p><strong>seen_visitors</strong> (<em>[</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.control_flow.Segment.accept">
<span class="sig-name descname"><span class="pre">accept</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">visitor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.Segment.accept" title="Link to this definition">¶</a></dt>
<dd><p>does the node accept the visitor</p>
<p>Also updates visitor state</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[&lt;class ‘public.data_obj.BranchVisitor’&gt;]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>visitor</strong> (<a class="reference internal" href="public_ref.html#public.data_obj.BranchVisitor" title="public.data_obj.BranchVisitor"><em>BranchVisitor</em></a>) – Branch Visitor trying to jump into node</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of labels to process or None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.control_flow.crawl_iter">
<span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">crawl_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.crawl_iter" title="Link to this definition">¶</a></dt>
<dd><p>crawls CFG</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code>[(<a class="reference internal" href="public_ref.html#public.data_obj.BranchVisitor" title="public.data_obj.BranchVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BranchVisitor</span></code></a>, [&lt;class ‘flowtest.control_flow.Segment’&gt;]), <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cfg</strong> (<a class="reference internal" href="#flowtest.control_flow.ControlFlowGraph" title="flowtest.control_flow.ControlFlowGraph"><em>ControlFlowGraph</em></a>) – control flow graph</p>
</dd>
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p>current Branch visitor, list of flow elements to process, outgoing Branch Visitors</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.control_flow.get_crawl_schedule">
<span class="sig-prename descclassname"><span class="pre">flowtest.control_flow.</span></span><span class="sig-name descname"><span class="pre">get_crawl_schedule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.control_flow.get_crawl_schedule" title="Link to this definition">¶</a></dt>
<dd><p>Builds crawl schedule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cfg</strong> (<a class="reference internal" href="#flowtest.control_flow.ControlFlowGraph" title="flowtest.control_flow.ControlFlowGraph"><em>ControlFlowGraph</em></a>) – Control Flow Graph</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(tuple of crawl steps, tuple of terminal steps)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>((<a class="reference internal" href="public_ref.html#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep">CrawlStep</a>,), (<a class="reference internal" href="public_ref.html#public.data_obj.CrawlStep" title="public.data_obj.CrawlStep">CrawlStep</a>,))</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-flowtest.ESAPI">
<span id="esapi"></span><h2>ESAPI<a class="headerlink" href="#module-flowtest.ESAPI" title="Link to this heading">¶</a></h2>
<p>Security Encoding library</p>
<dl class="py function">
<dt class="sig sig-object py" id="flowtest.ESAPI.html_encode">
<span class="sig-prename descclassname"><span class="pre">flowtest.ESAPI.</span></span><span class="sig-name descname"><span class="pre">html_encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.ESAPI.html_encode" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>msg</strong> (<em>str</em>) – </p>
</dd>
</dl>
<p>Performs html encoding
:param msg: unicode message to encode</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>html encoded message</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>msg</strong> (<em>str</em>) – </p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.ESAPI.legal_sql_escape">
<span class="sig-prename descclassname"><span class="pre">flowtest.ESAPI.</span></span><span class="sig-name descname"><span class="pre">legal_sql_escape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.ESAPI.legal_sql_escape" title="Link to this definition">¶</a></dt>
<dd><p>Escape single quotes with two single quotes.</p>
<p>This is the SQL standard escaping.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>msg</strong> (<em>str</em>) – string to escape</p>
</dd>
</dl>
<p>Returns: escaped string</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.ESAPI.sql_enc_html_dec">
<span class="sig-prename descclassname"><span class="pre">flowtest.ESAPI.</span></span><span class="sig-name descname"><span class="pre">sql_enc_html_dec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.ESAPI.sql_enc_html_dec" title="Link to this definition">¶</a></dt>
<dd><p>Decodes html-encoded text</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>msg</strong> (<em>str</em>) – string to decode</p>
</dd>
</dl>
<p>Returns: decoded string</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.ESAPI.sql_escape">
<span class="sig-prename descclassname"><span class="pre">flowtest.ESAPI.</span></span><span class="sig-name descname"><span class="pre">sql_escape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.ESAPI.sql_escape" title="Link to this definition">¶</a></dt>
<dd><p>simple sql escape (unicode)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>msg</strong> (<em>str</em>) – string to escape</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>escapes and ‘</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-flowtest.executor">
<span id="executor"></span><h2>Executor<a class="headerlink" href="#module-flowtest.executor" title="Link to this heading">¶</a></h2>
<p>Performs symbolic execution and vulnerability analysis</p>
<blockquote>
<div><p>&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
</div></blockquote>
<p>The executor handles the element crawl and dispatches
query handlers and dataflow updates as appropriate</p>
<dl class="py data">
<dt class="sig sig-object py" id="flowtest.executor.FOLLOW_SUBFLOWS">
<span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">FOLLOW_SUBFLOWS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#flowtest.executor.FOLLOW_SUBFLOWS" title="Link to this definition">¶</a></dt>
<dd><p>for debugging the flow being analyzed</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.executor.Frame">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">Frame</span></span><a class="headerlink" href="#flowtest.executor.Frame" title="Link to this definition">¶</a></dt>
<dd><p>Frame is responsible for managing program analysis within a single flow.</p>
<p>Execution happens along each branch, which is assigned a branch state
and branching xml element (e.g. Loop element or Decision element)</p>
<p>Branch management is via maintaining a worklist consisting of branches
that need to be processed, with each branch a tuple (State, branch elem)</p>
<p>The worklist is processed as a double-ended queue, with new branches
to be processed appended to the end and the next branch to process
pulled from the front.</p>
<p>When a subflow element is encountered, the frame builds a child frame
and returns it to the Stack.</p>
<blockquote>
<div><dl class="simple">
<dt>wire.wire_processor –&gt; parses current_elem to obtain data influence</dt><dd><p>statements and wires these into the State’s
influence map.</p>
</dd>
<dt>query.query_processor –&gt; looks for flows into sources and sinks</dt><dd><p>in the current elem, and stores findings
in result instance</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_flow_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_flow_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_flow_path</strong> (<em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>all_flow_paths</strong> (<em>{&lt;class 'str'&gt;: &lt;class 'str'&gt;}</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.all_flow_paths">
<span class="sig-name descname"><span class="pre">all_flow_paths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{&lt;class</span> <span class="pre">'str'&gt;:</span> <span class="pre">&lt;class</span> <span class="pre">'str'&gt;}</span></em><a class="headerlink" href="#flowtest.executor.Frame.all_flow_paths" title="Link to this definition">¶</a></dt>
<dd><p><cite>flow_name</cite> -&gt; <cite>flow_path</cite> so that when we encounter a subflow we can load the file</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>this is a map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.build">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_flow_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_flow_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolved_subflows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_subflow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.build" title="Link to this definition">¶</a></dt>
<dd><p>Call this whenever program analysis starts or a subflow is reached</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><code class="xref py py-class docutils literal notranslate"><span class="pre">Frame</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>current_flow_path</strong> (<em>str</em><em> | </em><em>None</em>) – current path of flow</p></li>
<li><p><strong>all_flow_paths</strong> (<em>{&lt;class 'str'&gt;: &lt;class 'str'&gt;}</em>) – map[flow_name: flow_path] for all flows in
scope to be scanned</p></li>
<li><p><strong>resolved_subflows</strong> (<em>{}</em>) – subflows that have been already processed</p></li>
<li><p><strong>parent_subflow</strong> (<em>_Element</em>) – current subflow element that spawned this
frame</p></li>
<li><p><strong>query_manager</strong> (<em>QueryManager</em>) – manages query instances</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>new Frame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.child_spawned">
<span class="sig-name descname"><span class="pre">child_spawned</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#flowtest.executor.Frame.child_spawned" title="Link to this definition">¶</a></dt>
<dd><p>binary semaphore so when we return, we don’t execute spawn the subflow again</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.crawler">
<span class="sig-name descname"><span class="pre">crawler</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><a class="reference internal" href="#flowtest.control_flow.Crawler" title="flowtest.control_flow.Crawler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Crawler</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#flowtest.executor.Frame.crawler" title="Link to this definition">¶</a></dt>
<dd><p>supplies next element and branch-state to process</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.execute" title="Link to this definition">¶</a></dt>
<dd><p>Performs symbolic execution on the Frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><code class="xref py py-class docutils literal notranslate"><span class="pre">Frame</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new Frame to process in case a subflow has been launched,
and finally returning None when the Frame’s processing is complete.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.flow_name">
<span class="sig-name descname"><span class="pre">flow_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#flowtest.executor.Frame.flow_name" title="Link to this definition">¶</a></dt>
<dd><p>name of flow we are working on. Needed for loading subflows</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.flow_path">
<span class="sig-name descname"><span class="pre">flow_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#flowtest.executor.Frame.flow_path" title="Link to this definition">¶</a></dt>
<dd><p>path of flow we are working on, needed when labelling inputs/outputs</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.get_consolidated_output_vars">
<span class="sig-name descname"><span class="pre">get_consolidated_output_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.get_consolidated_output_vars" title="Link to this definition">¶</a></dt>
<dd><p>get all output variable vectors from all terminal BranchStates.</p>
<p>Call this method after flow processing has completed for a subflow
in order to return all possible output variables to the parent.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{(&lt;class ‘str’&gt;, &lt;class ‘str’&gt;): &lt;class ‘flowtest.flows.FlowVector’&gt;}</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a map (flow_path, variable name) -&gt; FlowVector</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.handle_subflows">
<span class="sig-name descname"><span class="pre">handle_subflows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.handle_subflows" title="Link to this definition">¶</a></dt>
<dd><p>Checks whether we have encountered a subflow elem.</p>
<p>Different behavior required if we are returning from the element or entering into it.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><code class="xref py py-class docutils literal notranslate"><span class="pre">Frame</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>current_elem</strong> (<em>_Element</em>) – Flow element to check</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>new Frame in case we are entering a new subflow, or None in
case we are returning from the subflow.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.inputs">
<span class="sig-name descname"><span class="pre">inputs</span></span><a class="headerlink" href="#flowtest.executor.Frame.inputs" title="Link to this definition">¶</a></dt>
<dd><p>store inputs of subflow in child frame (testing only)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.parent_subflow">
<span class="sig-name descname"><span class="pre">parent_subflow</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">_Element</span></code><span class="pre">]</span></em><a class="headerlink" href="#flowtest.executor.Frame.parent_subflow" title="Link to this definition">¶</a></dt>
<dd><p>Subflow XML element that launched this flow (can be None)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.parser">
<span class="sig-name descname"><span class="pre">parser</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><a class="reference internal" href="flow_parser_ref.html#flow_parser.parse.Parser" title="flow_parser.parse.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#flowtest.executor.Frame.parser" title="Link to this definition">¶</a></dt>
<dd><p>XML parser instance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.prediction">
<span class="sig-name descname"><span class="pre">prediction</span></span><a class="headerlink" href="#flowtest.executor.Frame.prediction" title="Link to this definition">¶</a></dt>
<dd><p>store prediction of subflow outputs in child frame (for testing only)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.query_manager">
<span class="sig-name descname"><span class="pre">query_manager</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryManager</span></code><span class="pre">]</span></em><a class="headerlink" href="#flowtest.executor.Frame.query_manager" title="Link to this definition">¶</a></dt>
<dd><p>query processor instance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.resolved_subflows">
<span class="sig-name descname"><span class="pre">resolved_subflows</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#flowtest.executor.Frame.resolved_subflows" title="Link to this definition">¶</a></dt>
<dd><p>placeholder for fast-forward scans (not currently used)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.spawn_child_frame">
<span class="sig-name descname"><span class="pre">spawn_child_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subflow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.spawn_child_frame" title="Link to this definition">¶</a></dt>
<dd><p>Spawn a child frame when entering subflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><code class="xref py py-class docutils literal notranslate"><span class="pre">Frame</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>subflow</strong> (<em>_Element</em>) – </p></li>
<li><p><strong>sub_path</strong> (<em>str</em>) – </p></li>
<li><p><strong>input_map</strong> (<em>{&lt;class 'str'&gt;: &lt;class 'str'&gt;}</em>) – </p></li>
<li><p><strong>vector_map</strong> (<em>{</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>: &lt;class 'flowtest.flows.FlowVector'&gt;}</em>) – </p></li>
</ul>
</dd>
</dl>
<section id="function-call-and-return">
<h3>Function Call and Return<a class="headerlink" href="#function-call-and-return" title="Link to this heading">¶</a></h3>
<p>When exiting a function, only those influence elements that survive are the output
variables. These are then mapped to variables in the calling flow based on assignments
in the subflow element.</p>
<p>Entering: we have a map (filename_parent, var_parent) –&gt; (filename_child, var_child)
Exiting: another map (filename_child, var_child) —&gt; (filename_parent, var_parent)</p>
<p>To spawn:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>get path of child flow</p></li>
<li><p>Build frame with Frame.build</p></li>
<li><p>Wire the input flows into the child and add them to the child’s state</p></li>
<li><p>set self.child_spawned = True (so when we return, we don’t spawn again!)</p></li>
<li><p>return the new Frame.</p></li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the parser object remembers all the sources and sinks from the parent
and these are available to the child as well (the old parser is propagated
to the child, as is the old result instance)</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">param sub_path<span class="colon">:</span></dt>
<dd class="field-odd"><p>filepath of subflow being called</p>
</dd>
<dt class="field-even">param input_map<span class="colon">:</span></dt>
<dd class="field-even"><p>map of output variables in child to input variables of subflow</p>
</dd>
<dt class="field-odd">param vector_map<span class="colon">:</span></dt>
<dd class="field-odd"><p>map from tuple to the flow vectors that will be pushed into the child</p>
</dd>
<dt class="field-even">param subflow<span class="colon">:</span></dt>
<dd class="field-even"><p>subflow xml element</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>updated child frame ready to begin processing</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.state">
<span class="sig-name descname"><span class="pre">state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><code class="xref py py-class docutils literal notranslate"><span class="pre">BranchState</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#flowtest.executor.Frame.state" title="Link to this definition">¶</a></dt>
<dd><p>current state being processed</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.subflow_input_cache">
<span class="sig-name descname"><span class="pre">subflow_input_cache</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{&lt;class</span> <span class="pre">'str'&gt;:</span> <span class="pre">[[{(&lt;class</span> <span class="pre">'str'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'str'&gt;):</span> <span class="pre">&lt;class</span> <span class="pre">'flowtest.flows.FlowVector'&gt;}]]}</span></em><a class="headerlink" href="#flowtest.executor.Frame.subflow_input_cache" title="Link to this definition">¶</a></dt>
<dd><p>cache of input values of subflows called from this frame.
These are the input variables to each subflow, mapping
subflow_path -&gt; [[input flow map, output flow map]]
where the flow map is the map from tuples to flow vectors - <cite>{(str, str): FlowVector}</cite>
corresponding to inputs and outputs each time the subflow is called
(hence a list of lists)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Frame.subflow_output_variable_cache">
<span class="sig-name descname"><span class="pre">subflow_output_variable_cache</span></span><a class="headerlink" href="#flowtest.executor.Frame.subflow_output_variable_cache" title="Link to this definition">¶</a></dt>
<dd><p>cache of output variables in the subflow
subflow path -&gt; [(path, var name)]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Frame.update_parent_frame">
<span class="sig-name descname"><span class="pre">update_parent_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_vector_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Frame.update_parent_frame" title="Link to this definition">¶</a></dt>
<dd><p>Updates the provided parent frame with the return values of the current frame.
:rtype: <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
<ul class="simple">
<li><p>Query Manager updated to have new parser</p></li>
<li><p>New Influence Paths that flow into the output variables of the subflow are pushed
into the parent.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_vector_map</strong> – map from tuples to output vectors of the child subflow</p></li>
<li><p><strong>parent_frame</strong> (<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><em>Frame</em></a>) – frame which spawned the current frame via a
subflow</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flowtest.executor.Stack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">Stack</span></span><a class="headerlink" href="#flowtest.executor.Stack" title="Link to this definition">¶</a></dt>
<dd><p>The Stack handles subflow invocation.</p>
<p>When we pass to a subflow a new frame is pushed on the stack and when we
return it is popped.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Stack.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_flow_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_flow_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_manager</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Stack.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Constructor (can be used)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_flow_path</strong> (<em>str</em>) – current filename of flow being processed</p></li>
<li><p><strong>all_flow_paths</strong> (<em>{&lt;class 'str'&gt;: &lt;class 'str'&gt;}</em>) – map[flow_name] -&gt; flow_path of all files in scope</p></li>
<li><p><strong>query_manager</strong> (<em>QueryManager</em>) – invokes queries and stores results</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Results:</dt><dd><p>result instance object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Stack.all_flow_paths">
<span class="sig-name descname"><span class="pre">all_flow_paths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{&lt;class</span> <span class="pre">'str'&gt;:</span> <span class="pre">&lt;class</span> <span class="pre">'str'&gt;}</span></em><a class="headerlink" href="#flowtest.executor.Stack.all_flow_paths" title="Link to this definition">¶</a></dt>
<dd><p>map from flow name to flow filepath (for subflow path lookup)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Stack.current_frame">
<span class="sig-name descname"><span class="pre">current_frame</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><code class="xref py py-class docutils literal notranslate"><span class="pre">Frame</span></code></a></em><a class="headerlink" href="#flowtest.executor.Stack.current_frame" title="Link to this definition">¶</a></dt>
<dd><p>current frame being processed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Stack.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Stack.pop" title="Link to this definition">¶</a></dt>
<dd><p>Get next frame from stack</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><code class="xref py py-class docutils literal notranslate"><span class="pre">Frame</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>frame or None if empty</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Stack.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Stack.push" title="Link to this definition">¶</a></dt>
<dd><p>Pushes a frame onto stack, call when invoking a subflow</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frame</strong> (<a class="reference internal" href="#flowtest.executor.Frame" title="flowtest.executor.Frame"><em>Frame</em></a>) – frame to push to the top of the stack</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Stack.query_manager">
<span class="sig-name descname"><span class="pre">query_manager</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryManager</span></code></em><a class="headerlink" href="#flowtest.executor.Stack.query_manager" title="Link to this definition">¶</a></dt>
<dd><p>pointer to query manager so that it can be returned on exit</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flowtest.executor.Stack.resolved_subflows">
<span class="sig-name descname"><span class="pre">resolved_subflows</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{&lt;class</span> <span class="pre">'str'&gt;:</span> <span class="pre">{(&lt;class</span> <span class="pre">'str'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'str'&gt;):</span> <span class="pre">&lt;class</span> <span class="pre">'flowtest.flows.FlowVector'&gt;}}</span></em><a class="headerlink" href="#flowtest.executor.Stack.resolved_subflows" title="Link to this definition">¶</a></dt>
<dd><p>subflows that have already been processed
subflow name –&gt; Flow Vectors
{(str, str): flows.FlowVector}:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.executor.Stack.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.Stack.run" title="Link to this definition">¶</a></dt>
<dd><p>Main entry point for symbolic execution of an initialized stack</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryManager</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Query Manager object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flowtest.executor.TRUST_CARNAC">
<span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">TRUST_CARNAC</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#flowtest.executor.TRUST_CARNAC" title="Link to this definition">¶</a></dt>
<dd><p>whether we should rely on stored outputs instead of re-running the subflow</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flowtest.executor.TRY_CARNAC">
<span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">TRY_CARNAC</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#flowtest.executor.TRY_CARNAC" title="Link to this definition">¶</a></dt>
<dd><p>store outputs when re-running subflows and compare with predicted</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.executor.call_carnac">
<span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">call_carnac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_cache</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subflow_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.call_carnac" title="Link to this definition">¶</a></dt>
<dd><p>Predicts what the subflow will return</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{(&lt;class ‘str’&gt;, &lt;class ‘str’&gt;): &lt;class ‘flowtest.flows.FlowVector’&gt;}</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>input_cache</strong> (<em>{&lt;class 'str'&gt;:</em><em> [</em><em>[</em><em>{</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>: &lt;class 'flowtest.flows.FlowVector'&gt;}</em><em>]</em><em>]</em><em>}</em>) – cache of previous flow inputs</p></li>
<li><p><strong>vector_map</strong> (<em>{</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>: &lt;class 'flowtest.flows.FlowVector'&gt;}</em>) – subflow inputs</p></li>
<li><p><strong>subflow_path</strong> (<em>str</em>) – filepath of subflow to be called</p></li>
<li><p><strong>outputs</strong> (<em>{</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>: &lt;class 'flowtest.flows.FlowVector'&gt;}</em>) – outputs to add</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>output vector map (return values from subflow)</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flowtest.executor.logger">
<span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Logger</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">flowtest.executor</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#flowtest.executor.logger" title="Link to this definition">¶</a></dt>
<dd><p>logger for current module</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.executor.parse_flow">
<span class="sig-prename descclassname"><span class="pre">flowtest.executor.</span></span><span class="sig-name descname"><span class="pre">parse_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flow_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requestor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">service_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_module_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_class_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_preset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.executor.parse_flow" title="Link to this definition">¶</a></dt>
<dd><p>Main loop that performs control and dataflow analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryManager</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>flow_path</strong> (<em>str</em>) – path (on filesystem) of flow-meta.xml file</p></li>
<li><p><strong>requestor</strong> (<em>str</em>) – email address of scan recipient (optional)</p></li>
<li><p><strong>report_label</strong> (<em>str</em>) – human-readable name for report (optional)</p></li>
<li><p><strong>result_id</strong> (<em>str</em>) – id of report (for use in a jobs management system) (optional)</p></li>
<li><p><strong>service_version</strong> (<em>str</em>) – version of jobs management system (optional)</p></li>
<li><p><strong>help_url</strong> (<em>str</em>) – url to display on report for more info about results (optional)</p></li>
<li><p><strong>query_module_path</strong> (<em>str</em>) – path of module where custom queries are stored</p></li>
<li><p><strong>query_class_name</strong> (<em>str</em>) – name of query class to instantiate</p></li>
<li><p><strong>query_preset</strong> (<em>str</em>) – name of preset to run</p></li>
<li><p><strong>query_manager</strong> (<em>QueryManager</em><em> | </em><em>None</em>) – existing instance that invokes queries across entire run. Start with None
and one will be created.</p></li>
<li><p><strong>all_flows</strong> (<em>{&lt;class 'str'&gt;: &lt;class 'str'&gt;}</em>) – map flow name -&gt; path of flow (used for looking up flow paths of subflows)</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>instance of ger_report.Result class that can be used to generate reports
or passed to other flows.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-flowtest.flow_metrics">
<span id="flow-metrics"></span><h2>Flow Metrics<a class="headerlink" href="#module-flowtest.flow_metrics" title="Link to this heading">¶</a></h2>
<p>Python module for parsing xml result file and generating html reports.
&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
<p>This file will read from the package</p>
<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.add_to_query_config">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">add_to_query_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_of_desc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.add_to_query_config" title="Link to this definition">¶</a></dt>
<dd><p>Adds query descriptions to module-level config file if not present</p>
<p>Call after loading any queries from disk. Must pass
an object of type public.data_obj.QueryDescription</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>list_of_desc</strong> (<em>[</em><a class="reference internal" href="public_ref.html#public.data_obj.QueryDescription" title="public.data_obj.QueryDescription"><em>QueryDescription</em></a><em>]</em>) – </p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError if query descriptions are already present</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.count_issues">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">count_issues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan_results</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.count_issues" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scan_results</strong> – scan_results: List&lt;QueryData&gt;</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>security issues, quality issues total counts from
scan_results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.get_issues_for_org">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">get_issues_for_org</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vuln_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.get_issues_for_org" title="Link to this definition">¶</a></dt>
<dd><p>Counts findings for each query</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scan_results</strong> – List&lt;Query Data&gt; list of found issues</p></li>
<li><p><strong>vuln_map</strong> – map of scan info fields to CX issues e.g.
vuln_map[StoredXSS]=[cx_desc1,cx_desc2,] etc.</p></li>
</ul>
</dd>
</dl>
<p>(A bit inefficient since we loop through all queries rather than
removing already used queries, but this is not a concern here.)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dictionary with keys = issue types in scan info and number of
issues found</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.get_software_presets">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">get_software_presets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preset_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.get_software_presets" title="Link to this definition">¶</a></dt>
<dd><p>Returns empty list if no software presets found with this name</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[&lt;class ‘str’&gt;]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>preset_name</strong> (<em>str</em>) – name of preset to retrieve</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of query names in this preset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.parse_results">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">parse_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xml_report_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">failed_queries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">throttle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">email_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">friendly_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">service_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'3.0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_api_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.parse_results" title="Link to this definition">¶</a></dt>
<dd><p>Parses Cx xml results file and generates HTML report.</p>
<blockquote>
<div><p>Parsing policy:</p>
<ul class="simple">
<li><p>HTML write: For query, result, and Path events, We write HTML at start.</p></li>
<li><p>For pathNode, we write HTML at end..</p></li>
<li><p>query_data is instantiated in start of Query tags</p></li>
<li><p>query_data is updated at start events of Result tags (we count the number if results)</p></li>
<li><p>clean up occurs at end events.</p></li>
<li><p>query_data is inserted into result at end of Query tags</p></li>
<li><p>The footer is written at the end of the root elem.</p></li>
</ul>
<p>Attributes set during start events but not tag contents.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xml_file</strong> – unicode path of xml file containing results</p></li>
<li><p><strong>xml_report_str</strong> – unicode str of xml report (if file not provided)</p></li>
<li><p><strong>report_path</strong> – (required for report gen) unicode path where the
HTML report should be stored</p></li>
<li><p><strong>failed_queries</strong> – pulled from log file. list of query_paths that
failed.</p></li>
<li><p><strong>throttle</strong> – Boolean (whether to limit the number of issues found
per query)</p></li>
<li><p><strong>source_dir</strong> – unicode directory where source code is stored (on
Cx)</p></li>
<li><p><strong>email_add</strong> – unicode email address to which report should be sent</p></li>
<li><p><strong>friendly_name</strong> – unicode friendly name of scan</p></li>
<li><p><strong>job_type</strong> – unicode job type (TZ, Portal)</p></li>
<li><p><strong>preset</strong> – preset used</p></li>
<li><p><strong>scan_start</strong> – unicode scan start time</p></li>
<li><p><strong>scan_end</strong> – unicode scan end time</p></li>
<li><p><strong>result_id</strong> – scan queue id (on security org)</p></li>
<li><p><strong>service_version</strong> – version of popcrab + queries running this scan</p></li>
<li><p><strong>debug</strong> – True or False (for logging/tracing)</p></li>
<li><p><strong>min_api_version</strong> – float (flag lightning bundles of an earlier
version)</p></li>
<li><p><strong>help_url</strong> – url where report viewers can get more help</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>job_info, List&lt;QueryData&gt; scan_results</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.reverse_map">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">reverse_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vuln_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.reverse_map" title="Link to this definition">¶</a></dt>
<dd><p>Go from 1) a dict of field names to vuln name list
to 2) a dict of vuln names to field name lists</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.flow_metrics.serialize">
<span class="sig-prename descclassname"><span class="pre">flowtest.flow_metrics.</span></span><span class="sig-name descname"><span class="pre">serialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">portion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_metrics.serialize" title="Link to this definition">¶</a></dt>
<dd><p>serializes element from iterparse.
(N.B: iterparse returns bytestrings, not code points. This is true for events, tags, etc.
Because we are using unicode literals, this means a decoding will occur. Decoding automatically
occurs when concatenating a string with a unicode code point)</p>
</dd></dl>

</section>
<section id="module-flowtest.flow_result">
<span id="flow-result"></span><h2>Flow Result<a class="headerlink" href="#module-flowtest.flow_result" title="Link to this heading">¶</a></h2>
<p>Serializes results and interacts with
third party report processors</p>
<blockquote>
<div><p>&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.flow_result.</span></span><span class="sig-name descname"><span class="pre">ResultsProcessor</span></span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor" title="Link to this definition">¶</a></dt>
<dd><p>Class storing all the information necessary for a report.</p>
<p>This includes labelling information like the report requested,
scan start time, etc., as well as the results of the findings.</p>
<p>The class contains methods to take this information and generate
json, xml and html reports.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requestor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'System'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">service_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.6.9-ALPHA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'https://security.secure.force.com/security/tools/forcecom/scannerhelp'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>preset</strong> (<a class="reference internal" href="public_ref.html#public.data_obj.Preset" title="public.data_obj.Preset"><em>Preset</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.add_results">
<span class="sig-name descname"><span class="pre">add_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_results</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.add_results" title="Link to this definition">¶</a></dt>
<dd><p>Add results to processor</p>
<p>Stores results internally for simple de-duplication.
All we do is use datapath equality, so please don’t put
unique comment strings containing things like step number
or timestamps into influence statements, as they wont be
de-duped.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>query_results</strong> (<em>[</em><em>&lt;class 'public.data_obj.QueryResult'&gt;</em><em>]</em>) – list of Query-Result objects</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.dump_json">
<span class="sig-name descname"><span class="pre">dump_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.dump_json" title="Link to this definition">¶</a></dt>
<dd><p>Write json string of results to file pointer</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fp</strong> (<em>TextIO</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.gen_result_dict">
<span class="sig-name descname"><span class="pre">gen_result_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.gen_result_dict" title="Link to this definition">¶</a></dt>
<dd><p>Sorts results into query buckets</p>
<p>Used internally to generate popcrab compatible
xml and html report formats.</p>
<p>Also useful for testing</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{&lt;class ‘str’&gt;: {&lt;class ‘str’&gt;: &lt;class ‘str’&gt;}}</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>dictionary of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query_id</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="n">flow</span><span class="p">:</span> <span class="nb">tuple</span> <span class="n">of</span> <span class="n">DataInfluenceStatements</span><span class="p">,</span>
               <span class="n">query_name</span><span class="p">:</span> <span class="p">(</span><span class="n">human_readable</span><span class="p">),</span>
               <span class="n">counter</span><span class="p">:</span> <span class="p">(</span><span class="n">fake</span> <span class="n">similarity</span> <span class="nb">id</span><span class="p">),</span>
               <span class="n">elem</span><span class="p">:</span> <span class="n">source</span> <span class="n">code</span> <span class="n">of</span> <span class="n">element</span>
               <span class="n">elem_name</span><span class="p">:</span> <span class="n">name</span> <span class="n">of</span> <span class="n">Flow</span> <span class="n">Element</span>
               <span class="n">field</span><span class="p">:</span> <span class="n">name</span> <span class="n">of</span> <span class="n">influenced</span> <span class="n">variable</span><span class="p">}</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.get_cx_xml_str">
<span class="sig-name descname"><span class="pre">get_cx_xml_str</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.get_cx_xml_str" title="Link to this definition">¶</a></dt>
<dd><p>Converts results to popcrab compatible report format</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>report xml string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.get_json_str">
<span class="sig-name descname"><span class="pre">get_json_str</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.get_json_str" title="Link to this definition">¶</a></dt>
<dd><p>get json result string</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>string that serializes list of QueryResult objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flow_result.ResultsProcessor.write_html">
<span class="sig-name descname"><span class="pre">write_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">html_report_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flow_result.ResultsProcessor.write_html" title="Link to this definition">¶</a></dt>
<dd><p>Writes html report to disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>html_report_path</strong> (<em>str</em>) – where to write html report</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>metrics (results) of issues sorted and counted.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-flowtest.flows">
<span id="flows"></span><h2>Flows<a class="headerlink" href="#module-flowtest.flows" title="Link to this heading">¶</a></h2>
<p>Flow propagation data structures and algorithms</p>
<p>&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.flows.</span></span><span class="sig-name descname"><span class="pre">FlowVector</span></span><a class="headerlink" href="#flowtest.flows.FlowVector" title="Link to this definition">¶</a></dt>
<dd><p>Common data structure for both vectors and scalars.</p>
<p>FlowVector supports vectorization, so that we can accurately
track taint as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">taint</span> <span class="o">--&gt;</span> <span class="n">Case</span><span class="o">.</span><span class="n">Subject</span>
<span class="n">Case</span>  <span class="o">--&gt;</span> <span class="n">Case2</span>
<span class="n">Case2</span><span class="o">.</span><span class="n">Status</span>  <span class="o">--&gt;</span> <span class="n">sink1</span>  <span class="o">//</span> <span class="n">detect</span> <span class="ow">not</span> <span class="n">tainted</span>
<span class="n">Case2</span><span class="o">.</span><span class="n">Subject</span> <span class="o">--&gt;</span> <span class="n">sink2</span>  <span class="o">//</span> <span class="n">detect</span> <span class="n">tainted</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property_maps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>property_maps</strong> (<em>dict</em><em>[</em><em>slice</em><em>(</em><em>&lt;class 'public.data_obj.DataInfluencePath'&gt;</em><em>, </em><em>dict</em><em>[</em><em>slice</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>set</em><em>[</em><a class="reference internal" href="public_ref.html#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><em>public.data_obj.DataInfluencePath</em></a><em>]</em><em>, </em><em>None</em><em>)</em><em>]</em><em>, </em><em>None</em><em>)</em><em>]</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.add_vector">
<span class="sig-name descname"><span class="pre">add_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.add_vector" title="Link to this definition">¶</a></dt>
<dd><p>Create new vector that adds flows of self and <code class="docutils literal notranslate"><span class="pre">vector</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowVector</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vector</strong> (<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a>) – </p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Both must be at the same variable name</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vector</strong> (<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a>) – vector containing new flow information</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a></p>
</dd>
</dl>
<p>Returns: new FlowVector representing the sum</p>
<section id="adding-vectors">
<h3>Adding Vectors<a class="headerlink" href="#adding-vectors" title="Link to this heading">¶</a></h3>
<p>In flows, the concept of “adding” objects or scalars
is overloaded to mean either</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>adding an element to a collection (object or scalar), or</p></li>
<li><p>combining two scalar values (e.g. string concatenation)</p></li>
</ol>
</div></blockquote>
<p>For dataflow analysis, we are adding sets of influence paths,
for example when exiting a flow.</p>
<p>This means that all the influencers of
the first are added to the influencers of the second (which
can create a doubling of flow paths) via set-addition.</p>
<p>Care must be taken when the generic case is the same but overrides
differ. Imagine program execution along two branches, followed
by combining the branches (say a function return). Then we
know that in reality, only one branch can be taken in an execution
run, but there is the possibility of cross-contamination. E.g.
in branch 1, Account.Name can change, and in branch 2, Account.Description,
but when we merge, we need to decide whether to combine both into “account”
and merge the overrides or to keep them as separate vectors with different
overrides. This boils down to whether the default vector is a key for the
override map or whether the better data structure is a tuple of a vector
and its overrides, with the addition operation always adding new tuples.</p>
<p>Presently we opt for first approach - merging the overrides
of the two vectors, because in principle, we still retain all the
information in the override dataflow histories - for example, we can store
the state branch id in each path - and it is the examination of the overrides
where fine-grained exclusion analysis should happen.</p>
<p>This choice forces us to create dummy (induced) overrides because
the nature of overrides is that they are always selected, so if <cite>A.Name</cite> has
an override, <cite>foo</cite> in path <cite>A</cite>, but not in path <cite>B</cite>, then we want to get both
<cite>A.Name</cite> and <cite>foo</cite> when requesting the override of the sum of path A and path B.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.from_flows">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_flows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.from_flows" title="Link to this definition">¶</a></dt>
<dd><p>Builds a vector from the provided flows.</p>
<p>Flows must all have the same influencer_name and no flow can have a non-null influencer_property.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowVector</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>default</strong> (<em>{&lt;class 'public.data_obj.DataInfluencePath'&gt;}</em>) – </p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Do not use FlowVector constructor outside the <code class="docutils literal notranslate"><span class="pre">flows</span></code> module, use this method instead
and build FlowVectors up using the provided instance methods as a result of parsing program
elements.</p>
<p>This method should be used to initialize variables by building the initialization flow
(where a variable influences itself)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>{DataInfluencePath}</strong> (<em>default</em>) – each of these paths should be assigned to their own default</p></li>
<li><p><strong>default</strong> (<em>{&lt;class 'public.data_obj.DataInfluencePath'&gt;}</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>FlowVector instance with the provided flows as defaults</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError if the flows have different influenced_name</strong><strong>, or </strong><strong>if default is empty.</strong> – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.get_flows_by_prop">
<span class="sig-name descname"><span class="pre">get_flows_by_prop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">member_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.get_flows_by_prop" title="Link to this definition">¶</a></dt>
<dd><p>Returns this vector’s flows with the requested influenced property name.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{&lt;class ‘public.data_obj.DataInfluencePath’&gt;}</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>member_name</strong> (<em>str</em><em> | </em><em>None</em>) – If None, returns all flows (including overrides)
Otherwise, returns all flows for the named property.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The requested flows associated to <em>all default indexes</em> consolidated into a set,
or empty set if no match.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.push_via_flow">
<span class="sig-name descname"><span class="pre">push_via_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extension_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">influenced_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_flow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.push_via_flow" title="Link to this definition">¶</a></dt>
<dd><p>Build new FlowVector with all influence paths in self pushed into <code class="docutils literal notranslate"><span class="pre">vec</span></code> via the extension_path.</p>
<p>For example, if the current vector corresponds to influencers of <code class="docutils literal notranslate"><span class="pre">A</span></code>, and <code class="docutils literal notranslate"><span class="pre">vec</span></code> to <code class="docutils literal notranslate"><span class="pre">B</span></code>,
then we can push A into B as follows:</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowVector</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>extension_path</strong> (<a class="reference internal" href="public_ref.html#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><em>DataInfluencePath</em></a>) – </p></li>
<li><p><strong>influenced_vec</strong> (<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a>) – </p></li>
<li><p><strong>assign</strong> (<em>bool</em>) – </p></li>
<li><p><strong>cross_flow</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">1.</span>&#160;&#160; <span class="pre">A.x</span> <span class="pre">--&gt;</span> <span class="pre">B</span></code></dt><dd><p>Then <code class="docutils literal notranslate"><span class="pre">B</span></code> must be a scalar and the default of <code class="docutils literal notranslate"><span class="pre">B</span></code> is populated with the extended influencers
of <code class="docutils literal notranslate"><span class="pre">A</span></code>’s x property. If <code class="docutils literal notranslate"><span class="pre">assign</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, then the existing influencers of <code class="docutils literal notranslate"><span class="pre">B</span></code>’s x
property are added to those pushed forward from <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">2.</span>&#160;&#160; <span class="pre">A</span> <span class="pre">--&gt;</span> <span class="pre">B.x</span></code></dt><dd><p>Then <code class="docutils literal notranslate"><span class="pre">A</span></code> must be a scalar and the defaults of <code class="docutils literal notranslate"><span class="pre">A</span></code> are pushed forward into <code class="docutils literal notranslate"><span class="pre">B</span></code>’s x-property
influencers. If <code class="docutils literal notranslate"><span class="pre">assign</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, then <code class="docutils literal notranslate"><span class="pre">B</span></code>’s existing property influencers are also kept.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">3.</span>&#160;&#160; <span class="pre">A.x</span> <span class="pre">--&gt;</span> <span class="pre">B.x</span></code></dt><dd><p>Then <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> must be Objects, and the x-property influencers of <code class="docutils literal notranslate"><span class="pre">B</span></code> are reassigned
to those pushed forward from <code class="docutils literal notranslate"><span class="pre">A.x</span></code>, and if <cite>assign</cite> is <cite>False</cite>, B also retains its existing
x-property influencers.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">4.</span>&#160;&#160; <span class="pre">A</span> <span class="pre">--&gt;</span> <span class="pre">B</span></code></dt><dd><p>Then all the influencers of A are pushed forward to B, either replacing <code class="docutils literal notranslate"><span class="pre">B</span></code> or
adding to <code class="docutils literal notranslate"><span class="pre">B</span></code>’s existing influencers.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extension_path</strong> (<a class="reference internal" href="public_ref.html#public.data_obj.DataInfluencePath" title="public.data_obj.DataInfluencePath"><em>DataInfluencePath</em></a>) – DataInfluencePath to push forward by</p></li>
<li><p><strong>influenced_vec</strong> (<a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a>) – The target vector that is influenced by the statement</p></li>
<li><p><strong>assign</strong> (<em>bool</em>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> for assignment and <code class="docutils literal notranslate"><span class="pre">False</span></code> for addition. Note that
object addition corresponds to enlarging a collection.</p></li>
<li><p><strong>cross_flow</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, allows this extension to cross flows, which requires
the flow being extended by to cross flows.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new FlowVector</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError if there is a variable name mismatch.</strong> – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#flowtest.flows.FlowVector" title="flowtest.flows.FlowVector"><em>FlowVector</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.report_dict">
<span class="sig-name descname"><span class="pre">report_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.report_dict" title="Link to this definition">¶</a></dt>
<dd><p>get brief object dict with stringified flows</p>
<p>flows are replaced with arrow and star notation
in <code class="xref py py-meth docutils literal notranslate"><span class="pre">DataInfluencePath.short_report()</span></code> and are
sorted alphabetically in all keys and (non-None) values.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{&lt;class ‘str’&gt;: {&lt;class ‘str’&gt;: {&lt;class ‘str’&gt;}}}</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>dict with the following schema:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">default</span> <span class="n">flows</span> <span class="p">:</span> <span class="p">{</span><span class="n">property_name</span><span class="p">:</span> <span class="p">{</span><span class="n">flows</span><span class="p">}}</span> <span class="o">|</span> <span class="kc">None</span> <span class="p">}</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flowtest.flows.FlowVector.short_report">
<span class="sig-name descname"><span class="pre">short_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.flows.FlowVector.short_report" title="Link to this definition">¶</a></dt>
<dd><p>Brief string serialization of the FlowVector (for testing and reporting)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>indent</strong> – number of spaces for indentation</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>summary of defaults and property maps</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-flowtest.query_manager">
<span id="query-manager"></span><h2>Query Manager<a class="headerlink" href="#module-flowtest.query_manager" title="Link to this heading">¶</a></h2>
<p>Responsible for loading and invoking query instances.</p>
<p>&#64;author: <a class="reference external" href="mailto:rsussland&#37;&#52;&#48;salesforce&#46;com">rsussland<span>&#64;</span>salesforce<span>&#46;</span>com</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="flowtest.query_manager.QueryAction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flowtest.query_manager.</span></span><span class="sig-name descname"><span class="pre">QueryAction</span></span><a class="headerlink" href="#flowtest.query_manager.QueryAction" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.query_manager.create_module">
<span class="sig-prename descclassname"><span class="pre">flowtest.query_manager.</span></span><span class="sig-name descname"><span class="pre">create_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.query_manager.create_module" title="Link to this definition">¶</a></dt>
<dd><p>Loads and Instantiates QueryProcessor</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>module_path</strong> (<em>str</em>) – location of module to load</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>QueryProcessor module</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError if module name cannot be parsed</strong><strong> or </strong><strong>preset not accepted</strong> – </p></li>
<li><p><strong>ImportError if the module cannot be loaded</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-flowtest.util">
<span id="util"></span><h2>Util<a class="headerlink" href="#module-flowtest.util" title="Link to this heading">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="flowtest.util.CURR_DIR">
<span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">CURR_DIR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'/Users/rsussland/dev/git/FlowSecurityLinter/docsrc'</span></em><a class="headerlink" href="#flowtest.util.CURR_DIR" title="Link to this definition">¶</a></dt>
<dd><p>Crawling limits</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.util.get_flows_in_dir">
<span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">get_flows_in_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.get_flows_in_dir" title="Link to this definition">¶</a></dt>
<dd><p>Searches recursively through for flows</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{&lt;class ‘str’&gt;: &lt;class ‘str’&gt;}</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>root_dir</strong> (<em>str</em>) – directory in which to search</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns a dict flow_name -&gt; filename</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.util.get_label">
<span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">get_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.get_label" title="Link to this definition">¶</a></dt>
<dd><p>get flow label as used in other flows to reference this subflow</p>
<p>Returns a tuple (namespaced label, local label)</p>
<p>For the local label, it changes <cite>foo-1</cite> to <cite>foo</cite> and
the namespaced label would be <cite>parent_dir__foo</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>str</em>) – parent directory containing filename</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – filename of flow</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple (namespaced_label, local_label)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str, str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.util.make_id">
<span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">make_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.make_id" title="Link to this definition">¶</a></dt>
<dd><p>Generates unique id strings</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>8 digit unique id as str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.util.propagate">
<span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">propagate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">replacements</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.propagate" title="Link to this definition">¶</a></dt>
<dd><p>Propagate attributes across flows.</p>
<p>For example, if we know that a variable
of type ‘Account’ is passed into loop, then we want to remember
that the object type of this loop is Account. This works if we leave
all properties none unless we are certain of their values and then
adopt this simple method. Longer term, we may need to put conditional
logic, but now add a replacement field for manual override.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="public_ref.html#public.data_obj.VariableType" title="public.data_obj.VariableType"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariableType</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>src_type</strong> (<a class="reference internal" href="public_ref.html#public.data_obj.VariableType" title="public.data_obj.VariableType"><em>VariableType</em></a>) – </p></li>
<li><p><strong>dest_type</strong> (<a class="reference internal" href="public_ref.html#public.data_obj.VariableType" title="public.data_obj.VariableType"><em>VariableType</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.util.resolve_name">
<span class="sig-prename descclassname"><span class="pre">flowtest.util.</span></span><span class="sig-name descname"><span class="pre">resolve_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_flow_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.util.resolve_name" title="Link to this definition">¶</a></dt>
<dd><p>return path of subflow to load based on subflow label</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>all_flow_paths</strong> (<em>{</em><em>(</em><em>&lt;class 'str'&gt;</em><em>, </em><em>&lt;class 'str'&gt;</em><em>)</em><em>: &lt;class 'str'&gt;}</em>) – all flow paths in scan scope</p></li>
<li><p><strong>sub_name</strong> (<em>str</em>) – subflow label</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>subflow path</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-flowtest.wire">
<span id="wire"></span><h2>Wire<a class="headerlink" href="#module-flowtest.wire" title="Link to this heading">¶</a></h2>
<p>performs dataflow wiring for flow elements</p>
<section id="wiring-policy">
<h3>Wiring Policy<a class="headerlink" href="#wiring-policy" title="Link to this heading">¶</a></h3>
<p>Wiring policy for flow elements</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;start&gt; - Not wired.</p></li>
<li><p>&lt;startElementReference&gt; - Not wired.</p></li>
<li><dl class="simple">
<dt>&lt;screens&gt; - TBD. Screens are complex and deserving of a separate study. Presently we wire associated</dt><dd><p>Objects as well as input variables. But many screen components are not handled (order fulfillment)</p>
</dd>
</dl>
</li>
<li><p>&lt;assignments&gt; - wire assignment, target variable auto-added</p></li>
<li><p>&lt;recordLookups&gt; - (flow element should be added)</p></li>
<li><p>&lt;recordCreates&gt; - (flow element should be added)</p></li>
<li><p>&lt;recordUpdates&gt; - (flow element should be added)</p></li>
<li><p>&lt;recordDeletes&gt; - (flow element should be added)</p></li>
<li><p>&lt;collectionProcessors&gt; - (flow element name) should be added and collection variable wired to it (for filters)</p></li>
<li><p>&lt;loops&gt; - Loop variable (flow element name) should be added and collection variable wired to it</p></li>
<li><p>&lt;decisions&gt; - Not wired</p></li>
<li><p>&lt;subflows&gt; - Handled with custom methods in <a class="reference internal" href="#module-flowtest.executor" title="flowtest.executor"><code class="xref py py-mod docutils literal notranslate"><span class="pre">flowtest.executor</span></code></a></p></li>
</ul>
</div></blockquote>
<p>The following flow elements represent data initialized at flow start
and are handled by the parser, they are not wired</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;choices&gt;</p></li>
<li><p>&lt;dynamicChoiceSets&gt;</p></li>
<li><p>&lt;textTemplates&gt;</p></li>
<li><p>&lt;formulas&gt;</p></li>
<li><p>&lt;constants&gt;</p></li>
<li><p>&lt;variables&gt;</p></li>
</ul>
</div></blockquote>
<p>The following are uncategorized</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;stages&gt; - TBD</p></li>
<li><p>&lt;actionCalls&gt; - TBD</p></li>
</ul>
</div></blockquote>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="flowtest.wire.handle_auto_store">
<span class="sig-prename descclassname"><span class="pre">flowtest.wire.</span></span><span class="sig-name descname"><span class="pre">handle_auto_store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.wire.handle_auto_store" title="Link to this definition">¶</a></dt>
<dd><p>Add this element name to influence map if it represents its own output data</p>
<p>(Element name is passed in so we don’t need to keep looking it up)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><em>BranchState</em></a>) – current branch state</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – current xml elem</p></li>
<li><p><strong>elem_name</strong> (<em>str</em>) – element name</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flowtest.wire.logger">
<span class="sig-prename descclassname"><span class="pre">flowtest.wire.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">flowtest.wire</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#flowtest.wire.logger" title="Link to this definition">¶</a></dt>
<dd><p>module logger</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.wire.wire">
<span class="sig-prename descclassname"><span class="pre">flowtest.wire.</span></span><span class="sig-name descname"><span class="pre">wire</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.wire.wire" title="Link to this definition">¶</a></dt>
<dd><p>Wires influence statements and variable initialization.</p>
<p>When the value of one variable changes based on another.
Once detected, this module extends the influence map by
each statement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><em>BranchState</em></a>) – current instance of Branch State</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – Flow Element to be wired</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.wire.wire_assignment">
<span class="sig-prename descclassname"><span class="pre">flowtest.wire.</span></span><span class="sig-name descname"><span class="pre">wire_assignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.wire.wire_assignment" title="Link to this definition">¶</a></dt>
<dd><p>Wires assignment statements to influence map in <cite>state</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><em>BranchState</em></a>) – current Branch State</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – assignment element to be wired</p></li>
<li><p><strong>elem_name</strong> (<em>str</em>) – element name passed in for convenience</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.wire.wire_collection_processor">
<span class="sig-prename descclassname"><span class="pre">flowtest.wire.</span></span><span class="sig-name descname"><span class="pre">wire_collection_processor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.wire.wire_collection_processor" title="Link to this definition">¶</a></dt>
<dd><p>Wires collection reference in collection processor to collection elem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><em>BranchState</em></a>) – current Branch State</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – assignment element to be wired</p></li>
<li><p><strong>elem_name</strong> (<em>str</em>) – element name passed in for convenience</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flowtest.wire.wire_loop">
<span class="sig-prename descclassname"><span class="pre">flowtest.wire.</span></span><span class="sig-name descname"><span class="pre">wire_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flowtest.wire.wire_loop" title="Link to this definition">¶</a></dt>
<dd><p>Wires collection loop is over to loop variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#flowtest.branch_state.BranchState" title="flowtest.branch_state.BranchState"><em>BranchState</em></a>) – current Branch State</p></li>
<li><p><strong>elem</strong> (<em>_Element</em>) – assignment element to be wired</p></li>
<li><p><strong>elem_name</strong> (<em>str</em>) – element name passed in for convenience</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-flowtest.version">
<span id="version"></span><h2>Version<a class="headerlink" href="#module-flowtest.version" title="Link to this heading">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents<span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:<span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#">Flowtest module</a><ul>
<li><a class="reference internal" href="#main">__main__</a><ul>
<li><a class="reference internal" href="#flowtest.__main__.check_dir_exists"><code class="docutils literal notranslate"><span class="pre">check_dir_exists()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.check_file_exists"><code class="docutils literal notranslate"><span class="pre">check_file_exists()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.check_not_exist"><code class="docutils literal notranslate"><span class="pre">check_not_exist()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.get_flow_paths"><code class="docutils literal notranslate"><span class="pre">get_flow_paths()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.parse_args"><code class="docutils literal notranslate"><span class="pre">parse_args()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.__main__.setup_logger"><code class="docutils literal notranslate"><span class="pre">setup_logger()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#branch-state">Branch State</a><ul>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState"><code class="docutils literal notranslate"><span class="pre">BranchState</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.__init__"><code class="docutils literal notranslate"><span class="pre">BranchState.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.add_vectors_from_other_flow"><code class="docutils literal notranslate"><span class="pre">BranchState.add_vectors_from_other_flow()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.current_crawl_step"><code class="docutils literal notranslate"><span class="pre">BranchState.current_crawl_step</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.current_elem"><code class="docutils literal notranslate"><span class="pre">BranchState.current_elem</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.current_elem_name"><code class="docutils literal notranslate"><span class="pre">BranchState.current_elem_name</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.filter_input_variables"><code class="docutils literal notranslate"><span class="pre">BranchState.filter_input_variables()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.filter_maps"><code class="docutils literal notranslate"><span class="pre">BranchState.filter_maps()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.flow_name"><code class="docutils literal notranslate"><span class="pre">BranchState.flow_name</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.flow_path"><code class="docutils literal notranslate"><span class="pre">BranchState.flow_path</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.formula_map"><code class="docutils literal notranslate"><span class="pre">BranchState.formula_map</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.from_parser"><code class="docutils literal notranslate"><span class="pre">BranchState.from_parser()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.get_all_output_vectors"><code class="docutils literal notranslate"><span class="pre">BranchState.get_all_output_vectors()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.get_current_elem"><code class="docutils literal notranslate"><span class="pre">BranchState.get_current_elem()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.get_current_elem_name"><code class="docutils literal notranslate"><span class="pre">BranchState.get_current_elem_name()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.get_flows_from_sources"><code class="docutils literal notranslate"><span class="pre">BranchState.get_flows_from_sources()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.get_or_make_vector"><code class="docutils literal notranslate"><span class="pre">BranchState.get_or_make_vector()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.get_parser"><code class="docutils literal notranslate"><span class="pre">BranchState.get_parser()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.is_in_map"><code class="docutils literal notranslate"><span class="pre">BranchState.is_in_map()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.load_crawl_step"><code class="docutils literal notranslate"><span class="pre">BranchState.load_crawl_step()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.parser"><code class="docutils literal notranslate"><span class="pre">BranchState.parser</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.BranchState.propagate_flows"><code class="docutils literal notranslate"><span class="pre">BranchState.propagate_flows()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.branch_state.INITIALIZATION_COMMENT"><code class="docutils literal notranslate"><span class="pre">INITIALIZATION_COMMENT</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.SUBFLOW_WIRE_COMMENT"><code class="docutils literal notranslate"><span class="pre">SUBFLOW_WIRE_COMMENT</span></code></a></li>
<li><a class="reference internal" href="#flowtest.branch_state.logger"><code class="docutils literal notranslate"><span class="pre">logger</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flowtest.control_flow">Control Flow</a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.ControlFlowGraph"><code class="docutils literal notranslate"><span class="pre">ControlFlowGraph</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.ControlFlowGraph.__init__"><code class="docutils literal notranslate"><span class="pre">ControlFlowGraph.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.CrawlEncoder"><code class="docutils literal notranslate"><span class="pre">CrawlEncoder</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.CrawlEncoder.default"><code class="docutils literal notranslate"><span class="pre">CrawlEncoder.default()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.CrawlSchedule"><code class="docutils literal notranslate"><span class="pre">CrawlSchedule</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.CrawlSchedule.__init__"><code class="docutils literal notranslate"><span class="pre">CrawlSchedule.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler"><code class="docutils literal notranslate"><span class="pre">Crawler</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.__init__"><code class="docutils literal notranslate"><span class="pre">Crawler.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.crawl_schedule"><code class="docutils literal notranslate"><span class="pre">Crawler.crawl_schedule</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.current_step"><code class="docutils literal notranslate"><span class="pre">Crawler.current_step</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.from_parser"><code class="docutils literal notranslate"><span class="pre">Crawler.from_parser()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.get_crawl_step"><code class="docutils literal notranslate"><span class="pre">Crawler.get_crawl_step()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.get_last_ancestor"><code class="docutils literal notranslate"><span class="pre">Crawler.get_last_ancestor()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.history_maps"><code class="docutils literal notranslate"><span class="pre">Crawler.history_maps</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.terminal_steps"><code class="docutils literal notranslate"><span class="pre">Crawler.terminal_steps</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Crawler.total_steps"><code class="docutils literal notranslate"><span class="pre">Crawler.total_steps</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.JSONSerializable"><code class="docutils literal notranslate"><span class="pre">JSONSerializable</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.JSONSerializable.__init__"><code class="docutils literal notranslate"><span class="pre">JSONSerializable.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.Jump"><code class="docutils literal notranslate"><span class="pre">Jump</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.Jump.__init__"><code class="docutils literal notranslate"><span class="pre">Jump.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.Segment"><code class="docutils literal notranslate"><span class="pre">Segment</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.control_flow.Segment.__init__"><code class="docutils literal notranslate"><span class="pre">Segment.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.Segment.accept"><code class="docutils literal notranslate"><span class="pre">Segment.accept()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.control_flow.crawl_iter"><code class="docutils literal notranslate"><span class="pre">crawl_iter()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.control_flow.get_crawl_schedule"><code class="docutils literal notranslate"><span class="pre">get_crawl_schedule()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flowtest.ESAPI">ESAPI</a><ul>
<li><a class="reference internal" href="#flowtest.ESAPI.html_encode"><code class="docutils literal notranslate"><span class="pre">html_encode()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.ESAPI.legal_sql_escape"><code class="docutils literal notranslate"><span class="pre">legal_sql_escape()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.ESAPI.sql_enc_html_dec"><code class="docutils literal notranslate"><span class="pre">sql_enc_html_dec()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.ESAPI.sql_escape"><code class="docutils literal notranslate"><span class="pre">sql_escape()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flowtest.executor">Executor</a><ul>
<li><a class="reference internal" href="#flowtest.executor.FOLLOW_SUBFLOWS"><code class="docutils literal notranslate"><span class="pre">FOLLOW_SUBFLOWS</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame"><code class="docutils literal notranslate"><span class="pre">Frame</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.executor.Frame.__init__"><code class="docutils literal notranslate"><span class="pre">Frame.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.all_flow_paths"><code class="docutils literal notranslate"><span class="pre">Frame.all_flow_paths</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.build"><code class="docutils literal notranslate"><span class="pre">Frame.build()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.child_spawned"><code class="docutils literal notranslate"><span class="pre">Frame.child_spawned</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.crawler"><code class="docutils literal notranslate"><span class="pre">Frame.crawler</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.execute"><code class="docutils literal notranslate"><span class="pre">Frame.execute()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.flow_name"><code class="docutils literal notranslate"><span class="pre">Frame.flow_name</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.flow_path"><code class="docutils literal notranslate"><span class="pre">Frame.flow_path</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.get_consolidated_output_vars"><code class="docutils literal notranslate"><span class="pre">Frame.get_consolidated_output_vars()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.handle_subflows"><code class="docutils literal notranslate"><span class="pre">Frame.handle_subflows()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.inputs"><code class="docutils literal notranslate"><span class="pre">Frame.inputs</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.parent_subflow"><code class="docutils literal notranslate"><span class="pre">Frame.parent_subflow</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.parser"><code class="docutils literal notranslate"><span class="pre">Frame.parser</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.prediction"><code class="docutils literal notranslate"><span class="pre">Frame.prediction</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.query_manager"><code class="docutils literal notranslate"><span class="pre">Frame.query_manager</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.resolved_subflows"><code class="docutils literal notranslate"><span class="pre">Frame.resolved_subflows</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.spawn_child_frame"><code class="docutils literal notranslate"><span class="pre">Frame.spawn_child_frame()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.state"><code class="docutils literal notranslate"><span class="pre">Frame.state</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.subflow_input_cache"><code class="docutils literal notranslate"><span class="pre">Frame.subflow_input_cache</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.subflow_output_variable_cache"><code class="docutils literal notranslate"><span class="pre">Frame.subflow_output_variable_cache</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Frame.update_parent_frame"><code class="docutils literal notranslate"><span class="pre">Frame.update_parent_frame()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.executor.Stack"><code class="docutils literal notranslate"><span class="pre">Stack</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.executor.Stack.__init__"><code class="docutils literal notranslate"><span class="pre">Stack.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.all_flow_paths"><code class="docutils literal notranslate"><span class="pre">Stack.all_flow_paths</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.current_frame"><code class="docutils literal notranslate"><span class="pre">Stack.current_frame</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.pop"><code class="docutils literal notranslate"><span class="pre">Stack.pop()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.push"><code class="docutils literal notranslate"><span class="pre">Stack.push()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.query_manager"><code class="docutils literal notranslate"><span class="pre">Stack.query_manager</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.resolved_subflows"><code class="docutils literal notranslate"><span class="pre">Stack.resolved_subflows</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.Stack.run"><code class="docutils literal notranslate"><span class="pre">Stack.run()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flowtest.executor.TRUST_CARNAC"><code class="docutils literal notranslate"><span class="pre">TRUST_CARNAC</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.TRY_CARNAC"><code class="docutils literal notranslate"><span class="pre">TRY_CARNAC</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.call_carnac"><code class="docutils literal notranslate"><span class="pre">call_carnac()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.logger"><code class="docutils literal notranslate"><span class="pre">logger</span></code></a></li>
<li><a class="reference internal" href="#flowtest.executor.parse_flow"><code class="docutils literal notranslate"><span class="pre">parse_flow()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flowtest.flow_metrics">Flow Metrics</a><ul>
<li><a class="reference internal" href="#flowtest.flow_metrics.add_to_query_config"><code class="docutils literal notranslate"><span class="pre">add_to_query_config()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.count_issues"><code class="docutils literal notranslate"><span class="pre">count_issues()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.get_issues_for_org"><code class="docutils literal notranslate"><span class="pre">get_issues_for_org()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.get_software_presets"><code class="docutils literal notranslate"><span class="pre">get_software_presets()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.parse_results"><code class="docutils literal notranslate"><span class="pre">parse_results()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.reverse_map"><code class="docutils literal notranslate"><span class="pre">reverse_map()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_metrics.serialize"><code class="docutils literal notranslate"><span class="pre">serialize()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flowtest.flow_result">Flow Result</a><ul>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.__init__"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.add_results"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.add_results()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.dump_json"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.dump_json()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.gen_result_dict"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.gen_result_dict()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.get_cx_xml_str"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.get_cx_xml_str()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.get_json_str"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.get_json_str()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flow_result.ResultsProcessor.write_html"><code class="docutils literal notranslate"><span class="pre">ResultsProcessor.write_html()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-flowtest.flows">Flows</a><ul>
<li><a class="reference internal" href="#flowtest.flows.FlowVector"><code class="docutils literal notranslate"><span class="pre">FlowVector</span></code></a><ul>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.__init__"><code class="docutils literal notranslate"><span class="pre">FlowVector.__init__()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.add_vector"><code class="docutils literal notranslate"><span class="pre">FlowVector.add_vector()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.from_flows"><code class="docutils literal notranslate"><span class="pre">FlowVector.from_flows()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.get_flows_by_prop"><code class="docutils literal notranslate"><span class="pre">FlowVector.get_flows_by_prop()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.push_via_flow"><code class="docutils literal notranslate"><span class="pre">FlowVector.push_via_flow()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.report_dict"><code class="docutils literal notranslate"><span class="pre">FlowVector.report_dict()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.flows.FlowVector.short_report"><code class="docutils literal notranslate"><span class="pre">FlowVector.short_report()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-flowtest.query_manager">Query Manager</a><ul>
<li><a class="reference internal" href="#flowtest.query_manager.QueryAction"><code class="docutils literal notranslate"><span class="pre">QueryAction</span></code></a></li>
<li><a class="reference internal" href="#flowtest.query_manager.create_module"><code class="docutils literal notranslate"><span class="pre">create_module()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flowtest.util">Util</a><ul>
<li><a class="reference internal" href="#flowtest.util.CURR_DIR"><code class="docutils literal notranslate"><span class="pre">CURR_DIR</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.get_flows_in_dir"><code class="docutils literal notranslate"><span class="pre">get_flows_in_dir()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.get_label"><code class="docutils literal notranslate"><span class="pre">get_label()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.make_id"><code class="docutils literal notranslate"><span class="pre">make_id()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.propagate"><code class="docutils literal notranslate"><span class="pre">propagate()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.util.resolve_name"><code class="docutils literal notranslate"><span class="pre">resolve_name()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flowtest.wire">Wire</a><ul>
<li><a class="reference internal" href="#wiring-policy">Wiring Policy</a></li>
<li><a class="reference internal" href="#flowtest.wire.handle_auto_store"><code class="docutils literal notranslate"><span class="pre">handle_auto_store()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.wire.logger"><code class="docutils literal notranslate"><span class="pre">logger</span></code></a></li>
<li><a class="reference internal" href="#flowtest.wire.wire"><code class="docutils literal notranslate"><span class="pre">wire()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.wire.wire_assignment"><code class="docutils literal notranslate"><span class="pre">wire_assignment()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.wire.wire_collection_processor"><code class="docutils literal notranslate"><span class="pre">wire_collection_processor()</span></code></a></li>
<li><a class="reference internal" href="#flowtest.wire.wire_loop"><code class="docutils literal notranslate"><span class="pre">wire_loop()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flowtest.version">Version</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
                <a href="public_ref.html">
                    <span class="icon">&lt;</span><span>Public Module</span></a>
                
            </div>

            <div class="right">
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
    &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>

<p id="theme_credit">Styled using the <a href="https://github.com/piccolo-orm/piccolo_theme">Piccolo Theme</a></p>
  </body>
</html>